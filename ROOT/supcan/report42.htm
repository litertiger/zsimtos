<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?103'></script>
<script language="JavaScript">
function OnReady(id)
{
 AF.func("Build", "report/xmlsheet8.xml");
 AF.func("SetLimit", "128");
}
</script>
</head>

<body topmargin=2>
<center>

<table cols=2 border=0 width=100%>
<col valign=top width=90>
<col>
<tr height=50>
<td align=center><img src='res/how.bmp'></td>
<td><b>1</b>.该表的数据源中，有1个主表、2个明细表(“主要作品”和“简历”)，请点击工具条中的“重新计算”(<img src='res/calc.bmp'>)；<br>
<b>2</b>.会发现下方的工作表选项卡变成这样了：<img src='res/illu48.png'><br>
</td>
</tr></table>

<div style="position:relative;width:90%">
	<script>insertReport('AF', 'PagesTabPercent=60', 510)</script>
</div>
<br>

<!--  以下为技术分析区 -->
<br><br>
<table border=0 cols=1 border=0 width=97% style='line-height:21px'>
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<b>1</b>.实现原理：将数据源中的数据，按某个字段的键值进行分拆，分拆到新的临时工作表中，具体功能在此操作：<br>
<center><img src='res/illu49.png'></center>
<b>2</b>.您可以查看这3个数据源的数据：<a href='reportdata/person1.xml' target=_blank>主表数据</a>、<a href='reportdata/person2.xml' target=_blank>简历数据</a>、<a href='reportdata/person3.xml' target=_blank>主要作品数据</a>;<br>
<br>
<b>3</b>.如果有多个数据源，需要各自定义键值字段，本例就有3个数据源。最终的原理图：<br>
<center><img src='res/illu50.jpg'></center>
<b>4</b>.从上图可以看出：<br>
　　4.1 数据源之间，是按照主表的键值分片拆分的;<br>
　　4.2 数据源的主表，在加载数据后，有多少个键值，就会产生多少个工作表;<br>
　　4.3 各个工作表的数据源取数函数，只能获取该工作表所对应的数据区域的内容;<br>
<br>
<b>5</b>.另外需注意：临时生成的工作表，在报表保存时也将和数据源填充内容一样被清除.<br>
</td></tr></table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</HTML>
