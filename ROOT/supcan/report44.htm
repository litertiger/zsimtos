<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?103'></script>
<script language="JavaScript">
function OnReady(id)
{
 AF.func("SetSource", "reportdata/datacenter.xml");
 AF.func("Build", "report/center2-2.xml");
 AF.func("SetCellData", "B2 \r\n='日期：'+SheetName()");
 AF.func("SetLimit", "128");
 AF.func("SetProp", "SectionDefine='ds1.keyExpress=getYear(RequiredDate); SheetNameExpress=getYear(requiredDate) + \'年\''");
}
</script>
</head>

<body topmargin=2>
<center>

<table cols=2 border=0 width=100%>
<col valign=top width=90>
<col>
<tr height=50>
<td align=center><img src='res/how.bmp'></td>
<td>直接采用了“20.分类汇总(一)”演示页的报表文件，动态将其数据源设置成按“船期”的年度进行分拆。请点击工具条中的“重新计算”(<img src='res/calc.bmp'>)</td>
</tr></table>

<div style="position:relative;width:90%">
	<script>insertReport('AF', 'PagesTabPercent=60', 490)</script>
</div>
<br>

<!--  以下为技术分析区 -->
<br><br>
<table border=0 cols=1 border=0 width=97% style='line-height:21px'>
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<b>1</b>.代码只有一句：<br>
<pre class='cpp'>
AF.func("SetProp", "SectionDefine='ds1.keyExpress=getYear(RequiredDate); SheetNameExpress=getYear(requiredDate) + \'年\''");</pre>
分拆的定义，最终是保存在报表XML文件的 &lt;Properties&gt;\&lt;Other&gt; 中的，请分析几张带分拆功能的报表的XML，相信您能看明白.<br>
<br>
<b>2</b>.请进入 “数据源”对话框的“数据按键值分拆”工具条菜单，能发现有分拆的设置, 这是上述 js 语句起作用的结果；<br>
<br>
<b>3</b>.本例给了我们一个启示：所谓“主键”并不一定要物理上的主键，只要你能写出表达式，就可以作为主键来用的！<br>
<br>
</td></tr></table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</HTML>
