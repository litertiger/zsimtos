<HTML>
<head>
<meta http-equiv="content-type" content="text/html; charset=gb2312">
<link rel="stylesheet" href="temp1.css" type="text/css">
</head>
<body bgcolor=#ffffff vlink=#0000ff>
<br>
　　<font style='font-size:15pt'>2.计算函数</font><hr color=#2266ee size=1>
　　计算函数主要用于硕正组件自身的表达式中，比如树列表XML模版中的表达式、报表单元格中直接输入的公式。此外，也可以以"<a href='globalfunction.htm#g6' target=_blank>全局函数</a>"方式被js直接调用，函数如下:<br>
<table width="94%" border="1" align="center">
<tr><th>分类</th><th>函数名</th><th>用途</th></tr>
<tr><td rowspan=2>公共函数</td><td><a href="#TagFuncTableif"><div id="func_TagFuncTableif"/>if</a></td><td>条件判断函数</td></tr>
<tr><td><a href="#TagFuncTablejs"><div id="func_TagFuncTablejs"/>js</a></td><td>调用页面的javascript函数</td></tr>
<tr><td rowspan=18>数学函数</td><td><a href="#TagFuncTablesum"><div id="func_TagFuncTablesum"/>sum</a></td><td>求和</td></tr>
<tr><td><a href="#TagFuncTablesumDim"><div id="func_TagFuncTablesumDim"/>sumDim</a></td><td>数组求和</td></tr>
<tr><td><a href="#TagFuncTableaverage"><div id="func_TagFuncTableaverage"/>average</a></td><td>求平均值</td></tr>
<tr><td><a href="#TagFuncTablemax"><div id="func_TagFuncTablemax"/>max</a></td><td>求最大值</td></tr>
<tr><td><a href="#TagFuncTablemin"><div id="func_TagFuncTablemin"/>min</a></td><td>求最小值</td></tr>
<tr><td><a href="#TagFuncTablepercent"><div id="func_TagFuncTablepercent"/>percent</a></td><td>求百分比</td></tr>
<tr><td><a href="#TagFuncTableabs"><div id="func_TagFuncTableabs"/>abs</a></td><td>绝对值</td></tr>
<tr><td><a href="#TagFuncTableround"><div id="func_TagFuncTableround"/>round</a></td><td>四舍五入</td></tr>
<tr><td><a href="#TagFuncTableint"><div id="func_TagFuncTableint"/>int</a></td><td>取整</td></tr>
<tr><td><a href="#TagFuncTablemod"><div id="func_TagFuncTablemod"/>mod</a></td><td>求余数</td></tr>
<tr><td><a href="#TagFuncTablefloor"><div id="func_TagFuncTablefloor"/>floor</a></td><td>小于n(参数)的最大整数</td></tr>
<tr><td><a href="#TagFuncTableceil"><div id="func_TagFuncTableceil"/>ceil</a></td><td>大于n(参数)的最小整数</td></tr>
<tr><td><a href="#TagFuncTablesqrt"><div id="func_TagFuncTablesqrt"/>sqrt</a></td><td>平方根</td></tr>
<tr><td><a href="#TagFuncTableexp"><div id="func_TagFuncTableexp"/>exp</a></td><td>e的n次幂</td></tr>
<tr><td><a href="#TagFuncTablelog"><div id="func_TagFuncTablelog"/>log</a></td><td>log</td></tr>
<tr><td><a href="#TagFuncTablelog10"><div id="func_TagFuncTablelog10"/>log10</a></td><td>以10为底的log</td></tr>
<tr><td><a href="#TagFuncTablepow"><div id="func_TagFuncTablepow"/>pow</a></td><td>n(参数)的n次方</td></tr>
<tr><td><a href="#TagFuncTablerand"><div id="func_TagFuncTablerand"/>rand</a></td><td>随机数</td></tr>
<tr><td rowspan=27>文字函数</td><td><a href="#TagFuncTablelen"><div id="func_TagFuncTablelen"/>len</a></td><td>取串长度(字数)</td></tr>
<tr><td><a href="#TagFuncTableleft"><div id="func_TagFuncTableleft"/>left</a></td><td>取串的左n个字</td></tr>
<tr><td><a href="#TagFuncTableright"><div id="func_TagFuncTableright"/>right</a></td><td>取串的右n个字</td></tr>
<tr><td><a href="#TagFuncTablemid"><div id="func_TagFuncTablemid"/>mid</a></td><td>取串的中间若干个字</td></tr>
<tr><td><a href="#TagFuncTableindexOf"><div id="func_TagFuncTableindexOf"/>indexOf</a></td><td>取子串在串中的位置</td></tr>
<tr><td><a href="#TagFuncTableindexOneOf"><div id="func_TagFuncTableindexOneOf"/>indexOneOf</a></td><td>子串中任一字符最先出现在串中的位置</td></tr>
<tr><td><a href="#TagFuncTableindexOfArray"><div id="func_TagFuncTableindexOfArray"/>indexOfArray</a></td><td>取串在串数组中的位置</td></tr>
<tr><td><a href="#TagFuncTableendWith"><div id="func_TagFuncTableendWith"/>endWith</a></td><td>串是否以某子串结尾</td></tr>
<tr><td><a href="#TagFuncTablelike"><div id="func_TagFuncTablelike"/>like</a></td><td>串是否匹配(类似SQL Like)</td></tr>
<tr><td><a href="#TagFuncTablecompare"><div id="func_TagFuncTablecompare"/>compare</a></td><td>比较2个串</td></tr>
<tr><td><a href="#TagFuncTablereplace"><div id="func_TagFuncTablereplace"/>replace</a></td><td>替换串的中间若干个字</td></tr>
<tr><td><a href="#TagFuncTablereplaceAll"><div id="func_TagFuncTablereplaceAll"/>replaceAll</a></td><td>替换串的中某些子串</td></tr>
<tr><td><a href="#TagFuncTabletoLowerCase"><div id="func_TagFuncTabletoLowerCase"/>toLowerCase</a></td><td>把串中的英文转换为小写</td></tr>
<tr><td><a href="#TagFuncTabletoUpperCase"><div id="func_TagFuncTabletoUpperCase"/>toUpperCase</a></td><td>把串中的英文转换为大写</td></tr>
<tr><td><a href="#TagFuncTabletrim"><div id="func_TagFuncTabletrim"/>trim</a></td><td>除去串的首尾空格、或任意串</td></tr>
<tr><td><a href="#TagFuncTabletrimLeft"><div id="func_TagFuncTabletrimLeft"/>trimLeft</a></td><td>除去串的左侧空格、或任意串</td></tr>
<tr><td><a href="#TagFuncTabletrimRight"><div id="func_TagFuncTabletrimRight"/>trimRight</a></td><td>除去串的尾部空格、或任意串</td></tr>
<tr><td><a href="#TagFuncTabletrimToNumber"><div id="func_TagFuncTabletrimToNumber"/>trimToNumber</a></td><td>除去头、尾多余的字符, 取出数字串</td></tr>
<tr><td><a href="#TagFuncTableencodeURI"><div id="func_TagFuncTableencodeURI"/>encodeURI</a></td><td>对文字进行URI编码</td></tr>
<tr><td><a href="#TagFuncTableencodeURIComponent"><div id="func_TagFuncTableencodeURIComponent"/>encodeURIComponent</a></td><td>对更多文字进行URI编码</td></tr>
<tr><td><a href="#TagFuncTableenglishNum"><div id="func_TagFuncTableenglishNum"/>englishNum</a></td><td>英文数字</td></tr>
<tr><td><a href="#TagFuncTablechineseNum"><div id="func_TagFuncTablechineseNum"/>chineseNum</a></td><td>中文大写</td></tr>
<tr><td><a href="#TagFuncTableRMB"><div id="func_TagFuncTableRMB"/>RMB</a></td><td>人民币大写</td></tr>
<tr><td><a href="#TagFuncTableformatDate"><div id="func_TagFuncTableformatDate"/>formatDate</a></td><td>按指定掩码表示日期</td></tr>
<tr><td><a href="#TagFuncTableformatNum"><div id="func_TagFuncTableformatNum"/>formatNum</a></td><td>按指定掩码表示数值</td></tr>
<tr><td><a href="#TagFuncTablechineseDate"><div id="func_TagFuncTablechineseDate"/>chineseDate</a></td><td>中文的日期表示</td></tr>
<tr><td><a href="#TagFuncTablechineseBankDate"><div id="func_TagFuncTablechineseBankDate"/>chineseBankDate</a></td><td>中国银行的日期表示</td></tr>
<tr><td rowspan=26>日期函数</td><td><a href="#TagFuncTabledateDifYears"><div id="func_TagFuncTabledateDifYears"/>dateDifYears</a></td><td>2个日期的年度之差</td></tr>
<tr><td><a href="#TagFuncTabledateDifMonths"><div id="func_TagFuncTabledateDifMonths"/>dateDifMonths</a></td><td>2个日期的月份之差</td></tr>
<tr><td><a href="#TagFuncTabledateDifDays"><div id="func_TagFuncTabledateDifDays"/>dateDifDays</a></td><td>2个日期的天数之差</td></tr>
<tr><td><a href="#TagFuncTabledateDifWorkDays"><div id="func_TagFuncTabledateDifWorkDays"/>dateDifWorkDays</a></td><td>2个日期之间的工作日天数</td></tr>
<tr><td><a href="#TagFuncTabledateDifHours"><div id="func_TagFuncTabledateDifHours"/>dateDifHours</a></td><td>2个日期的小时之差</td></tr>
<tr><td><a href="#TagFuncTabledateDifMinutes"><div id="func_TagFuncTabledateDifMinutes"/>dateDifMinutes</a></td><td>2个日期的分钟数之差</td></tr>
<tr><td><a href="#TagFuncTabledateAddYears"><div id="func_TagFuncTabledateAddYears"/>dateAddYears</a></td><td>日期增加若干年</td></tr>
<tr><td><a href="#TagFuncTabledateAddMonths"><div id="func_TagFuncTabledateAddMonths"/>dateAddMonths</a></td><td>日期增加若干月</td></tr>
<tr><td><a href="#TagFuncTabledateAddDays"><div id="func_TagFuncTabledateAddDays"/>dateAddDays</a></td><td>日期增加若干天</td></tr>
<tr><td><a href="#TagFuncTabledateAddHours"><div id="func_TagFuncTabledateAddHours"/>dateAddHours</a></td><td>日期增加若干小时</td></tr>
<tr><td><a href="#TagFuncTabledateAddMinutes"><div id="func_TagFuncTabledateAddMinutes"/>dateAddMinutes</a></td><td>日期增加若干分钟</td></tr>
<tr><td><a href="#TagFuncTablegetYear"><div id="func_TagFuncTablegetYear"/>getYear</a></td><td>取某日期的年度</td></tr>
<tr><td><a href="#TagFuncTablegetMonth"><div id="func_TagFuncTablegetMonth"/>getMonth</a></td><td>取某日期的月份</td></tr>
<tr><td><a href="#TagFuncTablegetDay"><div id="func_TagFuncTablegetDay"/>getDay</a></td><td>取某日期的日期号</td></tr>
<tr><td><a href="#TagFuncTablegetDayOfWeek"><div id="func_TagFuncTablegetDayOfWeek"/>getDayOfWeek</a></td><td>求某日是星期几</td></tr>
<tr><td><a href="#TagFuncTablegetDayOfYear"><div id="func_TagFuncTablegetDayOfYear"/>getDayOfYear</a></td><td>求某日是年度中的第几天</td></tr>
<tr><td><a href="#TagFuncTableGetHour"><div id="func_TagFuncTableGetHour"/>GetHour</a></td><td>取某日期时间型串的小时</td></tr>
<tr><td><a href="#TagFuncTablegetMinute"><div id="func_TagFuncTablegetMinute"/>getMinute</a></td><td>取某日期时间型串的分钟</td></tr>
<tr><td><a href="#TagFuncTablenow"><div id="func_TagFuncTablenow"/>now</a></td><td>取当前日期</td></tr>
<tr><td><a href="#TagFuncTablecompareDate"><div id="func_TagFuncTablecompareDate"/>compareDate</a></td><td>比较2个日期大小</td></tr>
<tr><td><a href="#TagFuncTablefirstDateOfMonth"><div id="func_TagFuncTablefirstDateOfMonth"/>firstDateOfMonth</a></td><td>取得某日期的月初日期</td></tr>
<tr><td><a href="#TagFuncTablefirstDateOfSeason"><div id="func_TagFuncTablefirstDateOfSeason"/>firstDateOfSeason</a></td><td>取得某日期的季初日期</td></tr>
<tr><td><a href="#TagFuncTablefirstDateOfYear"><div id="func_TagFuncTablefirstDateOfYear"/>firstDateOfYear</a></td><td>取得某日期的年初日期</td></tr>
<tr><td><a href="#TagFuncTablelastDateOfMonth"><div id="func_TagFuncTablelastDateOfMonth"/>lastDateOfMonth</a></td><td>取得某日期的月末日期</td></tr>
<tr><td><a href="#TagFuncTablelastDateOfSeason"><div id="func_TagFuncTablelastDateOfSeason"/>lastDateOfSeason</a></td><td>取得某日期的季末日期</td></tr>
<tr><td><a href="#TagFuncTablelastDateOfYear"><div id="func_TagFuncTablelastDateOfYear"/>lastDateOfYear</a></td><td>取得某日期的年末日期</td></tr>
<tr><td rowspan=1>Treelist专用函数</td><td><a href="#TagFuncTableisNull"><div id="func_TagFuncTableisNull"/>isNull</a></td><td>判断某单元格内容是否为null</td></tr>
<tr><td rowspan=23>Report专用函数(1)</td><td><a href="#TagFuncTableref"><div id="func_TagFuncTableref"/>ref</a></td><td>引用其它单元格</td></tr>
<tr><td><a href="#TagFuncTablerefAlias"><div id="func_TagFuncTablerefAlias"/>refAlias</a></td><td>按别名引用其它单元格</td></tr>
<tr><td><a href="#TagFuncTablerefData"><div id="func_TagFuncTablerefData"/>refData</a></td><td>引用其它单元格的原始内容</td></tr>
<tr><td><a href="#TagFuncTablerefText"><div id="func_TagFuncTablerefText"/>refText</a></td><td>引用其它单元格的显示内容</td></tr>
<tr><td><a href="#TagFuncTablerefAliasData"><div id="func_TagFuncTablerefAliasData"/>refAliasData</a></td><td>按别名引用其它单元格的原始内容</td></tr>
<tr><td><a href="#TagFuncTablerefAliasText"><div id="func_TagFuncTablerefAliasText"/>refAliasText</a></td><td>按别名引用其它单元格的显示内容</td></tr>
<tr><td><a href="#TagFuncTablerow"><div id="func_TagFuncTablerow"/>row</a></td><td>取得本单元格(或指定单元格)的行号</td></tr>
<tr><td><a href="#TagFuncTablecol"><div id="func_TagFuncTablecol"/>col</a></td><td>取得本单元格(或指定单元格)的列号</td></tr>
<tr><td><a href="#TagFuncTablerows"><div id="func_TagFuncTablerows"/>rows</a></td><td>取得当前工作表的总行数</td></tr>
<tr><td><a href="#TagFuncTablecols"><div id="func_TagFuncTablecols"/>cols</a></td><td>取得当前工作表的总列数</td></tr>
<tr><td><a href="#TagFuncTableCellName(语法一)"><div id="func_TagFuncTableCellName(语法一)"/>CellName(语法一)</a></td><td>取得本单元格的单元名</td></tr>
<tr><td><a href="#TagFuncTableCellName(语法二)"><div id="func_TagFuncTableCellName(语法二)"/>CellName(语法二)</a></td><td>取得指定单元格的单元名</td></tr>
<tr><td><a href="#TagFuncTablesumif(语法一)"><div id="func_TagFuncTablesumif(语法一)"/>sumif(语法一)</a></td><td>按条件求sum</td></tr>
<tr><td><a href="#TagFuncTablesumif(语法二)"><div id="func_TagFuncTablesumif(语法二)"/>sumif(语法二)</a></td><td>参照某列的条件求sum</td></tr>
<tr><td><a href="#TagFuncTablesumif(语法三)"><div id="func_TagFuncTablesumif(语法三)"/>sumif(语法三)</a></td><td>参照某些列的条件求sum</td></tr>
<tr><td><a href="#TagFuncTablecountif(语法一)"><div id="func_TagFuncTablecountif(语法一)"/>countif(语法一)</a></td><td>按条件求单元格数</td></tr>
<tr><td><a href="#TagFuncTablecountif(语法二)"><div id="func_TagFuncTablecountif(语法二)"/>countif(语法二)</a></td><td>按条件求单元格数</td></tr>
<tr><td><a href="#TagFuncTablecountif(语法三)"><div id="func_TagFuncTablecountif(语法三)"/>countif(语法三)</a></td><td>按条件求单元格数</td></tr>
<tr><td><a href="#TagFuncTablepages"><div id="func_TagFuncTablepages"/>pages</a></td><td>总共打印页数</td></tr>
<tr><td><a href="#TagFuncTablepage"><div id="func_TagFuncTablepage"/>page</a></td><td>当前打印页</td></tr>
<tr><td><a href="#TagFuncTablepageBatch"><div id="func_TagFuncTablepageBatch"/>pageBatch</a></td><td>在批打印中的当前打印页</td></tr>
<tr><td><a href="#TagFuncTablepagesBatch"><div id="func_TagFuncTablepagesBatch"/>pagesBatch</a></td><td>批打印的总页数</td></tr>
<tr><td><a href="#TagFuncTablevPages"><div id="func_TagFuncTablevPages"/>vPages</a></td><td>纵向分页数</td></tr>
<tr><td><a href="#TagFuncTablevPage"><div id="func_TagFuncTablevPage"/>vPage</a></td><td>纵向的当前分页</td></tr>
<tr><td><a href="#TagFuncTablehPages"><div id="func_TagFuncTablehPages"/>hPages</a></td><td>横向分页数</td></tr>
<tr><td><a href="#TagFuncTablehPage"><div id="func_TagFuncTablehPage"/>hPage</a></td><td>横向的当前分页</td></tr>
<tr><td><a href="#TagFuncTablePageSum"><div id="func_TagFuncTablePageSum"/>PageSum</a></td><td>分页小计 (打印页)</td></tr>
<tr><td rowspan=7>Report专用函数(2):<br>数据源函数</td><td><a href="#TagFuncTabledataRow"><div id="func_TagFuncTabledataRow"/>dataRow</a></td><td>顺序填入数据源中的数据行</td></tr>
<tr><td><a href="#TagFuncTableheadRow"><div id="func_TagFuncTableheadRow"/>headRow</a></td><td>填入数据源的标题行</td></tr>
<tr><td><a href="#TagFuncTabledata"><div id="func_TagFuncTabledata"/>data</a></td><td>取得数据源中的单个数据</td></tr>
<tr><td><a href="#TagFuncTablehead"><div id="func_TagFuncTablehead"/>head</a></td><td>取得数据源的单个标题</td></tr>
<tr><td><a href="#TagFuncTablesearch"><div id="func_TagFuncTablesearch"/>search</a></td><td>从数据源中搜索</td></tr>
<tr><td><a href="#TagFuncTabledataRows"><div id="func_TagFuncTabledataRows"/>dataRows</a></td><td>取得数据源总行数</td></tr>
<tr><td><a href="#TagFuncTabledataRowNumber"><div id="func_TagFuncTabledataRowNumber"/>dataRowNumber</a></td><td>填入数据源中的行号</td></tr>
</table>
<br>
 函数详解:
<div id="TagFuncTableif"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>if</td><td class="funcTD">条件判断函数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableif"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>条件，非零表示满足条件</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>条件满足时的返回值</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>条件未满足时的返回值</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>见参数</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=if(getDay(now())<10, '上旬', if(getDay(now())>=20,'下旬','中旬'))</td></tr>
</table>
<br>

<div id="TagFuncTablejs"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>js</td><td class="funcTD">反向调用当前页面的JavaScript函数(“当前页面”是指包容当前控件的页面)</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablejs"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>要调用的js函数名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 该js函数的第一个参数</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 该js函数的第二个参数，以下以此类推...</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>由js函数决定</td></tr>
  <tr><td align=right>备注</td><td colspan=2>函数的返回值就是 js 函数的返回值，在硕正报表组件中，允许返回 SoapLike 格式的异常包, 其格式请参见 "4.XML/JSON异常包"</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>例如表达式:  =js('getProd', '1', 'true')<br><br>那么在当前页面上必须有名为 getProd 的 js 函数, 该函数要有2个参数，例如：<br>
function getProd(index, isOpened)<br>{<br>　...<br>　return 1;<br>}</td></tr>
</table>
<br>

<div id="TagFuncTablesum"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>sum</td><td class="funcTD">求和</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablesum"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>参数数量可任意</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=sum(14.21, 220.3, sum(22, 33))</td></tr>
  <tr><td align=right>备注</td><td colspan=2>1.在硕正报表中，参数可以含有单元名，例如 sum(D4:E9, K5, K7);<br>2.在硕正报表中，如果要对数据源填充区某列求和, 但因为行数是未知的, 应该写成诸如 sum(D4:@D4)这种格式, 表示从 D4单元格开始向下，直到数据源的末行</td></tr>
</table>
<br>

<div id="TagFuncTablesumDim"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>sumDim</td><td class="funcTD">数组求和</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablesumDim"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>参数数量可任意，参数的形式是以某个字符分隔的多个数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>和参数类似的形式</td></tr>
  <tr><td align=right>备注</td><td colspan=2>分隔符可以是除空格外的任意字符(或字符串)，但必须保持一致</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=sumDim("1.1 / 2.1 / 3",  "10 / 20 / 30")  返回的将是串"11.1 / 22.1 / 33"<br>在硕正报表中，参数可以含有单元名，例如 sumDim(D4:D9)</td></tr>
</table>
<br>

<div id="TagFuncTableaverage"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>average</td><td class="funcTD">求平均值</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableaverage"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>参数数量可任意</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablemax"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>max</td><td class="funcTD">求最大值</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablemax"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>参数数量可任意</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablemin"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>min</td><td class="funcTD">求最小值</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablemin"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>参数数量可任意</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablepercent"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>percent</td><td class="funcTD">求百分比</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablepercent"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数字</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 小数位数，默认为0</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>百分比串，带'%'符号</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=percent(0.12345, 2)，返回值为串“12.35%”</td></tr>
</table>
<br>

<div id="TagFuncTableabs"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>abs</td><td class="funcTD">绝对值</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableabs"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>正数</td></tr>
</table>
<br>

<div id="TagFuncTableround"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>round</td><td class="funcTD">四舍五入</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableround"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数字</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>小数位数</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTableint"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>int</td><td class="funcTD">取整</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableint"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>整数</td></tr>
</table>
<br>

<div id="TagFuncTablemod"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>mod</td><td class="funcTD">求余数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablemod"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>被除数</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>除数</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>余数</td></tr>
</table>
<br>

<div id="TagFuncTablefloor"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>floor</td><td class="funcTD">小于n(参数)的最大整数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablefloor"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>整数</td></tr>
</table>
<br>

<div id="TagFuncTableceil"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>ceil</td><td class="funcTD">大于n(参数)的最小整数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableceil"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>整数</td></tr>
</table>
<br>

<div id="TagFuncTablesqrt"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>sqrt</td><td class="funcTD">平方根</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablesqrt"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTableexp"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>exp</td><td class="funcTD">e的n次幂</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableexp"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablelog"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>log</td><td class="funcTD">log</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablelog"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablelog10"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>log10</td><td class="funcTD">以10为底的log</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablelog10"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablepow"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>pow</td><td class="funcTD">n(参数)的n次方</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablepow"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>底数</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>幂数</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablerand"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>rand</td><td class="funcTD">随机数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerand"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>0 - 0.99</td></tr>
</table>
<br>

<div id="TagFuncTablelen"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>len</td><td class="funcTD">取串长度(字数)</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablelen"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=len('字符串12')，返回值5</td></tr>
</table>
<br>

<div id="TagFuncTableleft"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>left</td><td class="funcTD">取串的左n个字</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableleft"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>字数</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTableright"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>right</td><td class="funcTD">取串的右n个字</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableright"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>字数</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTablemid"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>mid</td><td class="funcTD">取串的中间若干个字</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablemid"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>位置(从0开始)</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>字数</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTableindexOf"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>indexOf</td><td class="funcTD">取子串在串中的位置</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableindexOf"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>子串</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 开始查找位置，默认为0</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>可选, 大小写是否敏感，默认为0(即不敏感)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>位置，从0开始，-1表示未找到</td></tr>
</table>
<br>

<div id="TagFuncTableindexOfArray"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>indexOfArray</td><td class="funcTD">取串在串数组中的位置</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableindexOfArray"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串数组</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 开始查找位置，默认为0</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>可选, 大小写是否敏感，默认为0(即不敏感)</td></tr>
  <tr><td align=right>参数5</td><td colspan=2>可选, 数组中各个串的分隔符, 默认是逗号</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>位置，从0开始，-1表示未找到</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=indexOfArray('01, 1, 03, 0301', '03')，返回值为2<br>
=indexOfArray('A/aA/AA/aa', 'AA', 0, 0, '/')，返回值为1	</td></tr>
</table>
<br>

<div id="TagFuncTableindexOneOf"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>indexOneOf</td><td class="funcTD">子串中任一字符最先出现在串中的位置</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableindexOneOf"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>子串</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 开始查找位置，默认为0</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>可选, 大小写是否敏感，默认为0(即不敏感)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>位置，从0开始，-1表示未找到</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=indexOneOf('abc882nd', '0123456789')，返回值为3</td></tr>  
</table>
<br>

<div id="TagFuncTableendWith"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>endWith</td><td class="funcTD">串是否以某子串结尾</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableendWith"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>子串</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 大小写是否敏感，默认为0(即不敏感)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>1/0, 表示是/否</td></tr>
</table>
<br>

<div id="TagFuncTablelike"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>like</td><td class="funcTD">串是否匹配(类似SQL Like)</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablelike"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>通配符，可以包含如下符号: <b>%</b>(替代一个或多个字符)、<b>_</b>(仅替代一个字符)、<b>[charlist]</b>(字符列中的任何单一字符)、<b>[!charlist]</b>(或<b>[^charlist]</b>，不在字符列中的任何单一字符), 也可以用 - 分隔的范围，比如[a-z]</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 大小写是否敏感，默认为0(即不敏感)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>1/0, 表示是/否</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=like('Certern', 'C_r_er')<br>
=like('ACertern', '[ALN]%')</td></tr>
</table>
<br>

<div id="TagFuncTablecompare"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>compare</td><td class="funcTD">比较2个串</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablecompare"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>串2</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 大小写是否敏感，默认为0(即不敏感)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>整数，0表示相等；大于0表示串1大于串2；小于0表示串1小于串2</td></tr>
</table>
<br>

<div id="TagFuncTablereplace"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>replace</td><td class="funcTD">替换串的中间若干个字</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablereplace"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>位置(从0开始)</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>长度</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>替换的串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>被替换后的串</td></tr>
</table>
<br>

<div id="TagFuncTablereplaceAll"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>replaceAll</td><td class="funcTD">替换串的中某些子串</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablereplaceAll"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>需要被替换的串</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>替换的新串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>被替换后的串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=replaceAll('ABCA', 'A', '02')，返回值为串“02BC02”</td></tr>
</table>
<br>

<div id="TagFuncTabletoLowerCase"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>toLowerCase</td><td class="funcTD">把串中的英文转换为小写</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabletoLowerCase"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTabletoUpperCase"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>toUpperCase</td><td class="funcTD">把串中的英文转换为大写</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabletoUpperCase"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTabletrim"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>trim</td><td class="funcTD">除去串的首尾空格、或任意串</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabletrim"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选，要除去的串，默认空格</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTabletrimLeft"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>trimLeft</td><td class="funcTD">除去串的左侧空格、或任意串</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabletrimLeft"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选，要除去的串，默认空格</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTabletrimRight"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>trimRight</td><td class="funcTD">除去串的尾部空格、或任意串</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabletrimRight"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选，要除去的串，默认空格</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTabletrimToNumber"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>trimToNumber</td><td class="funcTD">除去头、尾多余的字符, 取出数字串</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabletrimToNumber"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数字串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=trimToNumber('总计: 13,203.17 吨')，返回值为 13203.17<br>
注: 其中如果有多个数值，则返回第一个<br>
=trimToNumber('The cod is 13, 12, 22')，返回值为 13 </td></tr>
</table>
<br>

<div id="TagFuncTableencodeURI"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>encodeURI</td><td class="funcTD">对文字进行URI编码</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableencodeURI"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr><td align=right>备注</td><td colspan=2>encodeURI不会对数字、字母和“-_.!~*'()”进行编码，也不会对有特殊含义的“;/?:@=+$,#&”进行编码</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=encodeURI('http://www.supcan.cn/supcan?val=硕正RIA')，返回值为串“http://www.supcan.cn/supcan?val=%e7%a1%95%e6%ad%a3RIA”</td></tr>
</table>
<br>

<div id="TagFuncTableencodeURIComponent"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=170><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>encodeURIComponent</td><td class="funcTD">对更多文字进行URI编码</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableencodeURIComponent"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr><td align=right>备注</td><td colspan=2>和encodeURI的唯一差别是：会对有特殊含义的“;/?:@=+$,#&”进行编码</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=encodeURIComponent('硕正RIA')，返回值为串“%e7%a1%95%e6%ad%a3RIA”</td></tr>
</table>
<br>

<div id="TagFuncTableenglishNum"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>englishNum</td><td class="funcTD">英文数字</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableenglishNum"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=englishNum(10123.24)，返回值为串“ten thousand one hundred and twenty three point twenty four”</td></tr>
</table>
<br>

<div id="TagFuncTablechineseNum"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>chineseNum</td><td class="funcTD">中文大写</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablechineseNum"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>0至9之间的数字，允许有多个数字</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>1 表示普通的中文大写，0或忽略该参数表示中文金额的大写</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=chineseNum(123) 返回值为串“壹贰叁”;<br>
=chineseNum(123, 1) 返回值为串“一二三”</td></tr>
</table>
<br>

<div id="TagFuncTableRMB"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>RMB</td><td class="funcTD">人民币大写</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableRMB"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=rmb(10123.24)，返回值为串“壹万零壹佰贰拾叁元贰角肆分”</td></tr>
</table>
<br>

<div id="TagFuncTableformatDate"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>formatDate</td><td class="funcTD">按指定掩码表示日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableformatDate"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>掩码，如'YYYY.MM.DD hh:mm:ss'、'YY年度'.<br>
上面的Y、M、D、h、m、s为掩码保留字，次序位置无规定，其含义说明如下：<br>
Y - 年，YYYY表示4位显示, YY表示显示后2位;<br>
M - 月，MM表示2位显示，不足2位的左侧以'0'填补;<br>
D - 日，DD表示2位显示，不足2位的左侧以'0'填补;<br>
Month(或Mon) - 英文的月份;<br>
Month.(或Mon.) - 英文的月份缩写;<br>
Day - 英文的星期;<br>
Day. - 英文的星期缩写;<br>
h - 小时，hh表示2位显示，不足2位的左侧以'0'填补;<br>
m - 分钟，mm表示2位显示，不足2位的左侧以'0'填补;<br>
s - 秒，ss表示2位显示，不足2位的左侧以'0'填补;<br>
</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=formatdate(now(), 'YYYY年MM月DD日')，返回值例如“2010年08月05日”<br>
=formatdate(now(), 'YYYY年M月D日')，返回值例如“2010年8月15日”<br>
=formatdate(now(), 'D, Month YYYY, day')，返回值例如“15, August 2010, Sunday”</td></tr>
</table>
<br>

<div id="TagFuncTableformatNum"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>formatNum</td><td class="funcTD">按指定掩码表示数值</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableformatNum"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数值</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>掩码，如'#,##0.00'、'共：#.00# 吨'. 掩码中'0'表示固定位、'#'表示任意位、','表示千位符.</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr><td align=right>备注</td><td colspan=2>最常用的掩码为"#,##0.00"，表示小数始终显示2位、整数部分任意但至少有1位、且以千位符分隔.</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=formatNum(12345.6, '#,##0.00')，返回“12,345.60”;<br>
=formatNum(0, '#.#')，返回空串;<br>
=formatNum(0, '#,##0.00')，返回"0.00";<br>
=formatNum(123456, '编码 00 - 00 - 00 - 00')，返回"编码 00 - 12 - 34 - 56";<br>
=formatNum(1234.5678, '00.00')，返回"34.56";</td></tr>
</table>
<br>

<div id="TagFuncTablechineseDate"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>chineseDate</td><td class="funcTD">中文的日期表示</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablechineseDate"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 掩码，默认是'YYYY年MM月DD日'</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTablechineseBankDate"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>chineseBankDate</td><td class="funcTD">中国银行的日期表示</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablechineseBankDate"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期串</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>格式，默认是'YYYY年MM月DD日'</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=chineseBankDate(now())，返回值例如“贰零壹零年零捌月壹拾伍日”</td></tr>
</table>
<br>

<div id="TagFuncTabledateDifYears"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateDifYears</td><td class="funcTD">2个日期的年度之差</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateDifYears"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>日期2</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTabledateDifMonths"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateDifMonths</td><td class="funcTD">2个日期的月份之差</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateDifMonths"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>日期2</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=dateDifMonths('2010.1.19', '2010.12.21')，返回11</td></tr>
</table>
<br>

<div id="TagFuncTabledateDifDays"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateDifDays</td><td class="funcTD">2个日期的天数之差</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateDifDays"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>日期2</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTabledateDifWorkDays"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateDifWorkDays</td><td class="funcTD">2个日期之间的工作日天数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateDifWorkDays"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>日期2</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选，定义的非工作日，以逗号分隔的纯数字，1到7表示星期一到星期日, 数字后带减号(-)表示按半天算。默认值是6,7</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
  <tr><td align=right>备注</td><td colspan=2>本函数只是粗略计算，未考虑春节、圣诞节等其它法定假日因素</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=dateDifWorkDays('2010.1.19', '2010.12.21', '6-,7')，//周六算半天、周日为非工作日</td></tr>
</table>
<br>

<div id="TagFuncTabledateDifHours"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateDifHours</td><td class="funcTD">2个日期的小时之差</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateDifHours"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>日期2</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTabledateDifMinutes"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=130><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateDifMinutes</td><td class="funcTD">2个日期的分钟数之差</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateDifMinutes"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>日期2</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTabledateAddYears"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateAddYears</td><td class="funcTD">日期增加若干年</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateAddYears"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>新的日期</td></tr>
</table>
<br>

<div id="TagFuncTabledateAddMonths"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateAddMonths</td><td class="funcTD">日期增加若干月</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateAddMonths"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>新的日期</td></tr>
</table>
<br>

<div id="TagFuncTabledateAddDays"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateAddDays</td><td class="funcTD">日期增加若干天</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateAddDays"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>新的日期</td></tr>
</table>
<br>

<div id="TagFuncTabledateAddHours"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateAddHours</td><td class="funcTD">日期增加若干小时</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateAddHours"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>新的日期</td></tr>
</table>
<br>

<div id="TagFuncTabledateAddMinutes"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=130><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dateAddMinutes</td><td class="funcTD">日期增加若干分钟</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledateAddMinutes"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数字</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>新的日期</td></tr>
</table>
<br>

<div id="TagFuncTablegetYear"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>getYear</td><td class="funcTD">取某日期的年度</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablegetYear"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablegetMonth"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>getMonth</td><td class="funcTD">取某日期的月份</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablegetMonth"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablegetDay"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>getDay</td><td class="funcTD">取某日期的日期号</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablegetDay"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablegetDayOfWeek"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>getDayOfWeek</td><td class="funcTD">求某日是星期几</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablegetDayOfWeek"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 可以是字符 C 、E</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>如果不指定参数2, 那么返回的是 0 到 6 之间的数字, 0表示星期日, 1表示星期一, ... 以此类推;<br>
如果参数2是字符 C (表示中文), 返回的将是日, 一, 二..., 六;<br>
如果参数2是字符 E (表示英文), 返回的将是Sunday, Monday, Tuesday..., Saturday;<br></td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>getDayOfWeek(now( ))<br>getDayOfWeek(now( ), 'E')</td></tr>
</table>
<br>

<div id="TagFuncTablegetDayOfYear"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>getDayOfYear</td><td class="funcTD">求某日是年度中的第几天</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablegetDayOfYear"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数字, 范围是 1 到 366</td></tr>
</table>
<br>


<div id="TagFuncTableGetHour"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>GetHour</td><td class="funcTD">取某日期时间型串的小时</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableGetHour"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablegetMinute"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>getMinute</td><td class="funcTD">取某日期时间型串的分钟</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablegetMinute"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值</td></tr>
</table>
<br>

<div id="TagFuncTablenow"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>now</td><td class="funcTD">取当前日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablenow"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>可选, 格式掩码，默认是'%Y.%m.%d %H:%M:%S'，掩码含义如下(注意大小写)：<br>
%Y - 4位数字的年;<br>
%y - 2位数字的年;<br>
%m - 月份(01至12);<br>
%d - 月中的某日(01至31);<br>
%H - 小时(24小时制，00至23);<br>
%I - 小时(12小时制，01至12);<br>
%M - 分钟(00至59);<br>
%S - 秒钟(00至59);<br>
%p - AM/PM表示上午/下午;<br>
%x - 日期的英文普遍写法;<br>
%X - 时间的英文普遍写法;<br>
%c - 日期时间的英文普遍写法;<br>
%b - 月份的英文缩写;<br>
%B - 月份的英文全称;<br>
%a - 星期的英文缩写;<br>
%A - 星期的英文全称;<br>
%w - 数字表示的星期(0至6, 0是星期天);<br>
%j - 相对于1月1日的日期差(001至366);<br>
%Z - 和GMT(或UTC)时区的时差;<br>
选项：<br>
/Z - 转换为GMT(或UTC)时间;<br>
</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>日期串</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>以北京时间2011.1.20 08:00:00为例:<br>now("%Y.%m.%dT%H:%M:%S%Z")将显示为 2011.01.20T08:00:00+08:00<br>now("%Y.%m.%dT%H:%M:%SZ/Z")将显示为 2011.01.20T00:00:00Z</td></tr>
</table>
<br>

<div id="TagFuncTablecompareDate"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>compareDate</td><td class="funcTD">比较2个日期大小</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablecompareDate"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>日期1</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>日期2</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>1、0或-1，分别表示大于、等于或小于</td></tr>
</table>
<br>

<div id="TagFuncTablefirstDateOfMonth"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=150><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>firstDateOfMonth</td><td class="funcTD">取得某日期的月初日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablefirstDateOfMonth"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>日期</td></tr>
</table>
<br>

<div id="TagFuncTablefirstDateOfSeason"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=150><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>firstDateOfSeason</td><td class="funcTD">取得某日期的季初日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablefirstDateOfSeason"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>日期</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>假如今天是2012.9.5， firstDateOfSeason(now( )) 将返回 “2012.7.1 00:00:00”</td></tr>
</table>
<br>

<div id="TagFuncTablefirstDateOfYear"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=150><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>firstDateOfYear</td><td class="funcTD">取得某日期的年初日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablefirstDateOfYear"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>日期</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>假如今天是2012.9.5， firstDateOfYear(now( )) 将返回 “2012.1.1 00:00:00”</td></tr>
</table>
<br>

<div id="TagFuncTablelastDateOfMonth"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=150><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>lastDateOfMonth</td><td class="funcTD">取得某日期的月末日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablelastDateOfMonth"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>日期</td></tr>
</table>
<br>

<div id="TagFuncTablelastDateOfSeason"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=150><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>lastDateOfSeason</td><td class="funcTD">取得某日期的季末日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablelastDateOfSeason"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>日期</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>假如今天是2012.8.5， lastDateOfSeason(now( )) 将返回 “2012.9.30 23:59:59”</td></tr>
</table>
<br>

<div id="TagFuncTablelastDateOfYear"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=150><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>lastDateOfYear</td><td class="funcTD">取得某日期的年末日期</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablelastDateOfYear"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>日期</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>日期</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>假如今天是2012.8.5， lastDateOfYear(now( )) 将返回 “2012.12.31 23:59:59”</td></tr>
</table>
<br>

<div id="TagFuncTableisNull"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>isNull</td><td class="funcTD">判断某单元格内容是否为null</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableisNull"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>列名，如果为串"data", 则表示自己(当前列)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>1/0 - 是/否</td></tr>
  <tr><td align=right>备注</td><td colspan=2>1.仅用于Treelist的表达式中;<br>
2.参数必须以引号围绕，例如 isNull('price')，否则将无法计算;<br>
3.参数可以带 @origin 宏，表示取原始数据，例如 isNull('price@origin');<br>
4.只支持数值型、日期型的列，对string列无效;<br>
5.本函数一般用于需要精确判断 0 或 null 的特定场合，在大多数情况下，直接用 price==0 判断即可，比如表达式: if(price==0, '未输入', data),  不管price的值为0或为null, 等式 "price==0" 均是成立的;<br>
</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>例一.列的属性定义:   displayMask="if(isNull('price'), '未输入', data)"<br>
例二.执行js过滤：  var s = AF.func("FindAll", "isNull('price')");</td></tr>
</table>
<br>

<div id="TagFuncTableref"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>ref</td><td class="funcTD">引用其它单元格</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableref"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>行号(从1开始计数)</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>列号(从1开始计数)</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 外部报表的URL</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>可选, 工作表序号(从1开始计数)、或工作表名, 默认是当前工作表</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>单元格内容</td></tr>
  <tr><td align=right>备注</td><td colspan=2>1.本函数的参数比较灵活，可以不按照上述的参数顺序，以下面的例子为准;<br>2.如果要从隐藏的工作表取数，那么就不能用工作表序号，必须采用工作表名;<br>3.如果是从隐藏工作表取数, 不支持下面例子中的 "B1:D3" 这种写法, 每次只能取一个单元格;<br>
4.引用单元格的原始内容、或者显示内容，由报表 “属性” 对话框的选项决定(下图右侧):<br><center><img src="image/report26.png"></center>
5.如果引用的是外部URL的报表, 只能引用原始内容;</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=ref(3,2)       //等同于 =B3<br>
=ref(3, 2, 2)   //等同于 =B3@sheet2<br>
=ref('B3', 2)   //同上例<br>
=ref('B3', '工作表二')   //取指定工作表的B3单元格<br>
=sum(ref(1,2,3,4, 5))   //等同于 =sum(B1:D3@sheet5)<br>
=sum(ref('B1:D3', 5))   //同上例<br>
=ref('B3', '../report/akk.xml')     //引用外部报表的 B3 单元格，这个URL的相对路径是当前页面<br>
=ref(3, 2, '../report/akk.xml')     //和上例同<br>
=ref('B3', '../report/akk.xml', 3)  //引用外部报表第三工作表的B3单元格<br>
=ref('B3', '../report/akk.xml', '工作表二')  //引用外部报表指定工作表的B3单元格<br>
注1："@sheet"的含义请参见下面的“宏”;<br>
注2：上面例子中如 =ref('B3', 2), 其中的单元名 'B3' 必须要用引号包绕，否则会有歧义</td></tr>
</table>
<br>


<div id="TagFuncTablerefAlias"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>refAlias</td><td class="funcTD">按别名引用其它单元格</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerefAlias"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>别名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 其它报表的绝对URL或相对URL(相对于当前页面)</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 工作表序号(从1开始计数)、或工作表名, 默认是当前工作表</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>单元格内容</td></tr>
  <tr><td align=right>备注</td><td colspan=2>1.本函数的参数比较灵活，可以不按照上述的参数顺序，以下面的例子为准;<br>2.如果要从隐藏的工作表取数，那么就不能用工作表序号，必须采用工作表名;<br>3.引用单元格的原始内容、或者显示内容，由报表 “属性” 对话框的选项决定(下图右侧):<br><center><img src="image/report26.png"></center>
4.如果引用的是外部URL的报表, 只能引用原始内容;</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=refAlias('price')      //等同于 =@Aliasprice<br>
=refAlias('price', 2)   //等同于 =@Aliasprice@sheet2<br>
=refAlias('price', '工作表二')   //取指定工作表的某别名的内容<br>
=refAlias('price', '../rpt/fin2.xml')      //引用外部报表的别名为 price 的单元格内容 (如果该外部报表有多个工作表，将逐个工作表查找别名，直到找到为止)<br>
=refAlias('price', '../rpt/fin2.xml', 3)   //从外部报表第三个工作表中查找别名为 price 的单元格内容<br>
=refAlias('price', '../rpt/fin2.xml', '工作表二')   //从外部报表指定工作表中查找别名为 price 的单元格内容<br>
注："@Alias"、"@sheet"的含义请参见下面的“宏”</td></tr>
</table>
<br>

<div id="TagFuncTablerefData"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>refData</td><td class="funcTD">引用其它单元格的原始内容</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerefData"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>备注</td><td colspan=2>1.语法和 ref 函数类似;<br>2.如果 “属性” 对话框中的选项是引用显示内容, 那么本函数只能引用单个单元格(即不支持 'B1:D3' 这种写法)</td></tr>
</table>
<br>

<div id="TagFuncTablerefText"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>refText</td><td class="funcTD">引用其它单元格的显示内容</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerefText"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>备注</td><td colspan=2>1.语法和 ref 函数类似;<br>2.如果 “属性” 对话框中的选项是引用原始内容, 那么本函数只能引用单个单元格(即不支持 'B1:D3' 这种写法)</td></tr>
</table>
<br>

<div id="TagFuncTablerefAliasData"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>refAliasData</td><td class="funcTD">按别名引用其它单元格的原始内容</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerefAliasData"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>备注</td><td colspan=2>语法和 refAlias 函数类似</td></tr>
</table>
<br>

<div id="TagFuncTablerefAliasText"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>refAliasText</td><td class="funcTD">按别名引用其它单元格的显示内容</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerefAliasText"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>备注</td><td colspan=2>语法和 refAlias 函数类似</td></tr>
</table>
<br>


<div id="TagFuncTablerow"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>row</td><td class="funcTD">取得本单元格(或指定单元格)的行号</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerow"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>单元格名，如果为空表示本单元格(即自己)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>行号，从1开始计数</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=row( )<br>=row("B11")</td></tr>
</table>
<br>

<div id="TagFuncTablecol"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>col</td><td class="funcTD">取得本单元格(或指定单元格)的列号</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablecol"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>单元格名，如果为空表示本单元格(即自己)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>列号，从1开始计数</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=col( )<br>=col("B11")</td></tr>
</table>
<br>

<div id="TagFuncTablerows"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>rows</td><td class="funcTD">取当前工作表的总行数 (包括用来封闭表格线的最后辅助行)</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablerows"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>返回值</td><td colspan=2>行数</td></tr>
</table>
<br>

<div id="TagFuncTablecols"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>cols</td><td class="funcTD">取当前工作表的总列数 (包括用来封闭表格线的最后辅助列)</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablecols"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>返回值</td><td colspan=2>列数</td></tr>
</table>
<br>



<div id="TagFuncTableCellName(语法一)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=160><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>CellName(语法一)</td><td class="funcTD">取得本单元格的单元名</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableCellName(语法一)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>单元名，如"A4"、"C13"</td></tr>
</table>
<br>

<div id="TagFuncTableCellName(语法二)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=160><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>CellName(语法二)</td><td class="funcTD">取得指定单元格的单元名</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableCellName(语法二)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>行号，从1开始计数</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>列号，从1开始计数；或列名</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>单元名，如"A4"、"C13"</td></tr>
</table>
<br>

<div id="TagFuncTablesumif(语法一)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>sumif(语法一)</td><td class="funcTD">按条件求sum</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablesumif(语法一)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>以冒号分隔的单元格区域</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>条件表达式</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>值</td></tr>
  <tr><td align=right>备注</td><td colspan=2>条件表达式的写法比较灵活，里面可以内嵌函数、引用别的单元格，比如:<br>
<b>"data > 100"</b>, 变量 data 表示单元格的数据，也可以和Excel那样，简写成 "> 100";<br>
<b>"data >= 100 + A5"</b>, A5是单元格名，表示引用该单元格数据;<br>
</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=sumif(A2:B20, ">200"); //对A2到B20区域内，数值大于200的内容求和<br>
=sumif(A2:B20, "data>K20 and data!=K21"); //对A2到B20区域内，数值大于K20单元格数据、且不等于K21单元格的内容求和</td></tr>
</table>
<br>

<div id="TagFuncTablesumif(语法二)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>sumif(语法二)</td><td class="funcTD">按某列的条件求sum</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablesumif(语法二)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>以冒号分隔的单元格区域，供条件判断用, 必须为单列</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>条件表达式，参见 语法一 中的备注</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>以冒号分隔的单元格区域，数据区, 必须为单列</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>值</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=sumif(A2:A20, ">200", B2:B20); //A2到A20区域内，数值大于200的内容，对B2:B20对应内容求和<br>
=sumif(A2:A20, "left(data, 2)='CA'", B2:B20); //以“CA”开头的单元格(A2到A20区域内容是字符串)，对应到B2:B20区域内容求和<br>
=sumif(A2:@A2, "left(data, 2)='CA'", B2:@B2); //和上例同，只是区域是数据源的填入区</td></tr>
</table>
<br>

<div id="TagFuncTablesumif(语法三)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>sumif(语法三)</td><td class="funcTD">将某些列的内容作为条件求sum</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablesumif(语法三)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>以冒号分隔的单元格区域，供条件判断用, 必须为单列</td></tr>
  <tr><td align=right>参数2、3...n</td><td colspan=2>同上，其它条件列</td></tr>
  <tr><td align=right>参数5</td><td colspan=2>条件表达式，表达式中，分别用 data1, data2, ... 来表示第一条件列、第二条件列, ...第n条件列</td></tr>
  <tr><td align=right>参数6</td><td colspan=2>以冒号分隔的单元格区域，数据区, 必须为单列</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>值</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=sumif(A2:A20, C2:C20, "data1>200 and data2>300", E2:E20); //A2到A20区域内，数值大于200的，同时 C2:C20区域内数值大于300的行，对E2:E20对应行内容求和。<br><br>这是另一个例子：<br><img src="image/pub01.png"><br>计算结果是 10.
</td></tr>
</table>
<br>

<div id="TagFuncTablecountif(语法一)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>countif(语法一)</td><td class="funcTD">按条件求单元格数, 用法请参考上面的 "sumif(语法一)"</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablecountif(语法一)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
</table>
<br>
<div id="TagFuncTablecountif(语法二)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>countif(语法二)</td><td class="funcTD">按条件求单元格数, 用法请参考上面的 "sumif(语法二)"</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablecountif(语法二)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
</table>
<br>
<div id="TagFuncTablecountif(语法三)"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>countif(语法三)</td><td class="funcTD">按条件求单元格数, 用法请参考上面的 "sumif(语法三)"</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablecountif(语法三)"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
</table>
<br>


<div id="TagFuncTablepages"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>pages</td><td class="funcTD">总共打印页数</td><td align="right" style="border-left:0px;"><img src="image/documentg.bmp" title="请参见报表demo页：19.分类汇总(一)">&nbsp;&nbsp;<a href="#func_TagFuncTablepages"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>总页数</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablepage"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>page</td><td class="funcTD">当前打印页</td><td align="right" style="border-left:0px;"><img src="image/documentg.bmp" title="请参见demo页：19.分类汇总(一)">&nbsp;&nbsp;<a href="#func_TagFuncTablepage"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>页码，从1开始计数</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablepageBatch"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>pageBatch</td><td class="funcTD">在批打印中的当前打印页</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablepageBatch"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>页码，从1开始计数</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablepagesBatch"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>pagesBatch</td><td class="funcTD">批打印的总页数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablepagesBatch"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>页数，或最大页码</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablevPages"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>vPages</td><td class="funcTD">纵向分页数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablevPages"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数字</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablevPage"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>vPage</td><td class="funcTD">纵向的当前分页</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablevPage"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>页码，从1开始计数</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablehPages"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>hPages</td><td class="funcTD">横向分页数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablehPages"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数字</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablehPage"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>hPage</td><td class="funcTD">横向的当前分页</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablehPage"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>页码，从1开始计数</td></tr>
  <tr><td align=right>备注</td><td colspan=2>在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮)</td></tr>
</table>
<br>

<div id="TagFuncTablePageSum"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>PageSum</td><td class="funcTD">分页小计 (打印页)</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablePageSum"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>列名串</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数字</td></tr>
  <tr><td align=right>备注</td><td colspan=2>1.在打印或预览时，插件内部会发起一个微小的页码处理计算，计算该函数，它并不参与常规的计算(例如点击“计算”按钮);<br>
2.本函数通常写在页尾区；<br>
3.统计范围自动选取数据源填入区</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=pageSum('D'); //对 D 列内容求本页小计</td></tr>
</table>
<br>

<div id="TagFuncTabledataRow"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dataRow</td><td class="funcTD">顺序填入数据源中的数据行</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledataRow"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据源名, 如果是XML类型的临时数据源，还可以在斜杠"\"后跟随XML节点名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 可跟随多个参数, 具体的参数由数据源规定</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=dataRow('ds1'); //表示在此处开始填入'ds1'数据源的数据<br>
=dataRow('ds1\\node1'); //表示在此处开始填入'ds1'XML数据源中node1节点的数据</td></tr>
</table>
<br>

<div id="TagFuncTableheadRow"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>headRow</td><td class="funcTD">填入数据源的标题行</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableheadRow"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据源名, 如果是XML类型的临时数据源，还可以在斜杠"\"后跟随XML节点名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 可跟随多个参数, 具体的参数由数据源规定</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=headRow('ds1')，表示本行从本单元格开始填入'ds1'数据源的列标题</td></tr>
</table>
<br>

<div id="TagFuncTabledata"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>data</td><td class="funcTD">取得数据源中的单个数据</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledata"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据源名, 如果是XML类型的临时数据源，还可以在斜杠"\"后跟随XML节点名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>行号(从1开始计数)</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>列号或列名</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>可选, 可跟随多个参数, 具体的参数由数据源规定</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数据源中的数据</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=data('ds1', 1, 'price')，表示本单元格(或本文本框)填入'ds1'数据源第一行、price列的数据</td></tr>
</table>
<br>

<div id="TagFuncTablehead"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>head</td><td class="funcTD">取得数据源的单个标题</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablehead"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据源名, 如果是XML类型的临时数据源，还可以在斜杠"\"后跟随XML节点名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>列号或列名</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>可选, 可跟随多个参数, 具体的参数由数据源规定</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>标题串</td></tr>
</table>
<br>

<div id="TagFuncTablesearch"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>search</td><td class="funcTD">从数据源中搜索</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTablesearch"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据源名, 如果是XML类型的临时数据源，还可以在斜杠"\"后跟随XML节点名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>表达式串</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>列号或列名，或者是 "列名@宏" 这样的格式，表示对搜索结果作统计，“宏” 通常是 @sum, @ave, @max, @rows...这些, 请参见下方的示例</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>可选, 可跟随多个参数, 具体的参数由数据源规定</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>结果串</td></tr>
  <tr><td align=right>备注</td><td colspan=2>是指从数据源缓存中的搜索</td></tr>
  <tr class="example"><td align=right>示例</td><td colspan=2>=search("ds1", "left(company,3)=='Lev'", "price") &nbsp;&nbsp; //取满足条件的第一条记录的 price 列的数据<br>
=search("ds1", "left(company,3)=='Lev' && classField=" + B5, "price@sum") &nbsp;&nbsp; //取满足条件的 price 列的数据之和</td></tr>
</table>
<br>

<div id="TagFuncTabledataRows"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dataRows</td><td class="funcTD">取得数据源总行数</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTabledataRows"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据源名, 如果是XML类型的临时数据源，还可以在斜杠"\"后跟随XML节点名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选, 可跟随多个参数, 具体的参数由数据源规定</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数字</td></tr>
</table>
<br>

<div id="TagFuncTabledataRowNumber"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>dataRowNumber</td><td class="funcTD">填入数据源中的行号</td><td align="right" style="border-left:0px;"><img src="image/documentg.bmp" title="请参见demo页：17.从HTML Table数据源取数(2)">&nbsp;&nbsp;<a href="#func_TagFuncTabledataRowNumber"><img border=0 src="image/arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>备注</td><td colspan=2>备注：同一行中，应该有包含dataRow( )函数的单元格</td></tr>
</table>
<br>


<br><br><br>
<script type='text/javascript' src='nstd.js'></script>
</body></html>