<HTML>
<head>
<meta http-equiv="content-type" content="text/html; charset=gb2312">
<link rel="stylesheet" href="temp1.css" type="text/css">
</head>
<body bgcolor=#ffffff vlink=#0000ff>
<br>
<p class="sz1">3.函数</p>　　<img src='image/document.bmp' title='请参见演示页: 4.树控件，该页用到了其中的几个函数'><hr color=#2266ee size=1>
　　Supcan Tree的函数是通过插件/加载项的 func( string funcname, string paras ) 函数间接调用的，Supcan Tree组件的可用funcname及用途说明如下:<br>
<table width=98% cellpadding=4 cellspacing=0 border=1 borderColorLight=#999999 borderColorDark=#999999 align="center">
<tr bgcolor=#eaeaea><td>函数名</td><td>功能</td><td>参数</td><td>返回值</td></tr>
<tr><td>ReadXML<br>或Build</td><td>读入构造树的XML/JSON</td><td>参数1: XML/JSON的URL，或者直接是XML/JSON大串<br>参数2：可选，父节点的ID，表示插入到该节点下</td><td>(无)</td></tr>
<tr><td>GetCurSel</td><td>取得当前选中项的ID</td><td>(无)</td><td>ID</td></tr>
<tr><td>SetCurSel</td><td>选中某项，当前焦点也相应转移</td><td>ID</td><td>(无)</td></tr>
<tr><td>GetParent</td><td>取得父节点的ID</td><td>ID</td><td>父的ID</td></tr>
<tr><td>GetChild</td><td>取得第一个子节点的ID</td><td>ID，空串表示根</td><td>子的ID</td></tr>
<tr><td>GetNextSibling</td><td>取得下一个兄弟节点的ID</td><td>ID</td><td>兄弟的ID</td></tr>
<tr><td>DeleteItem</td><td>删除某项，包括其子孙</td><td>ID，空串表示根(删除全部)</td><td>(无)</td></tr>
<tr><td>InsertItem</td><td>插入一项</td><td>参数1: ID，须尚未存在<br>参数2(可选): PID，空串表示根节点<br>参数3(可选): text<br>参数4(可选): true/false, 表示在最后追加还是在最前面插入(默认true, 即追加)</td><td>true/false</td></tr>
<tr><td>Expand<br>(用法1)</td><td>展开某项 (但不包括其子孙)</td><td>ID</td><td>(无)</td></tr>
<tr><td>Expand<br>(用法2)</td><td>展开树的前 n 层</td><td>参数1: 固定的"Level" + 数字，表示展开前 n 层，例如"Level1"、"Level2";<br>参数2(可选)：ID，表示仅展开该节点下的前 n 层;</td><td>(无)</td></tr>
<tr><td>ExpandAll</td><td>展开全部项，包括其子孙</td><td>(无)</td><td>(无)</td></tr>
<tr><td>Collapse</td><td>收拢某项</td><td>ID</td><td>(无)</td></tr>
<tr><td>CollapseAll</td><td>收拢全部项</td><td>(无)</td><td>(无)</td></tr>
<tr><td>GetXMLProp</td><td>取得XML某ID的属性值</td><td>参数1: ID<br>参数2: 可为PID、text、para、tip、img、textColor或任意属性</td><td>串</td></tr>
<tr><td>SetXMLProp</td><td>设置XML某ID的属性值</td><td>参数1: ID<br>参数2: 可为PID、text、para、tip、img、textColor或任意属性<br>参数3: 值<br>注：参数2为PID表示更改父节点，作为参数1的ID须为树叶才能生效</td><td>(无)</td></tr>
<tr><td>ChangeImage</td><td>替换图标</td><td>参数1:树杈的图标，写法请参考创建参数"NodeImage"属性<br>参数2:树叶的图标，写法请参考创建参数"LeafImage"属性</td><td>(无)</td></tr>
<tr><td>SetCheck</td><td>设置Check</td><td>参数1:ID<br>参数2:true/false<br>备注：仅用于创建参数Style含hasCheckbox</td><td>(无)</td></tr>
<tr><td>GetCheck</td><td>取得Check</td><td>参数:ID<br>备注：仅用于创建参数Style含hasCheckbox</td><td>true/false</td></tr>
<tr><td>GetCheckedIDs</td><td>取得所有Check=true的ID</td><td>(无)<br>备注：仅用于创建参数Style含hasCheckbox</td><td>ID串, 以逗号分隔</td></tr>
</table>
<br>
<img src='image/glass.bmp' class="imgleft"><p class="glass">注：函数中的ID参数是<font color=red>大小写敏感</font>的!</p>
　　此外，Tree还拥有一组和Treelist、Freeform完全一样的全局函数，请参见<a href="globalfunction.htm" target=_blank>全局函数</a>介绍。<br>


<br><br><br>
<script type='text/javascript' src='nstd.js'></script>
</body></html>