<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?103'></script>
<script language="JavaScript">
 function OnReady(id)
 {
  AF.func("Build", "report/xmlsheet12.xml");
  AF.func("Swkrntpomzqa", "512");
  AF.func("calc", "");
 }
 function commit( )
 {
  var xml = AF.func("GetChangedXML", "");
  xml = xml.replace(/\r\n/g, "\\r\\n");
  AF.func("MessageBoxFloat", xml + "\r\n center=true;hold=20");

 }
</script>
</head>

<body>
<center>

<table cols=2 border=0 width=100%>
<col valign=top width=110>
<col>
<tr>
<td align=center><img src='res/how.bmp'></td>
<td><b>1</b>.本例的 Workmode 为 <b>InputDSRuntime</b>,  该模式专门用于修改数据源填入区并提交； <br>
<b>2</b>.黄色背景区域是数据源的填入区，请在该区域内输入(增删改)； <br>
<b>3</b>.最终点击下方的 "提交" 按钮，请查看返回的XML串； <br>
</td>
</tr>
</table>

<div style="position:relative;width:87%;height:450px">
	<script>insertReport('AF', 'workMode=inputDSRunTime')</script>
</div>
<br>
<input type="button" value="  提交  " OnMouseUp="commit( )"/>

<!--  以下为技术分析区 -->
<br><br><br>
<table border=0 cols=1 border=0 width=97% style='line-height:21px'>
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<br><b>1</b>.源码如下：<br>
<pre class='cpp'>
function OnReady(id)
{
 AF.func("Build", "report/xmlsheet12.xml");   //打开模板
 AF.func("Swkrntpomzqa", "512");   //设定权限：不允许增删列
 AF.func("calc", "");    //计算(从数据源加载数据)
}
 
//提交按钮
function commit( )
{
 var xml = AF.func("GetChangedXML", "");
 xml = xml.replace(/\r\n/g, "\\r\\n");
 AF.func("MessageBoxFloat", xml + "\r\n center=true;hold=20");

}</pre>
<br>
<b>2</b>.注意事项<br>
函数 GetChangedXML 通常需要结合 InputDSRuntime 工作模式 (Workmode) 一起用，Workmode除了写在创建参数中，也可以通过 SetProp 函数动态修改.

</td></tr></table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</html>