<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?103'></script>
<script language="JavaScript">
function OnReady(id)
{
 AF.func("Build", "report/htmltable2.xml");
}
function Retrieve()
{
 AF.func('SetSource', 'ds1\r\n' + document.getElementById('source').value);
 AF.func('Calc', '');
}
</script>
</head>

<body>
<center>

<table cols=2 border=0 width=100%>
<col valign=top width=90>
<col>
<tr>
<td align=center><img src='res/how.bmp'></td>
<td>数据源URL：<input id='source' type=edit size=30 value="reportdata/findata.htm"> <input type=button value=" 取数 " onClick="Retrieve()">， 演示动态列：从数据源填入后，列将自动和实际数据列匹配.</td>
</tr></table>

<br>
<div style="position:relative;width:94%;height:420px">
	<script>insertReport('AF', '')</script>
</div>


<!--  以下为技术分析区 -->
<br><br><br>
<table border=0 cols=1 border=0 width=97% style='line-height:21px'>
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<b>1</b>.打开数据源管理(<img src='res/ds.bmp'>)，如下选项决定了是否动态生成列：<br>
<img src='res/illu7.jpg'><br><br>
<b>2</b>.可查看该<a href="reportdata/findata.htm" target=_blank>HTML数据</a>：<br>
<br>
<b>3</b>.由于动态插入的列缺少格式的定义，为此我们允许为HTML中的&lt;TH&gt;加点“糖”：<br>
<pre class='xml'>
...
&lt;table border=1 cellspacing=0 cellpadding=3&gt;
 &lt;tr&gt;
  &lt;th&gt;基金代码&lt;/th&gt;
  &lt;th&gt;基金简称&lt;/th&gt;
  &lt;th datatype="double" decimal="4" align="right"&gt;单位净值&lt;/th&gt;
  &lt;th datatype="double" decimal="4" align="right"&gt;累计净值&lt;/th&gt;
  &lt;th&gt;涨跌值&lt;/th&gt;
  ...</pre>
如果不指定数据类型，则默认是 string 型; 如果是double型，小数位数默认是2位; 如果align未定义，默认参照插入列的对齐.<br>
<br>
<b>4</b>.B4单元格使用了 dataRowNumber( ) 函数，能自动生成数据的行号：<br>
备注: 该函数是通用的数据源函数，和动态列没有任何关系.<br>
</td></tr></table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</html>