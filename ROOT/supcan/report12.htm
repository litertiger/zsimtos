<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?103'></script>
<script language="JavaScript">
var countForFirefox = 0;
function OnReady(id)
{
 cooper(id);
}
function OnLoadPage( )
{
 if($isFirefox) cooper('');
}
function cooper(id)
{
 if($isFirefox) {
  countForFirefox++;
  if(countForFirefox != 3) return;
 }
 if(id == 'AF1' || $isFirefox) {
  AF1.func("Build", "report/report_dict1.xml");
  AF1.func("CallFunc", "301\r\n 4");

 }
 if(id == 'AF2' || $isFirefox) {
  AF2.func("Build", "report/report_dict2.xml");
  AF2.func("CallFunc", "301\r\n 4");

 }
}
</script>
</head>

<body onLoad="OnLoadPage( )">
<center>

<table cols=2 border=0 width=100%>
<col valign=top width=90>
<col>
<tr height=50>
<td align=center><img src='res/how.bmp'></td>
<td><b>例一</b><br><b>1</b>.区域、省份、城市下拉是有关联关系的，请试着下拉； &nbsp;&nbsp;&nbsp;<b>2</b>.请打开工具箱字典的“城市”设置； &nbsp;&nbsp;&nbsp;<b>3</b>.看一下C3单元格的“下拉框选择输入”属性页的“参数”设置；</td>
</tr></table>

<div style="position:relative;width:100%;height:380px">
	<script>insertReport('AF1', 'collapseToolbar=true')</script>
</div>
<br>

<table cols=2 border=0 width=100%>
<col valign=top width=90>
<col>
<tr height=50>
<td align=center><img src='res/how.bmp'></td>
<td><b>例二</b><br>操作界面和例一几乎一样，但字典定义、参数方式完全不一样，请打开工具箱查看字典设置，并比较“参数”的写法差异；</td>
</tr></table>

<div style="position:relative;width:100%;height:380px">
	<script>insertReport('AF2', 'collapseToolbar=true')</script>
</div>
<br>

<!--  以下为技术分析区 -->
<br><br><br>
<table border=0 cols=1 border=0 width=97% style='line-height:21px'>
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<b>1</b>.例一分析：下图的 "城市" 字典开启了“关联下拉模式”，左侧的“参数”列表枚举了所有的省份，相当于按照此参数将城市分门别类：<br>
<center><img src='res/illu-dict1.png'></center>
在城市下拉的单元格中(如C3、C4、C5...)，需要指定参数的来源，报表中省份的下拉是B3单元格:
<center><img src='res/illu-dict2.png'></center>
<br>
<br>
<b>2</b>.例二分析：和上例不一样，“城市”字典没有使用关联参数模式，而是将所有城市都一个列表中，通过键值和省份关联, 左侧是省份字典，右侧是城市字典：<br>
<center><img src='res/illu-dict3.png'></center>
城市和省份的关联，是提供表达式计算实现的：
<center><img src='res/illu-dict4.png'></center>
<br>
<br>
<b>3</b>.上述二种方案的优劣对比说明；<br>
<center>
<table border=1>
	<col width="60">
	<col width="260">
	<col width="260">
	<tr><td></td><td>下拉数据来源</td><td>导出为Excel xlsx文件</td></tr>
	<tr><td>方案一</td><td>必须手工录入</td><td>Excel 中也依然能保持这种关联关系</td></tr>
	<tr><td>方案二</td><td>能从数据源加载，也可以手工录入</td><td>无法保持关联</td></tr>
</table></center>
<br>
<b>4</b>.此外，有一个和关联下拉有关的设置；<br>
<center><img src='res/illu-dict5.png'></center>
<br>
<b>5</b>.最后，请您进一步关注另外一种动态从数据源取数的关联方式，即演示页“31.一体化查询(2)”，该例的字典每次关联，都是动态从数据源加载数据的.<br>
</td></tr></table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</HTML>
