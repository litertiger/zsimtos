{
 "hidden": false,
 "children": [{
  "configs": {"itemId": "module"},
  "expanded": true,
  "children": [
   {
    "configs": {
     "layout": "@{type:'table',columns:1}",
     "itemId": "editwin",
     "dialog": "true",
     "defaults": "{\
  labelWidth: 80,\
  width: 200,\
  margin: '8 8 0 8'\
}",
     "closeAction": "hide",
     "autoReset": "true",
     "height": "140"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "BILL_NO",
       "labelAlign": "right",
       "fieldLabel": "提单号"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "RECEIPTNO",
       "labelAlign": "right",
       "fieldLabel": "放行条号"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     }
    ],
    "type": "window"
   },
   {
    "configs": {
     "layout": "fit",
     "itemId": "viewport1"
    },
    "expanded": true,
    "children": [{
     "configs": {
      "layout": "fit",
      "itemId": "panel1",
      "height": "150"
     },
     "expanded": true,
     "children": [{
      "configs": {"itemId": "grid1"},
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "store",
         "autoLoad": "true",
         "url": "m?xwl=MiscellJob/cangchuKl/inKlEdit/select"
        },
        "expanded": true,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": false,
        "children": [
         {
          "configs": {
           "itemId": "column1",
           "xtype": "rownumberer",
           "width": "40",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "KL09",
           "xtype": "checkcolumn",
           "dataIndex": "KL",
           "width": "40",
           "disabled": "true",
           "text": "扣留",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR9281",
           "dataIndex": "CNTR",
           "text": "箱号",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "BILL_ID22",
           "hidden": "true",
           "dataIndex": "BILL_ID",
           "text": "提单主键",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "BILL_NO12",
           "dataIndex": "BILL_NO",
           "text": "提单号",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "GOODS74",
           "dataIndex": "GOODS",
           "text": "货名",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "QUTY3",
           "dataIndex": "QUTY",
           "width": "40",
           "text": "库存",
           "align": "right",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "WEIGHT132",
           "dataIndex": "WEIGHT",
           "width": "40",
           "text": "重量",
           "align": "right",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CFS_ID741",
           "dataIndex": "CFS_ID",
           "keyName": "C_BLUK",
           "text": "仓库编码",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "LOCATION2",
           "dataIndex": "LOCATION",
           "text": "位置",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "OUTQUTY23",
           "dataIndex": "OUTQUTY",
           "width": "120",
           "text": "出库数",
           "align": "right",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "VOLUME12",
           "dataIndex": "VOLUME",
           "width": "40",
           "text": "体积",
           "align": "right",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CARGO_TYPE12",
           "dataIndex": "CARGO_TYPE",
           "keyName": "CARGO_TYPE",
           "text": "货物属性",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_OPERATOR458",
           "dataIndex": "CNTR_OPERATOR",
           "text": "驳船",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "OUTTIME11",
           "dataIndex": "OUTTIME",
           "text": "出库时间",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SHIPPER12",
           "dataIndex": "SHIPPER",
           "text": "货主",
           "titleAlign": "true"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       },
       {
        "configs": {
         "itemId": "tbar",
         "padding": "0,0,0,0",
         "cls": "border-width:0px",
         "dock": "top"
        },
        "expanded": false,
        "children": [
         {
          "configs": {
           "itemId": "type",
           "labelAlign": "right",
           "pickList": "[\
  ['0','仓库位置'],\
  ['1','货位'],\
  ['2','品名'],\
  ['3','货主'],\
  ['4','驳船公司'],\
  ['5','提单号']\
]",
           "fieldLabel": "选择",
           "x": "0",
           "width": "150",
           "y": "8",
           "labelWidth": "40",
           "value": "5",
           "height": "22"
          },
          "expanded": false,
          "children": [],
          "type": "combo"
         },
         {
          "configs": {
           "itemId": "goodsName",
           "x": "152",
           "width": "150",
           "y": "8",
           "isUpperCase": "true",
           "height": "22"
          },
          "expanded": false,
          "children": [],
          "type": "text",
          "events": {"specialkey": "app.findMenu.fireEvent('click');"}
         },
         {
          "configs": {
           "itemId": "name",
           "hidden": "true",
           "labelAlign": "right",
           "fieldLabel": "提单号",
           "width": "180",
           "isUpperCase": "true",
           "labelWidth": "50"
          },
          "expanded": false,
          "children": [],
          "type": "text",
          "events": {"specialkey": "app.findMenu.fireEvent('click');"}
         },
         {
          "configs": {
           "itemId": "goods",
           "hidden": "true",
           "labelAlign": "right",
           "fieldLabel": "货名",
           "labelWidth": "50"
          },
          "expanded": false,
          "children": [],
          "type": "text",
          "events": {"specialkey": "app.findMenu.fireEvent('click');"}
         },
         {
          "configs": {
           "itemId": "type11",
           "hidden": "true",
           "labelAlign": "right",
           "fieldLabel": "类型",
           "keyName": "CRAFTWORK",
           "width": "140",
           "labelWidth": "40"
          },
          "expanded": false,
          "children": [],
          "type": "combo"
         },
         {
          "configs": {
           "itemId": "findMenu",
           "tooltip": "查找一条记录",
           "text": "查找",
           "iconCls": "seek_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "app.grid1.store.load({\
  out:app.tbar\
});\
"}
         },
         {
          "configs": {
           "itemId": "addBtn",
           "hidden": "true",
           "text": "增加",
           "iconCls": "record_add_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "app.editwin.setTitle('添加 ' );\
app.editwin.setIconCls('record_add_icon');\
app.WORKDATE.setValue(new Date());\
app.editwin.show();\
app.isEdit = false; //标识是否为添加或修改状态，在editWin的ok事件中用到此属性\
\
\
// if (!Wb.verifyGrid(app.panelWorkBill)) //验证数据是否合法\
//   return;\
// Wb.request({\
//   url: 'm?xwl=MiscellJob/bluk/PortCntr/WorkBillEdit/insert',\
//   params: {},\
//   out:app.panelWorkBill,\
//   success: function(resp) {\
//   \tWb.warn(\"成功\");\
//   }\
// });"}
         },
         {
          "configs": {
           "itemId": "updateBtn",
           "hidden": "true",
           "text": "修改",
           "iconCls": "record_edit_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.grid1.getSelection();\
if (sels.length != 1) {\
  Wb.warn('请选择 1 条需要修改的记录。');\
  return;\
}\
//\
app.selRec = sels[0];\
app.editwin.setTitle('修改 ');\
app.editwin.setIconCls('record_edit_icon');\
Wb.setValue(app.editwin, app.selRec.data);\
app.editwin.show();\
app.isEdit = true; //标识是否为添加或修改状态，在editWin的ok事件中用到此属性\
\
// var row=app.grid1.getSelection();\
// if(row.length<1){\
// \tWb.warn(\"选择一条数据修改！\");\
//   return;\
// }\
\
// app.panelWorkBill.setValue(row.value);\
// if (!Wb.verifyGrid(app.panelWorkBill)) //验证数据是否合法\
//   return;\
// Wb.request({\
//   url: 'm?xwl=MiscellJob/bluk/PortCntr/WorkBillEdit/insert',\
//   params: {},\
//   out:app.panelWorkBill,\
//   success: function(resp) {\
//   \tWb.warn(\"成功\");\
//   }\
// });"}
         },
         {
          "configs": {
           "itemId": "delBtn",
           "hidden": "true",
           "text": "删除",
           "iconCls": "record_delete_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.grid1.getSelection();\
if (sels.length < 1) {\
  Wb.warn(\"请选择一条要删除的记录!\");\
  return;\
}\
\
Wb.confirmDo(sels, function() {\
  Wb.request({\
    url: 'm?xwl=MiscellJob/bluk/PortCntr/WorkBillEdit/delete',\
    params: {\
      destroy: Wb.getData(sels, true)\
    },\
    success: function() {\
      Wb.remove(app.grid1, sels);\
    }\
  });\
}, 'BILL_NO');"}
         }
        ],
        "type": "toolbar"
       },
       {
        "configs": {
         "itemId": "popupMenu",
         "normalName": "klmenu"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "releaseBtn",
           "text": "放行",
           "iconCls": "ok_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var rowData = app.klmenu.selectRow.data;\
var win = new Ext.window.Window(app._editwin);\
Wb.reset(app.editwin);\
win.show();\
app.BILL_NO.setValue(rowData.BILL_NO);\
win.setIconCls('record_edit_icon');\
win.mon(win, 'ok', function() {\
  Wb.request({\
    url: 'm?xwl=MiscellJob/cangchuKl/outKlEdit/updateKl',\
    params: {\
      ID: rowData.BILL_ID\
    },\
    out:win,\
    success: function(resp) {\
      win.close();\
      Wb.info(\"放行成功\");\
      app.grid1.store.load({\
        out: app.tbar\
      });\
    }\
  });\
});"}
         },
         {
          "configs": {
           "itemId": "wBtn",
           "hidden": "true",
           "text": "作业票",
           "iconCls": "ok_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var rowData = app.klmenu.selectRow.data;\
\
Wb.run({\
  url: 'm?xwl=entrepot/PortCntrWeight/work-control',\
  params: {\
    TYPE: 'JZ',\
    WEIGHT:rowData.WEIGHT,\
    VOLUME:rowData.VOLUME,\
    BILL_ID:rowData.BILL_ID,\
    BILL_NO:rowData.BILL_NO\
  },\
  success: function(appnew) {\
    var win = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
    win.show();\
    appnew.grid1.store.load({\
      params: {\
        BILL_ID: rowData.BILL_ID,\
        TYPE:'JZ'\
      }\
    });\
\tappnew.numbers.setText(Wb.work(rowData.WEIGHT,rowData.VOLUME));\
  }\
});"}
         }
        ],
        "type": "menu",
        "events": {"show": "var rows = app.grid1.getSelection();\
app.releaseBtn.setDisabled(rows.length != 1);\
app.wBtn.setDisabled(rows.length != 1);\
if (rows.length === 0) {\
  return;\
}\
menu.selectRow = rows[0];"}
       }
      ],
      "type": "grid",
      "events": {
       "itemclick": "\
// app.cntrGrid.store.load( { params:{vid:record.get(\"ID\"),ieId:app.ieId}});\
// Wb.info(record.data.ID);",
       "tagEvents": "{\
  'itemcontextmenu': function(view, record, item, index, e, eOpts) {\
\t//禁用浏览器右键的事件\
    e.preventDefault();\
    e.stopEvent();\
  }\
}"
      }
     }],
     "type": "panel"
    }],
    "type": "viewport"
   }
  ],
  "type": "module"
 }],
 "roles": {
  "ZSJJ": 1,
  "SCANJB": 1,
  "ZSBF": 1,
  "DCXK": 1,
  "SWB": 1
 },
 "title": "进口放行",
 "iconCls": "blue-weight_icon",
 "inframe": false,
 "pageLink": ""
}