{
 "hidden": false,
 "children": [{
  "configs": {"itemId": "module"},
  "expanded": true,
  "children": [
   {
    "configs": {
     "layout": "@{type:'table',columns:1}",
     "itemId": "editwin",
     "dialog": "true",
     "defaults": "{\
  labelWidth: 100,\
  width: 260,\
  margin: '8 8 0 8'\
}",
     "width": "300",
     "height": "200"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "PID",
       "hidden": "true"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "MACH_ID",
       "labelAlign": "right",
       "fieldLabel": "机械号"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "MACH_NAME",
       "labelAlign": "right",
       "fieldLabel": "机械名称"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "START_DATE",
       "labelAlign": "right",
       "fieldLabel": "维护开始时间"
      },
      "expanded": false,
      "children": [],
      "type": "datetime"
     },
     {
      "configs": {
       "itemId": "END_DATE",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "维护结束时间"
      },
      "expanded": false,
      "children": [],
      "type": "datetime"
     },
     {
      "configs": {
       "itemId": "NOTE",
       "labelAlign": "right",
       "fieldLabel": "维护原因"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     }
    ],
    "type": "window"
   },
   {
    "configs": {
     "layout": "fit",
     "dialog": "true",
     "itemId": "Win",
     "width": "310",
     "height": "260"
    },
    "expanded": true,
    "children": [{
     "configs": {
      "layout": "absolute",
      "itemId": "panelWin",
      "width": "392",
      "height": "230"
     },
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "ETM_CLASS",
        "labelAlign": "right",
        "fieldLabel": "类型",
        "x": "4",
        "width": "270",
        "y": "10",
        "displayField": "NAME",
        "labelWidth": "60",
        "valueField": "COD",
        "height": "22"
       },
       "expanded": false,
       "children": [{
        "configs": {
         "itemId": "store",
         "autoLoad": "true",
         "url": "m?xwl=controlManage/work/cEmployeeTeam1/selectETM"
        },
        "expanded": false,
        "children": [],
        "type": "store",
        "events": {"beforeload": "operation.params = {len:app.Len.getValue()};"}
       }],
       "type": "combo"
      },
      {
       "configs": {
        "itemId": "TEAM_NAME",
        "labelAlign": "right",
        "fieldLabel": "班组名称",
        "width": "270",
        "x": "4",
        "y": "40",
        "labelWidth": "60",
        "height": "22"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "TEAM_TYPE",
        "labelAlign": "right",
        "fieldLabel": "班组类型",
        "width": "270",
        "x": "4",
        "y": "70",
        "labelWidth": "60",
        "height": "22"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "HAND_CODE",
        "labelAlign": "right",
        "fieldLabel": "快捷代码",
        "x": "4",
        "width": "270",
        "y": "104",
        "labelWidth": "60",
        "height": "22"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "NOTE",
        "labelAlign": "right",
        "fieldLabel": "备注",
        "x": "4",
        "width": "270",
        "y": "132",
        "labelWidth": "60",
        "height": "56"
       },
       "expanded": false,
       "children": [],
       "type": "textarea"
      },
      {
       "configs": {
        "itemId": "DEPT",
        "hidden": "true",
        "labelAlign": "right",
        "pickList": "[\
  [0,'菜单'],[1,'功能'],[2,'子系统']\
]",
        "fieldLabel": "部门",
        "width": "270",
        "x": "240",
        "y": "168",
        "labelWidth": "60",
        "height": "22"
       },
       "expanded": false,
       "children": [],
       "type": "combo"
      },
      {
       "configs": {
        "itemId": "Len",
        "hidden": "true",
        "x": "344",
        "width": "240",
        "y": "120",
        "height": "22"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "ID",
        "hidden": "true",
        "fieldLabel": "主键",
        "x": "240",
        "width": "240",
        "y": "118",
        "height": "22"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      }
     ],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var values = Wb.getValue(app.Win);\
if (app.isEdit) {\
  Wb.request({\
    url: 'm?xwl=controlManage/work/cEmployeeTeam1/updateTree',\
    params: Wb.applyIf(values, Wb.getData(app.selNode, true)),\
    success: function() {\
      values.text = values.TEAM_NAME;\
      Wb.update(app.selNode, values);\
      app.Win.close();\
    }\
  });\
} else {\
  Wb.request({\
    url: 'm?xwl=controlManage/work/cEmployeeTeam1/insertTee', \
    out: app.Win,\
    params:{\
      PID: app.selNode.data.ID,\
      TENANCY_ID:'{#sys.TENANCY_ID#}',\
      ORDER_INDEX: app.selNode.lastChild ? app.selNode.lastChild.data.ORDER_INDEX + 1 : 1\
    },\
    success: function(resp) {\
      //根据closeAction属性，默认为销毁\
      app.selNode.expand();\
      app.selNode.appendChild(Wb.apply({\
        iconCls: 'db_field_icon',\
        text: values.TEAM_NAME,\
        children: []\
      }, Wb.decode(resp.responseText))).commit();\
      app.Win.close(); \
    }\
  });\
}"}
   },
   {
    "configs": {
     "itemId": "winEmp",
     "editWin": "true"
    },
    "expanded": false,
    "children": [{
     "configs": {
      "layout": "fit",
      "itemId": "panel1",
      "height": "320"
     },
     "expanded": true,
     "children": [{
      "configs": {
       "itemId": "gridWEmp",
       "selType": "checkboxmodel",
       "width": "568",
       "region": "center",
       "height": "296"
      },
      "expanded": true,
      "children": [
       {
        "configs": {"itemId": "tbar"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "empType1",
           "hidden": "true",
           "labelAlign": "right",
           "pickList": "[\
  ['1', '司机'],\
  ['4', '工人']\
]",
           "fieldLabel": "工种",
           "width": "120",
           "labelWidth": "40"
          },
          "expanded": false,
          "children": [],
          "type": "combo"
         },
         {
          "configs": {
           "layout": "hbox",
           "itemId": "radioEmp",
           "width": "220",
           "style": "padding-left:20px;"
          },
          "expanded": false,
          "children": [
           {
            "configs": {
             "itemId": "radioDriver",
             "boxLabel": "司机",
             "flex": "1",
             "name": "radioEmp",
             "checked": "true"
            },
            "expanded": false,
            "children": [],
            "type": "radio",
            "events": {"change": "app.findButton.fireEvent('click');"}
           },
           {
            "configs": {
             "itemId": "radioWorker",
             "boxLabel": "工人",
             "flex": "1",
             "name": "radioEmp"
            },
            "expanded": false,
            "children": [],
            "type": "radio",
            "events": {"change": "app.findButton.fireEvent('click');"}
           },
           {
            "configs": {
             "itemId": "radioOutDriver",
             "boxLabel": "外拖司机",
             "flex": "1",
             "name": "radioEmp"
            },
            "expanded": false,
            "children": [],
            "type": "radio",
            "events": {"change": "app.findButton.fireEvent('click');"}
           }
          ],
          "type": "container"
         },
         {
          "configs": {
           "itemId": "name",
           "labelAlign": "right",
           "fieldLabel": "名称",
           "width": "150",
           "labelWidth": "40"
          },
          "expanded": false,
          "children": [],
          "type": "text",
          "events": {"specialkey": "app.findButton.fireEvent('click');"}
         },
         {
          "configs": {
           "itemId": "findButton",
           "text": "查询",
           "iconCls": "seek_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "app.gridWEmp.store.load({\
  params: {\
    worker: app.radioWorker.getValue(),\
    driver: app.radioDriver.getValue(),\
    name: app.name.getValue()\
  }\
});"}
         }
        ],
        "type": "toolbar"
       },
       {
        "configs": {
         "itemId": "store",
         "url": "m?xwl=controlManage/work/cEmployeeTeam1/employee/getEmployee"
        },
        "expanded": false,
        "children": [],
        "type": "store",
        "events": {"beforeload": "operation.params = {\
  worker: app.radioWorker.getValue(),\
  driver: app.radioDriver.getValue(),\
  outDriver:app.radioOutDriver.getValue(),\
  name: app.name.getValue()\
};"}
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "id",
           "hidden": "true",
           "dataIndex": "MENU_ID",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "row",
           "xtype": "rownumberer",
           "text": "序号",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "empName",
           "dataIndex": "EMPNAME",
           "text": "人员名称",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "workType",
           "dataIndex": "WORK_TYPE",
           "text": "工种",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "duty",
           "dataIndex": "DUTY",
           "text": "职称",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "pocketTel",
           "dataIndex": "POCKETTEL",
           "text": "联系电话",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "note",
           "dataIndex": "NOTE",
           "text": "住址",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid"
     }],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var rec = app.gridWEmp.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择至少1条人员信息。');\
  return;\
}\
\
var rows = app.gridWEmp.getSelection();\
var IDS = new Array(); \
Wb.each(rows,function(row){\
  IDS.push({ID:row.data.ID});\
});\
\
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/employee/insertEmployee',\
  params:{IDS:IDS,workGroup:app.selNode.data.ID},\
  success: function(resp) {\
    app.findEmpBtn.fireEvent('click'); \
    win.close();\
  }\
}); \
"}
   },
   {
    "configs": {
     "itemId": "winTruck",
     "editWin": "true"
    },
    "expanded": false,
    "children": [{
     "configs": {
      "layout": "fit",
      "itemId": "panel1",
      "height": "320"
     },
     "expanded": true,
     "children": [{
      "configs": {
       "itemId": "gridWTruck",
       "selType": "checkboxmodel",
       "width": "568",
       "region": "center",
       "height": "296"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "store",
         "url": "m?xwl=controlManage/work/cEmployeeTeam1/machine/getMachineTruck"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "id",
           "hidden": "true",
           "dataIndex": "MENU_ID",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "row",
           "xtype": "rownumberer",
           "text": "序号",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "MACH_NAME",
           "dataIndex": "ID",
           "text": "车号",
           "align": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "platNo",
           "dataIndex": "MACH_NAME",
           "text": "车牌号",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "trayNo",
           "dataIndex": "TRAY_NO",
           "text": "托盘号",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "truckerNam",
           "dataIndex": "MACH_NAM",
           "text": "司机",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "phase",
           "renderer": "if(value =='IDL'){\
  return '空闲';\
}\
if(value == 'FUL'){\
  return '满载';\
}\
if(value == 'RET'){\
  return '轮休';\
}",
           "dataIndex": "MACH_STATU",
           "text": "状态",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid"
     }],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var rec = app.gridWTruck.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择至少1条拖车信息。');\
  return;\
}\
\
var rows = app.gridWTruck.getSelection();\
var IDS = new Array(); \
Wb.each(rows,function(row){\
  IDS.push({ID:row.data.ID});\
});\
 \
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/truck/insertTruck',\
  params:{IDS:IDS,workGroup:app.selNode.data.ID},\
  success: function(resp) {\
    app.findTruckBtn.fireEvent('click'); \
    win.close();\
  }\
}); \
"}
   },
   {
    "configs": {
     "itemId": "winMachine",
     "editWin": "true"
    },
    "expanded": false,
    "children": [{
     "configs": {
      "layout": "fit",
      "itemId": "panel1",
      "height": "320"
     },
     "expanded": true,
     "children": [{
      "configs": {
       "itemId": "gridWMachine",
       "selType": "checkboxmodel",
       "width": "568",
       "region": "center",
       "height": "296"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "store",
         "url": "m?xwl=controlManage/work/cEmployeeTeam1/machine/getMachine"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "id",
           "hidden": "true",
           "dataIndex": "MENU_ID",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "row",
           "xtype": "rownumberer",
           "text": "序号",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "machName",
           "dataIndex": "MACH_NAME",
           "text": "设备名称",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "machType",
           "dataIndex": "MACH_TYPE",
           "keyName": "C_MACHINE_TYPE",
           "text": "设备类型",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "machNam",
           "dataIndex": "MACH_NAM",
           "text": "司机",
           "align": "center",
           "titleAlign": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid"
     }],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var rec = app.gridWMachine.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择至少1条人员信息。');\
  return;\
}\
var rows = app.gridWMachine.getSelection();\
var IDS = new Array(); \
Wb.each(rows,function(row){\
  IDS.push({ID:row.data.ID});\
});\
 \
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/machine/insertMachine',\
  params:{IDS:IDS,workGroup:app.selNode.data.ID},\
  success: function(resp) {\
    app.findMachineBtn.fireEvent('click');\
    win.close();\
  }\
}); \
"}
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "viewport1"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "layout": "fit",
       "itemId": "panel1",
       "width": "300",
       "region": "west"
      },
      "expanded": true,
      "children": [{
       "configs": {
        "itemId": "tree1",
        "root": "{\
  text: '全部',\
  ID: '-1',\
  expanded: true\
}",
        "viewConfig": "app.treeViewConfig",
        "multiSelect": "true"
       },
       "expanded": true,
       "children": [
        {
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "fields": "['text', 'ETM_CLASS', 'TEAM_NAME', 'HAND_CODE','TEAM_TYPE', 'NOTE', 'DEPT', 'ID', 'PID', 'ORDER_INDEX']",
          "url": "m?xwl=controlManage/work/cEmployeeTeam1/selectTree"
         },
         "expanded": false,
         "children": [],
         "type": "treestore",
         "events": {"success": "//Wb.selFirst(app.tree1);"}
        },
        {
         "configs": {
          "itemId": "tbar",
          "enableOverflow": "true"
         },
         "expanded": true,
         "children": [
          {
           "configs": {
            "itemId": "addTree",
            "text": "新增",
            "iconCls": "db_add_icon"
           },
           "expanded": false,
           "children": [],
           "type": "button",
           "events": {"click": "if (!app.selNode) {\
  Wb.warn('请选择 1 个班组。');\
  return;\
}\
app.Win.setTitle('添加 - ' + app.selNode.data.text);\
app.Win.setIconCls('record_add_icon');\
app.TEAM_NAME.setValue(\"\");\
app.TEAM_TYPE.setValue(\"\");\
app.HAND_CODE.setValue(\"\");\
app.NOTE.setValue(\"\");\
app.DEPT.setValue(\"\");\
app.ID.setValue(\"\");\
app.Win.show();\
if(app.selNode.data.ID == '-1'){\
  app.Len.setValue('5');\
}else{\
  app.Len.setValue('3');\
}\
app.isEdit = false;\
"}
          },
          {
           "configs": {
            "itemId": "editTree",
            "text": "修改",
            "iconCls": "db_edit_icon"
           },
           "expanded": false,
           "children": [],
           "type": "button",
           "events": {"click": "if (!app.selNode) {\
  Wb.warn('请选择 1 个部门。');\
  return;\
}\
if (app.selNode.isRoot()) {\
  Wb.warn('不能对根节点进行修改。');\
  return;\
}\
app.Win.setTitle('修改 - ' + app.selNode.data.text);\
app.Win.setIconCls('record_edit_icon');\
Wb.reset(app.Win);\
console.log(app.selNode.data);\
Wb.setValue(app.Win, app.selNode.data);\
app.ETM_CLASS.disable(true);\
app.Win.show();\
if(app.selNode.data.ID == '-1'){\
  app.Len.setValue('5');\
}else{\
  app.Len.setValue('3');\
}\
app.ETM_CLASS.store.load();\
app.isEdit = true;"}
          },
          {
           "configs": {
            "itemId": "delTree",
            "text": "删除",
            "iconCls": "db_delete_icon"
           },
           "expanded": false,
           "children": [],
           "type": "button",
           "events": {"click": " if (app.tree1.selModel.isSelected(app.tree1.getRootNode())) {\
  Wb.warn('不能删除根节点。');\
  return;\
}\
Wb.confirm('确定要删除选择的班组及其所属的所有子班组吗？', function() {\
  var deptIds = {};\
  Wb.each(app.tree1.getSelection(), function(node) {\
    node.cascadeBy(function(item) {\
      deptIds[item.data.ID] = {\
        ID: item.data.ID\
      };\
    });\
  });\
  Wb.request({\
    url: 'm?xwl=controlManage/work/cEmployeeTeam/deleteTree',\
    params: {\
      deptIds: Ext.Object.getValues(deptIds)\
    },\
    success: function(resp) {\
      Wb.remove(app.tree1);\
    }\
  });\
});\
"}
          },
          {
           "configs": {
            "itemId": "IDS",
            "hidden": "true"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          }
         ],
         "type": "toolbar"
        },
        {
         "configs": {
          "itemId": "popupMenu",
          "normalName": "workMenu"
         },
         "expanded": true,
         "children": [
          {
           "configs": {
            "itemId": "employeeBtn",
            "hidden": "false",
            "text": "增加人员",
            "iconCls": "object_icon"
           },
           "expanded": false,
           "children": [],
           "type": "item",
           "events": {"click": "var rowData = app.workMenu.selectRow.data;\
\
var win = new Ext.window.Window(app.winEmp); //app._win指向配置对象而非实例\
win.show();\
win.setIconCls('record_add_icon');\
Wb.setTitle(win, '添加人员 ');\
//加载数据\
app.gridWEmp.store.load({\
  params: {\
    worktype: app.selNode.raw.ID\
  }\
});"}
          },
          {
           "configs": {
            "itemId": "machineBtn",
            "hidden": "false",
            "text": "增加设备",
            "iconCls": "object_icon"
           },
           "expanded": false,
           "children": [],
           "type": "item",
           "events": {"click": "var rowData = app.workMenu.selectRow.data;\
var win = new Ext.window.Window(app._winMachine); //app._win指向配置对象而非实例\
win.show();\
win.setIconCls('record_add_icon');\
Wb.setTitle(win, '添加设备 ');\
//加载数据\
app.gridWMachine.store.load();"}
          },
          {
           "configs": {
            "itemId": "truckBtn",
            "hidden": "false",
            "text": "增加拖车",
            "iconCls": "object_icon"
           },
           "expanded": false,
           "children": [],
           "type": "item",
           "events": {"click": "var rowData = app.workMenu.selectRow.data;\
var win = new Ext.window.Window(app._winTruck); //app._win指向配置对象而非实例\
win.show();\
win.setIconCls('record_add_icon');\
Wb.setTitle(win, '添加拖车');\
//加载数据\
app.gridWTruck.store.load();"}
          }
         ],
         "type": "menu",
         "events": {"show": "var rows = app.tree1.getSelection();\
app.machineBtn.setDisabled(rows.length != 1);\
app.employeeBtn.setDisabled(rows.length != 1);\
app.truckBtn.setDisabled(rows.length != 1);\
\
menu.selectRow = rows[0];"}
        }
       ],
       "type": "tree",
       "events": {"selectionchange": "// app.selNodes = selected;\
// app.selNode = selected[0];\
\
// //人员信息\
// if(app.selNode.data.ETM_CLASS == '0'){\
//   app.gridEmp.show();\
//   app.gridTruck.hide();\
//   app.gridMachine.hide();\
//   app.gridEmp.store.load({\
//     params:{workGroup:app.selNode.data.ID}\
//   });\
// }\
\
// //拖车信息\
// if(app.selNode.data.ETM_CLASS == '1'){\
//   app.gridEmp.hide();\
//   app.gridTruck.show();\
//   app.gridMachine.hide();\
//   app.gridTruck.store.load({\
//     params:{workGroup:app.selNode.data.ID}\
//   });\
// }\
\
// //设备信息\
// if(app.selNode.data.ETM_CLASS == '3'){\
//   app.gridEmp.hide();\
//   app.gridTruck.hide();\
//   app.gridMachine.show();\
//   app.gridMachine.store.load({\
//     params:{workGroup:app.selNode.data.ID}\
//   });\
// }\
\
app.selNodes = selected;\
app.selNode = selected[0];\
if(app.selNode.data.ETM_CLASS=='3'){ \
\tapp.tab1.setActiveTab(2);\
}\
if(app.selNode.data.ETM_CLASS=='1'){\
\tapp.tab1.setActiveTab(1);\
}\
if(app.selNode.data.ETM_CLASS=='0'){\
\tapp.tab1.setActiveTab(0);\
}\
app.IDS.setValue(app.selNode.data.ID);\
app.gridEmp.store.load({\
\tparams:{workGroup:app.selNode.data.ID}\
});\
app.gridMachine.store.load({\
\tparams:{workGroup:app.selNode.data.ID}\
});\
app.gridTruck.store.load({\
\tparams:{workGroup:app.selNode.data.ID}\
});\
"}
      }],
      "type": "panel"
     },
     {
      "configs": {
       "layout": "fit",
       "itemId": "panel2",
       "split": "true",
       "region": "center"
      },
      "expanded": false,
      "children": [{
       "configs": {"itemId": "tab1"},
       "expanded": true,
       "children": [
        {
         "configs": {
          "itemId": "gridEmp",
          "selType": "checkboxmodel",
          "pagingBar": "false",
          "region": "center",
          "title": "人员"
         },
         "expanded": false,
         "children": [
          {
           "configs": {
            "itemId": "store",
            "pageSize": "-1",
            "url": "m?xwl=controlManage/work/cEmployeeTeam1/employee/selectEmployee"
           },
           "expanded": false,
           "children": [],
           "type": "store"
          },
          {
           "configs": {
            "itemId": "tbar",
            "region": "north"
           },
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "name",
              "labelAlign": "right",
              "fieldLabel": "人员名称",
              "labelWidth": "80"
             },
             "expanded": false,
             "children": [],
             "type": "text"
            },
            {
             "configs": {
              "itemId": "findEmpBtn",
              "text": "查询",
              "iconCls": "seek_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "app.gridEmp.store.load({\
  params:{empName:app.name.getValue(),workGroup:app.selNode.data.ID}\
});"}
            },
            {
             "configs": {
              "itemId": "addEmpBtn",
              "text": "新增",
              "iconCls": "record_add_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "if (!app.selNode) {\
  Wb.warn('请选择 1 个班组。');\
  return;\
}\
if (app.selNode.childNodes.length > 0) {\
  Wb.warn('请选择班组最小单元');\
  return;\
}\
console.log(app.selNode);\
var win = new Ext.window.Window(app.winEmp); //app._win指向配置对象而非实例\
win.show();\
win.setIconCls('record_add_icon');\
Wb.setTitle(win, '添加人员 ');\
//加载数据\
app.gridWEmp.store.load({\
  params: {\
    worktype: app.selNode.raw.ID\
  }\
});"}
            },
            {
             "configs": {
              "itemId": "delEmpBtn",
              "text": "删除",
              "iconCls": "record_delete_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "var rec = app.gridEmp.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择至少1条人员信息。');\
  return;\
}\
\
var rows = app.gridEmp.getSelection();\
var IDS = new Array(); \
Wb.each(rows,function(row){\
  IDS.push({ID:row.data.ID});\
});\
\
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam/employee/delEmployee',\
  params:{IDS:IDS},\
  success: function(resp) {\
    app.findEmpBtn.fireEvent('click');\
  }\
}); \
"}
            },
            {
             "configs": {
              "itemId": "attendanceEmpBtn",
              "text": "出勤",
              "iconCls": "object_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "var sel = app.gridEmp.getSelection();\
if (sel.length < 1) {\
  Wb.warn(\"请选择一条人员数据！\");\
  return;\
}\
// console.log(sel);\
var datas = [];\
for (var i = 0; i < sel.length; i++) {\
  //判断是否存在每日出勤里\
  datas.push({\
    RESOURCE_ID:sel[i].data.EMPNO,\
\tGROUPING:sel[i].data.WORK_GROUP,\
    RESOURCE_NAME:sel[i].data.EMPNAME,\
    W_TYPE: \"0\",\
    ID:sel[i].data.ID\
  });\
}\
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/att',\
  params: {\
  \tdatas:datas\
  },\
  success: function(resp) {\
  \tWb.info(\"成功\");\
  }\
});"}
            }
           ],
           "type": "toolbar"
          },
          {
           "configs": {"itemId": "columns"},
           "expanded": false,
           "children": [
            {
             "configs": {
              "itemId": "id",
              "hidden": "true",
              "dataIndex": "MENU_ID",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "row",
              "xtype": "rownumberer",
              "text": "序号",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "teamName",
              "dataIndex": "TEAM_NAME",
              "text": "班组名称",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "empName",
              "dataIndex": "EMPNAME",
              "text": "人员名称",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "workType",
              "dataIndex": "WORK_TYPE",
              "text": "工种",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "job",
              "dataIndex": "JOB",
              "text": "职称",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "pocketTel",
              "dataIndex": "POCKETTEL",
              "text": "联系电话",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "note",
              "dataIndex": "NOTE",
              "text": "住址",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            }
           ],
           "type": "array"
          }
         ],
         "type": "grid"
        },
        {
         "configs": {
          "itemId": "gridTruck",
          "selType": "checkboxmodel",
          "editable": "true",
          "region": "center",
          "title": "拖车"
         },
         "expanded": false,
         "children": [
          {
           "configs": {
            "itemId": "store",
            "url": "m?xwl=controlManage/work/cEmployeeTeam1/truck/selectTruck"
           },
           "expanded": false,
           "children": [],
           "type": "store"
          },
          {
           "configs": {
            "itemId": "tbar",
            "region": "north"
           },
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "truckName",
              "labelAlign": "right",
              "fieldLabel": "拖车名称",
              "labelWidth": "80"
             },
             "expanded": false,
             "children": [],
             "type": "text"
            },
            {
             "configs": {
              "itemId": "findTruckBtn",
              "text": "查询",
              "iconCls": "seek_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "app.gridTruck.store.load({\
  params:{truckName:app.truckName.getValue(),workGroup:app.selNode.data.ID}\
});"}
            },
            {
             "configs": {
              "itemId": "addTruckBtn",
              "text": "新增",
              "iconCls": "record_add_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "if (!app.selNode) {\
  Wb.warn('请选择 1 个班组。');\
  return;\
}\
\
if(app.selNode.childNodes.length > 0){\
  Wb.warn('请选择班组最小单元');\
  return;\
}\
\
var win = new Ext.window.Window(app._winTruck); //app._win指向配置对象而非实例\
win.show();\
win.setIconCls('record_add_icon');\
Wb.setTitle(win, '添加拖车');\
//加载数据\
app.gridWTruck.store.load();\
"}
            },
            {
             "configs": {
              "itemId": "delTruckBtn",
              "text": "删除",
              "iconCls": "record_delete_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "var rec = app.gridTruck.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择至少1条拖车信息。');\
  return;\
}\
\
var rows = app.gridTruck.getSelection();\
var IDS = new Array(); \
Wb.each(rows,function(row){\
  IDS.push({ID:row.data.ID});\
});\
\
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam/truck/delTruck',\
  params:{IDS:IDS},\
  success: function(resp) {\
    app.findTruckBtn.fireEvent('click'); \
  }\
}); \
"}
            },
            {
             "configs": {
              "itemId": "saveTruckBtn",
              "text": "保存",
              "iconCls": "save_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "if (!Wb.verifyGrid(app.gridTruck)) //验证数据是否合法\
  return;\
Wb.sync({\
  grid: app.gridTruck,\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/truck/saveTruck',\
  message: '正在保存中...',\
  success: function(resp) {\
    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\
    Wb.syncCreate(app.gridTruck, Wb.decode(resp.responseText));\
    app.findTruckBtn.fireEvent('click');\
  }\
});"}
            },
            {
             "configs": {
              "itemId": "attendanceTruckBtn",
              "text": "出勤",
              "iconCls": "object_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "var sel = app.gridTruck.getSelection();\
if (sel.length < 1) {\
  Wb.warn(\"请选择一条拖车数据！\");\
  return;\
}\
var datas = [];\
for (var i = 0; i < sel.length; i++) {\
  if (sel[i].data.PHASE != 'WH') {\
    datas.push({\
      RESOURCE_ID: sel[i].data.ID,\
      GROUPING: sel[i].data.CLASS_ID,\
      RESOURCE_NAME: sel[i].data.MACH_NAME,\
      W_TYPE: \"1\",\
      ID: sel[i].data.ID\
    });\
  }\
}\
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/att',\
  params: {\
    datas: datas\
  },\
  success: function(resp) {\
    Wb.info(\"成功\");\
  }\
});"}
            }
           ],
           "type": "toolbar"
          },
          {
           "configs": {"itemId": "columns"},
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "id",
              "hidden": "true",
              "dataIndex": "MENU_ID",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "row",
              "xtype": "rownumberer",
              "text": "序号",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "teamName",
              "dataIndex": "TEAM_NAME",
              "text": "班组名称",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "teamName1",
              "dataIndex": "ID",
              "width": "50",
              "text": "车号",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "platNo",
              "dataIndex": "MACH_NAME",
              "text": "车牌号",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "trayNo",
              "dataIndex": "TRAY_NO",
              "keyName": "C_TRAY",
              "text": "托盘号",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [{
              "configs": {
               "itemId": "editor",
               "keyName": "C_TRAY",
               "displayField": "V",
               "valueField": "K"
              },
              "expanded": true,
              "children": [],
              "type": "combo"
             }],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "truckerNo",
              "dataIndex": "MACH_NAM",
              "keyName": "C_EMPLOYEE",
              "text": "司机",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [{
              "configs": {
               "itemId": "editor",
               "displayField": "EMPNAME",
               "valueField": "EMPNAME"
              },
              "expanded": true,
              "children": [{
               "configs": {
                "itemId": "store",
                "url": "m?xwl=controlManage/work/cEmployeeTeam1/truck/selectEmployeeCod"
               },
               "expanded": false,
               "children": [],
               "type": "store",
               "events": {"beforeload": "operation.params={WORK_GROUP:app.IDS.getValue()};"}
              }],
              "type": "combo",
              "events": {"select": "var rec = app.gridTruck.getSelection()[0];\
// console.log(combo.rawValue);\
rec.set('MACH_OPER',records[0].data.EMPNO);\
"}
             }],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "truckerNam",
              "hidden": "true",
              "dataIndex": "MACH_OPER",
              "text": "司机名称"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "phase",
              "renderer": "if(value =='IDL'){\
  return '空闲';\
}\
if(value == 'FUL'){\
  return '满载';\
}\
if(value == 'WH'){\
  return '维护';\
}\
if(value == 'ZC'){\
  return '正常';\
}",
              "dataIndex": "PHASE",
              "text": "状态",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [{
              "configs": {
               "itemId": "editor",
               "pickList": "[\
  ['ZC', '正常'],\
  ['WH', '维护']\
]"
              },
              "expanded": false,
              "children": [],
              "type": "combo"
             }],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "START_DATE12",
              "dataIndex": "START_DATE",
              "width": "120",
              "text": "维护开始时间"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "END_DATE1256",
              "dataIndex": "END_DATE",
              "width": "120",
              "text": "维护结束时间"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "NOTE123",
              "dataIndex": "NOTES",
              "text": "维护原因"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            }
           ],
           "type": "array"
          },
          {
           "configs": {
            "itemId": "popupMenu",
            "normalName": "menu1"
           },
           "expanded": true,
           "children": [{
            "configs": {
             "itemId": "mainBtn",
             "text": "维护",
             "iconCls": "ok_icon"
            },
            "expanded": false,
            "children": [],
            "type": "item",
            "events": {"click": "var sels = app.gridTruck.getSelection();\
if (sels.length <= 0) {\
  Wb.warn(\"请选择车!\");\
  return;\
}\
\
var win = new Ext.window.Window(app._editwin);\
win.show();\
app.PID.setValue(sels[0].data.ID);\
app.MACH_ID.setValue(sels[0].data.ID);\
app.MACH_NAME.setValue(sels[0].data.MACH_NAME);\
\
// win.mon(win, 'ok', function() {\
//   Wb.request({\
//     url: 'm?xwl=controlManage/work/cEmployeeTeam1/mainTruck',\
//     out: win,\
//     params: {\
//       ID: sels[0].data.ID\
//     },\
//     success: function(resp) {\
//       win.close();\
//       app.findTruckBtn.fireEvent('click');\
//     }\
//   });\
// });\
\
win.mon(win, 'ok', function() {\
  Wb.request({\
    url: 'm?xwl=controlManage/work/cEmployeeTeam1/machMaintain',\
    out: win,\
    params: {\
      ID: sels[0].data.ID\
    },\
    success: function(resp) {\
      win.close();\
      app.findTruckBtn.fireEvent('click');\
    }\
  });\
});"}
           }],
           "type": "menu",
           "events": {"show": "var rows = app.gridTruck.getSelection();\
app.mainBtn.setDisabled(rows.length!=1);\
menu.selectRow = rows[0];\
\
\
"}
          },
          {
           "configs": {
            "itemId": "viewConfig",
            "getRowClass": "//Wb预定义行背景色种类：wb_red_row, wb_green_row, wb_blue_row, wb_yellow_row, wb_hotpink_row, wb_gold_row, wb_bisque_row, wb_aqua_row\
//样式在style.css中预定义，如果需要动态加载css文件请参考m?xwl=system/examples/basic/link/dynamic-link示例\
var cls, phase = record.get('PHASE');\
if (phase == 'WH')\
  cls = 'wb_gold_row';\
else if (phase == 'IDL1')\
  cls = 'wb_aqua_row';\
else cls = '';\
return cls;"
           },
           "expanded": false,
           "children": [],
           "type": "tableview"
          }
         ],
         "type": "grid",
         "events": {"tagEvents": "beforeSelect: function(RowModel, record, index, eOpts) {\
   if (record.data.PHASE == 'WH')\
     return false;\
   else\
     return true;\
 }"}
        },
        {
         "configs": {
          "itemId": "gridMachine",
          "selType": "checkboxmodel",
          "editable": "true",
          "region": "center",
          "title": "设备"
         },
         "expanded": false,
         "children": [
          {
           "configs": {
            "itemId": "store",
            "url": "m?xwl=controlManage/work/cEmployeeTeam1/machine/selectMachine"
           },
           "expanded": false,
           "children": [],
           "type": "store"
          },
          {
           "configs": {
            "itemId": "tbar",
            "region": "north"
           },
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "machineName",
              "labelAlign": "right",
              "fieldLabel": "设备名称",
              "labelWidth": "80"
             },
             "expanded": false,
             "children": [],
             "type": "text"
            },
            {
             "configs": {
              "itemId": "findMachineBtn",
              "text": "查询",
              "iconCls": "seek_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "app.gridMachine.store.load({\
  params:{machineName:app.machineName.getValue(),workGroup:app.selNode.data.ID}\
});\
"}
            },
            {
             "configs": {
              "itemId": "addMachineBtn",
              "text": "新增",
              "iconCls": "record_add_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "if (!app.selNode) {\
  Wb.warn('请选择 1 个班组。');\
  return;\
}\
\
if(app.selNode.childNodes.length > 0){\
  Wb.warn('请选择班组最小单元');\
  return;\
}\
\
var win = new Ext.window.Window(app._winMachine); //app._win指向配置对象而非实例\
win.show();\
win.setIconCls('record_add_icon');\
Wb.setTitle(win, '添加设备 ');\
//加载数据\
app.gridWMachine.store.load();\
"}
            },
            {
             "configs": {
              "itemId": "delMachineBtn",
              "text": "删除",
              "iconCls": "record_delete_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "var rec = app.gridMachine.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择至少1条设备信息。');\
  return;\
}\
\
var rows = app.gridMachine.getSelection();\
var IDS = new Array(); \
Wb.each(rows,function(row){\
  IDS.push({ID:row.data.ID});\
});\
\
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam/machine/delMachine',\
  params:{IDS:IDS},\
  success: function(resp) {\
    app.findMachineBtn.fireEvent('click');\
  }\
}); \
"}
            },
            {
             "configs": {
              "itemId": "saveMachineBtn",
              "text": "保存",
              "iconCls": "save_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "if (!Wb.verifyGrid(app.gridMachine)) //验证数据是否合法\
  return;\
Wb.sync({\
  grid: app.gridMachine,\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/machine/saveMachine',\
  message: '正在保存中...',\
  success: function(resp) {\
    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\
    Wb.syncCreate(app.gridMachine, Wb.decode(resp.responseText));\
    app.findMachineBtn.fireEvent('click');\
  }\
});\
\
"}
            },
            {
             "configs": {
              "itemId": "attendanceMachineBtn",
              "text": "出勤",
              "iconCls": "object_icon"
             },
             "expanded": false,
             "children": [],
             "type": "button",
             "events": {"click": "var sel = app.gridMachine.getSelection();\
if (sel.length < 1) {\
  Wb.warn(\"请选择一条设备数据！\");\
  return;\
}\
var datas = [];\
for (var i = 0; i < sel.length; i++) {\
  if (sel[i].data.PHASE != 'WH') {\
    datas.push({\
      RESOURCE_ID: sel[i].data.ID,\
      GROUPING: sel[i].data.CLASS_ID,\
      RESOURCE_NAME: sel[i].data.MACH_NAME,\
      W_TYPE: \"3\",\
      ID: sel[i].data.ID\
    });\
  }\
}\
Wb.request({\
  url: 'm?xwl=controlManage/work/cEmployeeTeam1/att',\
  params: {\
    datas: datas\
  },\
  success: function(resp) {\
    Wb.info(\"成功\");\
  }\
});"}
            }
           ],
           "type": "toolbar"
          },
          {
           "configs": {"itemId": "columns"},
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "id",
              "hidden": "true",
              "dataIndex": "MENU_ID",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "row",
              "xtype": "rownumberer",
              "text": "序号",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "teamName",
              "dataIndex": "TEAM_NAME",
              "text": "班组名称",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "machName",
              "dataIndex": "MACH_NAME",
              "text": "设备名称",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [{
              "configs": {"itemId": "editor"},
              "expanded": false,
              "children": [],
              "type": "text"
             }],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "machType",
              "dataIndex": "MACH_TYPE",
              "keyName": "C_MACHINE_TYPE",
              "text": "设备类型",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [{
              "configs": {
               "itemId": "editor",
               "keyName": "C_MACHINE_TYPE",
               "displayField": "V",
               "valueField": "K"
              },
              "expanded": false,
              "children": [],
              "type": "combo"
             }],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "machOper",
              "dataIndex": "MACH_OPER",
              "keyName": "C_EMPLOYEE",
              "text": "司机",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [{
              "configs": {
               "itemId": "editor",
               "displayField": "EMPNAME",
               "valueField": "EMPNO"
              },
              "expanded": true,
              "children": [{
               "configs": {
                "itemId": "store",
                "url": "m?xwl=controlManage/work/cEmployeeTeam1/machine/selectEmployeeCod"
               },
               "expanded": false,
               "children": [],
               "type": "store",
               "events": {"beforeload": "operation.params={WORK_GROUP:app.IDS.getValue()};"}
              }],
              "type": "combo",
              "events": {"select": "var rec = app.gridMachine.getSelection()[0];\
rec.set('MACH_NAM',combo.rawValue);\
\
\
"}
             }],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "machNam",
              "hidden": "true",
              "dataIndex": "MACH_NAM",
              "text": "操作人名称",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "PHASE98",
              "renderer": "if (value == 'ZC') {\
  return '正常';\
}\
\
if (value == 'WH') {\
  return '维护';\
}",
              "dataIndex": "PHASE",
              "text": "状态",
              "align": "center",
              "titleAlign": "center"
             },
             "expanded": true,
             "children": [{
              "configs": {
               "itemId": "editor",
               "pickList": "[\
  ['ZC','正常'],\
  ['WH','维护']\
]"
              },
              "expanded": false,
              "children": [],
              "type": "combo"
             }],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "START_DATE12132",
              "dataIndex": "START_DATE",
              "width": "120",
              "text": "维护开始时间"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "END_DATE1256123",
              "dataIndex": "END_DATE",
              "width": "120",
              "text": "维护结束时间"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            },
            {
             "configs": {
              "itemId": "NOTE123232",
              "dataIndex": "NOTE",
              "text": "原因"
             },
             "expanded": false,
             "children": [],
             "type": "column"
            }
           ],
           "type": "array"
          },
          {
           "configs": {
            "itemId": "popupMenu",
            "normalName": "menu2"
           },
           "expanded": true,
           "children": [{
            "configs": {
             "itemId": "mainMachBtn",
             "text": "维护",
             "iconCls": "ok_icon"
            },
            "expanded": false,
            "children": [],
            "type": "item",
            "events": {"click": "var sels = app.gridMachine.getSelection();\
if (sels.length <= 0) {\
  Wb.warn(\"请选择设备!\");\
  return;\
}\
\
var win = new Ext.window.Window(app._editwin);\
win.show();\
app.PID.setValue(sels[0].data.ID);\
app.MACH_ID.setValue(sels[0].data.ID);\
app.MACH_NAME.setValue(sels[0].data.MACH_NAME);\
\
win.mon(win, 'ok', function() {\
  Wb.request({\
    url: 'm?xwl=controlManage/work/cEmployeeTeam1/machMaintain',\
    out: win,\
    params: {\
      ID: sels[0].data.ID\
    },\
    success: function(resp) {\
      win.close();\
      app.findMachineBtn.fireEvent('click');\
    }\
  });\
});"}
           }],
           "type": "menu",
           "events": {"show": "var rows = app.gridMachine.getSelection();\
app.mainMachBtn.setDisabled(rows.length!=1);\
menu.selectRow = rows[0];\
\
\
"}
          },
          {
           "configs": {
            "itemId": "viewConfig",
            "getRowClass": "//Wb预定义行背景色种类：wb_red_row, wb_green_row, wb_blue_row, wb_yellow_row, wb_hotpink_row, wb_gold_row, wb_bisque_row, wb_aqua_row\
//样式在style.css中预定义，如果需要动态加载css文件请参考m?xwl=system/examples/basic/link/dynamic-link示例\
var cls, phase = record.get('PHASE');\
if (phase == 'WH')\
  cls = 'wb_gold_row';\
else if (phase == 'ZC1')\
  cls = 'wb_aqua_row';\
else cls = '';\
return cls;"
           },
           "expanded": false,
           "children": [],
           "type": "tableview"
          }
         ],
         "type": "grid",
         "events": {"tagEvents": " beforeSelect: function(RowModel, record, index, eOpts) {\
   if (record.data.PHASE == 'WH')\
     return false;\
   else\
     return true;\
 }"}
        }
       ],
       "type": "tab",
       "events": {"tabchange": "// console.log(newCard);//可以根据卡片的标题加载不同的grid"}
      }],
      "type": "panel"
     }
    ],
    "type": "viewport",
    "events": {"afterrender": "// app.navKey = new Ext.KeyNav({\
//   viewport: app.viewport1,\
//   J: {\
//     ctrl: true,\
//     fn: function() {\
//      // app.newBtn.fireEvent('click');\
//     }\
//   }\
// });"}
   }
  ],
  "type": "module",
  "events": {"initialize": "// Wb.apply(app, {\
//   treeViewConfig: {\
//     plugins: {\
//       ptype: 'treeviewdragdrop'\
//     },\
//     listeners: {\
//       beforedrop: function(node, data, om, dp, dh) {\
//         var i, index, parentNode, parentMenu, selDepts, deptCount = data.records.length;\
//         if (dp == 'append') {\
//           parentNode = om;\
//           index = om.lastChild ? om.lastChild.data.ORDER_INDEX + 1 : 1;\
//         } else {\
//           parentNode = om.parentNode;\
//           index = dp == 'before' ? om.data.ORDER_INDEX : om.data.ORDER_INDEX + 1;\
//         }\
//         dh.wait = true;\
//         parentMenu = parentNode.data.ID;\
//         selDepts = Wb.getData(data.records);\
//         i = 0;\
//         Wb.each(selDepts, function(item) {\
//           item.ORDER_INDEX = index + (i++);\
//         });\
//         Wb.request({\
//           url: 'm?xwl=controlManage/work/cEmployeeTeam/move',\
//           params: {\
//             index: index,\
//             deptCount: deptCount,\
//             parentMenu: parentMenu,\
//             selDepts: selDepts\
//           },\
//           callback: function(a, succ) {\
//             if (succ) {\
//               dh.processDrop();\
//               parentNode.eachChild(function(node) {\
//                 i = node.data.ORDER_INDEX;\
//                 if (i >= index)\
//                   node.set('ORDER_INDEX', i + deptCount);\
//               });\
//               i = 0;\
//               Wb.each(data.records, function(node) {\
//                 node.set('PID', parentMenu);\
//                 node.set('ORDER_INDEX', index + (i++));\
//               });\
//               app.tree1.setSelection(data.records);\
//             } else {\
//               dh.cancelDrop();\
//             }\
//           }\
//         });\
//       }\
//     }\
//   }\
// });"}
 }],
 "roles": {
  "SCANJB": 1,
  "xlzk": 1
 },
 "title": "班组管理",
 "iconCls": "",
 "inframe": true,
 "pageLink": ""
}