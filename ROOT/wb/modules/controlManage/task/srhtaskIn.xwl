{
 "hidden": false,
 "children": [{
  "configs": {"itemId": "module"},
  "expanded": true,
  "children": [
   {
    "configs": {
     "layout": "border",
     "itemId": "exptWin",
     "closeAction": "hide",
     "width": "600",
     "title": "异常箱登记",
     "height": "300"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "toolbar1",
       "region": "north",
       "height": "30"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "addadd",
         "tooltip": "增加",
         "text": "增加",
         "iconCls": "record_add_icon"
        },
        "expanded": false,
        "children": [],
        "type": "button",
        "events": {"click": "Wb.addEdit(app.cntrGrid, {\
  VID: app.treeTask.getSelection()[0].raw.ship,\
  EXCEPTION_TYPE: 'SHORT'\
});"}
       },
       {
        "configs": {
         "itemId": "deleteadd",
         "text": "删除",
         "iconCls": "record_delete_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "Wb.remove(app.cntrGrid);"}
       },
       {
        "configs": {
         "itemId": "saveadd",
         "text": "保存",
         "iconCls": "save_icon"
        },
        "expanded": false,
        "children": [],
        "type": "button",
        "events": {"click": "if (!Wb.verifyGrid(app.cntrGrid)) //验证数据是否合法\
  return;\
Wb.sync({\
  grid: app.cntrGrid,\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/saveExceptionCntr',\
  message: '正在保存中...',\
  success: function(resp) {\
    app.cntrGrid.store.commitChanges();\
    Wb.info('保存成功!');\
  }\
});"}
       }
      ],
      "type": "toolbar"
     },
     {
      "configs": {
       "itemId": "cntrGrid",
       "editable": "true",
       "region": "center"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "store",
         "url": "m?xwl=controlManage/task/worktaskcraneedit/selectExceptionCntr"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "VID",
           "dataIndex": "VID",
           "width": "0"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "EXCEPTION_TYPE",
           "dataIndex": "EXCEPTION_TYPE",
           "width": "0"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR",
           "dataIndex": "CNTR",
           "width": "110",
           "text": "箱号"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "isUpperCase": "true"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_ISO",
           "dataIndex": "CNTR_ISO",
           "width": "40",
           "text": "ISO"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "isUpperCase": "true"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_TYPE",
           "hidden": "false",
           "dataIndex": "CNTR_TYPE",
           "text": "箱型"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "keyName": "CNTR_TYPE"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_SIZE",
           "hidden": "false",
           "dataIndex": "CNTR_SIZE",
           "text": "尺寸"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "keyName": "CNTR_SIZE"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "E_F_ID",
           "hidden": "false",
           "dataIndex": "E_F_ID",
           "text": "空重"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "keyName": "E_F_ID"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "NOTES",
           "dataIndex": "NOTES",
           "width": "200",
           "text": "备注"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "height": "100"
           },
           "expanded": false,
           "children": [],
           "type": "textarea"
          }],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid"
     }
    ],
    "type": "window",
    "events": {"show": "app.cntrGrid.store.reload({\
  params: {\
    vid: app.treeTask.getSelection()[0].raw.ship\
  }\
});"}
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "exptViewWin",
     "closeAction": "hide",
     "width": "300",
     "title": "异常箱查看",
     "height": "500"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "toolbar1",
       "region": "north",
       "height": "30"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "delete",
         "text": "删除",
         "iconCls": "record_delete_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "Wb.confirm(\"删除后图片将无法找回，是否要删除当前异常信息？\", function() {\
  Wb.request({\
    url: \"m?xwl=controlManage/task/worktaskcraneedit/deleteExceptImage\",\
    params: {\
      id: app.taskId\
    },\
    success: function() {\
      app.exptViewWin.close();\
    }\
  });\
});"}
       },
       {
        "configs": {
         "itemId": "prev",
         "disabled": "true",
         "text": "上一张",
         "iconCls": "left_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "app.next.enable();\
app.img.setSrc(app.urls[--app.index]);\
if (app.index === 0)\
  app.prev.disable();"}
       },
       {
        "configs": {
         "itemId": "next",
         "disabled": "true",
         "text": "下一张",
         "iconCls": "right_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "app.prev.enable();\
app.img.setSrc(app.urls[++app.index]);\
if (app.index === app.urls.length - 1)\
  app.next.disable();"}
       }
      ],
      "type": "toolbar"
     },
     {
      "configs": {
       "layout": "absolute",
       "itemId": "panel1",
       "width": "296",
       "height": "480"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "CNTR",
         "fieldLabel": "箱号",
         "x": "8",
         "width": "180",
         "y": "0",
         "readOnly": "true",
         "labelWidth": "40",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "CNTR_SIZE",
         "fieldLabel": "尺寸",
         "x": "200",
         "width": "80",
         "y": "0",
         "readOnly": "true",
         "labelWidth": "40",
         "height": "22"
        },
        "expanded": true,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "img",
         "x": "0",
         "width": "296",
         "y": "48",
         "height": "400"
        },
        "expanded": false,
        "children": [],
        "type": "image"
       },
       {
        "configs": {
         "itemId": "URL",
         "x": "136",
         "width": "36",
         "y": "72",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "hidden"
       },
       {
        "configs": {
         "itemId": "SHIP",
         "fieldLabel": "船舶",
         "x": "8",
         "width": "273",
         "y": "24",
         "readOnly": "true",
         "labelWidth": "40",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       }
      ],
      "type": "panel"
     }
    ],
    "type": "window",
    "events": {"show": "app.prev.disable();\
app.next.disable();\
var url = app.URL.getValue();\
if (url) {\
  app.urls = url.split(',');\
  app.index = 0;\
  if (app.urls.length > 0) {\
    app.img.setSrc(app.urls[0]);\
    if (app.urls.length > 1)\
      app.next.enable();\
  }\
}"}
   },
   {
    "configs": {
     "itemId": "card",
     "file": "m?xwl=controlManage/task/writeCardWin"
    },
    "expanded": false,
    "children": [],
    "type": "xwl"
   },
   {
    "configs": {
     "layout": "fit",
     "itemId": "viewport1"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "layout": "border",
       "itemId": "panel2"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "layout": "border",
         "itemId": "panelLeft",
         "split": "true",
         "width": "260",
         "region": "west"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "treeTask",
          "root": "{\
  text: '作业任务'\
}",
          "viewConfig": "{\
\t 'itemcontextmenu':function(view,record,item,index,e,eOpts){  \
\t                     //禁用浏览器的右键相应事件  \
\t                    e.preventDefault();  \
                         e.stopEvent();  \
     }\
}",
          "region": "center",
          "tools": "Wb.getTreeTools()"
         },
         "expanded": true,
         "children": [
          {
           "configs": {"itemId": "tbar"},
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "date",
              "width": "100"
             },
             "expanded": false,
             "children": [],
             "type": "date",
             "events": {
              "afterrender": "date.setValue(new Date());",
              "change": "app.treeTask.store.reload();"
             }
            },
            {
             "configs": {
              "itemId": "trade",
              "width": "60",
              "keyName": "TRADE_ID",
              "value": "12",
              "forceSelection": "true"
             },
             "expanded": false,
             "children": [],
             "type": "combo",
             "events": {"change": "app.treeTask.store.reload();"}
            },
            {
             "configs": {
              "itemId": "button1",
              "hidden": "true",
              "toggleHandler": "app.showFinTask = state;\
if (app.taskType == 'GIN' || app.taskType == 'GOUT' || app.taskType == 'MOVE')\
  app.moveGrid.store.load({\
    params: {\
      QUEUE_ID: app.taskId,\
      task_type: app.taskType,\
      showFin: app.showFinTask\
    }\
  });",
              "text": "显示完成",
              "iconCls": "check_icon",
              "enableToggle": "true"
             },
             "expanded": true,
             "children": [],
             "type": "button"
            }
           ],
           "type": "toolbar"
          },
          {
           "configs": {
            "itemId": "store",
            "url": "m?xwl=controlManage/task/worktaskcraneedit/loadTask1"
           },
           "expanded": false,
           "children": [],
           "type": "treestore",
           "events": {"beforeload": "Wb.apply(operation.params, Wb.getValue(app.treeTask.down('toolbar')));"}
          }
         ],
         "type": "tree",
         "events": {
          "selectionchange": "var record = selected[0];\
if (!record)\
  return;\
app.taskId = record.data.id;\
if (!record.raw.leaf)\
  return;\
if (!app.taskId)\
  return;\
if (app.lastSubKey)\
  app.xwl1.unsubscribe(app.lastSubKey);\
app.taskType = record.parentNode.data.id;\
switch (app.taskType) {\
  case 'GOUT':\
  case 'GIN':\
    app.lastSubKey = '/exchange/ex_instruction/gate.#';\
    break;\
  case 'VIN':\
  case 'VOUT':\
    app.lastSubKey = '/exchange/ex_instruction/ship.' + record.raw.ship;\
    break;\
  case 'MOVE':\
    app.lastSubKey = '/exchange/ex_instruction/cy.#';\
    break;\
}\
app.xwl1.subscribe(app.lastSubKey, function(d) {\
  var msg = d.body;\
  //console.log(msg);\
  var record = app.moveGrid.store.data.findBy(function(r, k) {\
    return r.data.ID === msg.data.id;\
  });\
  switch (msg.info.action) {\
    case 'create':\
    case 'update':\
    case 'confirm':\
      Wb.request({\
        url: \"m?xwl=controlManage/task/worktaskcraneedit/moveListMsg\",\
        params: Wb.apply(msg.data, {\
          taskType: app.taskType,\
          taskId: app.taskId\
        }),\
        success: function(res) {\
          data = Wb.decode(res.responseText);\
          if (!record) {\
            Wb.add(app.moveGrid, data.rows);\
            newMoveCount = app.moveGrid.store.getCount();\
            setHeight();\
          } else\
            Wb.update(record, data.rows[0]);\
        }\
      });\
      break;\
    case 'delete':\
      if (record) {\
        Wb.remove(app.moveGrid, [record]);\
      }\
      break;\
    case 'batch':\
      if (app.taskId === msg.data.id)\
        app.moveGrid.store.reload();\
      break;\
    default:\
      console.log(msg);\
      break;\
  }\
  app.chart1.store.reload();\
});\
\
var oldMoveCount = app.moveGrid.store.getCount();\
var oldMovebCount = app.moveGridb.store.getCount();\
var newMoveCount = -1;\
var newMovebCount = -1;\
\
function setHeight() {\
  if (newMoveCount < 0 || newMovebCount < 0)\
    return;\
  var b = app.moveListPanel.getBox();\
  if (newMoveCount) {\
    app.moveListPanel.expand(false);\
  } else\
    app.moveListPanel.collapse(false);\
\
  if (newMovebCount) {\
    if (newMoveCount)\
      app.moveListbPanel.setHeight((window.innerHeight - b.top) / 2);\
    else\
      app.moveListbPanel.setHeight(window.innerHeight - b.top - 24);\
    app.moveListbPanel.expand(false);\
  } else\
    app.moveListbPanel.collapse(false);\
\
}\
app.moveGrid.store.load({\
  params: {\
    QUEUE_ID: app.taskId,\
    task_type: app.taskType,\
    showFin: app.showFinTask\
  },\
  callback: function() {\
    newMoveCount = app.moveGrid.store.getCount();\
    setHeight();\
  }\
});\
app.moveGridb.store.load({\
  params: {\
    QUEUE_ID: app.taskId\
  },\
  callback: function() {\
    newMovebCount = app.moveGridb.store.getCount();\
    setHeight();\
  }\
});\
app.chart1.store.load({\
  params: {\
    QUEUE_ID: app.taskId\
  }\
});",
          "load": "if (app.taskId) {\
  var rec = app.treeTask.getRootNode().findChildBy(function(n) {\
    return n.data.id === app.taskId;\
  }, null, 2);\
  if (rec) {\
    rec.parentNode.expand();\
    app.treeTask.selModel.select(rec);\
  }\
}",
          "afterrender": "app.xwl1.subscribe(\"/exchange/ex_task/#\", function(d) {\
  var msg = d.body;\
  var root = tree.store.getRootNode();\
  var node = root.findChild('id', msg.data.id, 2);\
  switch (msg.info.action) {\
    case 'create':\
    case 'update':\
      Wb.request({\
        url: \"m?xwl=controlManage/task/worktaskcraneedit/taskMsg\",\
        params: Wb.apply(msg.data, Wb.getValue(app.treeTask.down('toolbar'))),\
        success: function(res) {\
          var data = Wb.decode(res.responseText);\
          if (data.rows.length > 0) {\
            var row = data.rows[0];\
            if (!node) {\
              var p = root.findChild('id', row.type);\
              p.appendChild(p.createNode(row));\
            } else\
              node.updateInfo(true,row);\
          }\
        }\
      });\
      break;\
    case 'delete':\
      if (node)\
        node.remove();\
      break;\
  }\
  //app.treeTask.store.reload();\
});"
         }
        }],
        "type": "panel"
       },
       {
        "configs": {
         "layout": "border",
         "itemId": "panelRight",
         "region": "center"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "layout": "border",
           "itemId": "panel1",
           "split": "true",
           "region": "north",
           "height": "200"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "layout": "fit",
            "itemId": "panel1",
            "split": "true",
            "region": "center",
            "height": "320"
           },
           "expanded": true,
           "children": [{
            "configs": {"itemId": "chart1"},
            "expanded": true,
            "children": [
             {
              "configs": {
               "itemId": "store",
               "url": "m?xwl=controlManage/task/worktaskcraneedit/loadTaskChart"
              },
              "expanded": false,
              "children": [],
              "type": "store"
             },
             {
              "configs": {"itemId": "axes"},
              "expanded": true,
              "children": [
               {
                "configs": {
                 "itemId": "leftAxis",
                 "position": "left",
                 "type": "numeric"
                },
                "expanded": true,
                "children": [],
                "type": "axis"
               },
               {
                "configs": {
                 "itemId": "bottomAxis",
                 "position": "bottom",
                 "label": "{\
  renderer: function(value) {\
    if (app.taskType == 'VIN' || app.taskType == 'VOUT') {\
      var r = app.chart1.store.findRecord('CAT', value);\
      if (r && (r.data.NUM || r.data.VNUM))\
        value += '\\r\\
' + (r.data.NUM || 0) + '&' + (r.data.VNUM || 0);\
    }\
    return value;\
  }\
}",
                 "type": "category",
                 "fields": "CAT"
                },
                "expanded": true,
                "children": [],
                "type": "axis"
               }
              ],
              "type": "array"
             },
             {
              "configs": {"itemId": "series"},
              "expanded": true,
              "children": [{
               "configs": {
                "itemId": "plan",
                "renderer": "var yField = this.items[index].yField;\
var color = app.TASK_STATE && app.TASK_STATE[yField] || '#bbbbbb';\
return Wb.apply(attributes, {\
  fill: color\
});",
                "xField": "name",
                "stacked": "true",
                "yField": "['PLN','SND','TMP','EXE','FIN']",
                "axis": "left",
                "type": "column",
                "tips": "{\
  trackMouse: true,\
  renderer: function(record, item) {\
    var tip = \"尺码类型:\" + record.data.CAT;\
    for (var k in record.data) {\
      var name = '';\
      switch (k) {\
        case 'PLN':\
          name = '计划状态:';\
          break;\
        case 'SND':\
          name = '发送状态:';\
          break;\
        case 'TMP':\
          name = '暂存状态:';\
          break;\
        case 'EXE':\
          name = '执行状态:';\
          break;\
        case 'FIN':\
          name = '完成状态:';\
          break;\
        case 'NUM':\
          name = '任务总量:';\
          break;\
        case 'VNUM':\
          name = '舱单数量:';\
          break;\
      }\
      if (name && record.data[k] || k == 'VNUM')\
        tip += \"<br><br>\" + name + record.data[k];\
    }\
    this.update(tip);\
  }\
}"
               },
               "expanded": true,
               "children": [{
                "configs": {
                 "itemId": "label",
                 "padding": "20",
                 "createInstance": "false",
                 "field": "['PLN','SND','TMP','EXE','FIN','CNL']",
                 "color": "black",
                 "display": "insideEnd"
                },
                "expanded": false,
                "children": [],
                "type": "chartlabel"
               }],
               "type": "series",
               "events": {"itemdblclick": "var phase = item.yField;\
var cat = item.storeItem.data.CAT;\
var records = app.moveGrid.store.queryBy(function(r) {\
  return r.data.PHASE === phase && cat === (r.data.CNTR_SIZE + (r.data.E_F_ID == 'E' ? '尺吉' : '尺重'));\
});\
app.moveGrid.selModel.select(records.items);"}
              }],
              "type": "array"
             }
            ],
            "type": "chart",
            "events": {"refresh": "if (app.taskType == 'VOUT' || app.taskType == 'VIN')\
  chart.store.each(function(r) {\
    if (r.data.NUM != r.data.VNUM) {\
      t = app.chart1.el.down('text[text^=' + r.data.CAT + ']');\
      if (t)\
        t.dom.setAttribute('fill', 'red');\
    }\
  });"}
           }],
           "type": "panel"
          }],
          "type": "panel"
         },
         {
          "configs": {
           "layout": "fit",
           "itemId": "moveListPanel",
           "collapsed": "true",
           "region": "center",
           "collapsible": "true"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "moveGrid",
            "multiColumnSort": "true",
            "tbar": "app.tbarMove",
            "disabled": "false",
            "viewConfig": "{\
\t 'itemcontextmenu':function(view,record,item,index,e,eOpts){  \
\t                     //禁用浏览器的右键相应事件  \
\t                    e.preventDefault();  \
                         e.stopEvent();  \
     }\
}",
            "multiSelect": "true"
           },
           "expanded": true,
           "children": [
            {
             "configs": {
              "sortOnLoad": "true",
              "itemId": "store",
              "pageSize": "1000",
              "url": "m?xwl=controlManage/task/worktaskcraneedit/moveListSelect2"
             },
             "expanded": false,
             "children": [],
             "type": "store"
            },
            {
             "configs": {"itemId": "columns"},
             "expanded": false,
             "children": [
              {
               "configs": {
                "itemId": "column1",
                "renderer": "if (app.taskType == 'VOUT' || app.taskType == 'VIN') {\
  if (record.data.IV == 0)\
    metaData.style = 'background-color:red;';\
  else if (record.data.CNUM > 1)\
    metaData.style = 'background-color:yellow;';\
}\
return rowIndex + 1;",
                "xtype": "rownumberer"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "PHASE",
                "renderer": "var map = {\
  PLN: '计划',\
  SND: '发送',\
  CNL: '撤销',\
  EXE: '执行',\
  TMP: '暂存',\
  FIN: '完成'\
};\
var color = app.TASK_STATE && app.TASK_STATE[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return map[value] || value;",
                "dataIndex": "PHASE",
                "width": "40",
                "text": "状态",
                "align": "center"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR99",
                "renderer": "if (record.data.PRIORITY == 2)\
  metaData.style = 'background-color:red;';\
return value;",
                "dataIndex": "CNTR",
                "width": "90",
                "text": "箱号"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "C_CNTR_SIZ",
                "dataIndex": "CNTR_SIZE",
                "width": "40",
                "text": "尺寸"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "C_CNTR_TYP99",
                "dataIndex": "CNTR_TYPE",
                "width": "65",
                "keyName": "CNTR_TYPE",
                "text": "类型"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_POS",
                "dataIndex": "FROM_POS",
                "width": "65",
                "text": "起点"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_POS",
                "dataIndex": "TO_POS",
                "width": "65",
                "text": "终点"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_ON99",
                "dataIndex": "CREATED_ON",
                "text": "创建时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_ON99",
                "dataIndex": "UPDATED_ON",
                "text": "修改时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "BILL_NO",
                "dataIndex": "BILL_NO",
                "text": "提单号码"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CMDY_CODE",
                "dataIndex": "CMDY_CODE",
                "text": "货物名称"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "RELEASE_ID",
                "renderer": "if (top.Wb.yardCfsMap) //过虑不需要显示放行信息的记录\
{\
  if (record.data.TRADE_ID != '1') //内贸\
    return '';\
  if (app.taskType == 'GIN') //入闸\
    return '';\
  if (!(record.data.FROM_POS_TYP == 'V' || record.data.TO_POS_TYP == 'V')) //不是装卸船\
  {\
    var fromCfs = top.Wb.yardCfsMap[record.data.FROM_POS.substr(0, 2)] || 'JGQ';\
    if(app.taskType == 'GOUT' && fromCfs !='JGQ')//非监管区出闸\
      return '';\
    var toCfs = top.Wb.yardCfsMap[record.data.TO_POS.substr(0, 2)] || (record.data.TO_POS_TYP == 'B' ? 'JGQ' : undefined);\
    if (fromCfs == toCfs ||  !(toCfs == 'JGQ' || fromCfs == 'JGQ') || toCfs=='JGQ')\
      return '';\
  }\
}\
var color = value == '1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";\
return value == '1' ? '已放行' : '未放行';",
                "dataIndex": "RELEASE_ID",
                "width": "50",
                "text": "海关"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CARD_WRITE_ID",
                "renderer": "/*var color = value =='1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";*/\
return value =='1' ? '已写卡' : '';",
                "dataIndex": "CARD_WRITE_ID",
                "width": "50",
                "text": "已写卡"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "E_F_ID",
                "renderer": "var color = app.E_F_ID && app.E_F_ID[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return value === 'P' ? '拼柜' : value === 'F' ? '重柜' : '吉柜';",
                "dataIndex": "E_F_ID",
                "width": "40",
                "text": "吉重"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS199",
                "dataIndex": "TRCLASS1",
                "width": "40",
                "text": "机械类型1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1995",
                "dataIndex": "TRANSPORTER1",
                "width": "40",
                "text": "机械1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1991",
                "dataIndex": "TRCLASS2",
                "width": "40",
                "text": "机械类型2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19911",
                "dataIndex": "TRANSPORTER2",
                "width": "40",
                "text": "机载2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1992",
                "dataIndex": "TRCLASS3",
                "width": "40",
                "text": "机械类型3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19921",
                "dataIndex": "TRANSPORTER3",
                "width": "40",
                "text": "机载3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1993",
                "dataIndex": "TRCLASS4",
                "width": "40",
                "text": "机械类型4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19931",
                "dataIndex": "TRANSPORTER4",
                "width": "40",
                "text": "机械4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1994",
                "dataIndex": "TRCLASS5",
                "text": "机械类型5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19941",
                "dataIndex": "TRANSPORTER5",
                "text": "机械5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_YPOINT99",
                "dataIndex": "FROM_YPOINT",
                "text": "起始坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_XPOINT99",
                "dataIndex": "TO_XPOINT",
                "text": "目标坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "ORIGIN99",
                "dataIndex": "CARRIER_CODE",
                "text": "原始位置"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CARRIER_ATA99",
                "dataIndex": "CARRIER_ATA",
                "text": "来的时间"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SAFE_WT99",
                "dataIndex": "SAFE_WT",
                "text": "安全重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SCALE_WT99",
                "dataIndex": "SCALE_WT",
                "text": "过磅重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SERVICE99",
                "dataIndex": "SERVICE",
                "text": "航线"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OPL99",
                "dataIndex": "OPL",
                "text": "装货港"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRUCKING_CO99",
                "dataIndex": "TRUCKING_CO",
                "text": "车队"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRANSPORTER199",
                "dataIndex": "TRANSPORTER1",
                "text": "作业机械"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "LINE99",
                "dataIndex": "LINE",
                "width": "120",
                "text": "船公司"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_MAN99",
                "hidden": "true",
                "dataIndex": "CREATED_BY",
                "text": "创建人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_MAN99",
                "hidden": "true",
                "dataIndex": "UPDATED_BY",
                "text": "修改人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_LENGTH99",
                "hidden": "true",
                "dataIndex": "CNTR_LENGTH",
                "text": "长度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_HIGHT99",
                "hidden": "true",
                "dataIndex": "CNTR_HIGHT",
                "text": "高度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OVERHEIGHT99",
                "hidden": "true",
                "dataIndex": "OVERHEIGHT",
                "text": "超重"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "POSITION_STATUS99",
                "dataIndex": "POSITION_STATUS",
                "text": "位置状态"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              }
             ],
             "type": "array"
            },
            {
             "configs": {
              "itemId": "popupMenu",
              "normalName": "menu1"
             },
             "expanded": true,
             "children": [{
              "configs": {
               "itemId": "popupComp",
               "tooltip": "查看在场箱信息",
               "text": "查看在场箱信息",
               "iconCls": "property_icon"
              },
              "expanded": false,
              "children": [],
              "type": "item",
              "events": {"click": "Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: app.moveGrid.selModel.lastFocused.data.CNTR_ID\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
 // win.setPosition(\"100\",\"400\");\
\
    wins.show();\
  }\
});"}
             }],
             "type": "menu",
             "events": {"show": "var rows = app.moveGrid.getSelection();\
if (!(rows && rows[0])) {\
  menu.hide();\
  return;\
}\
"}
            }
           ],
           "type": "grid",
           "events": {"afterrender": "grid.store.sort('CREATED_ON','DESC');"}
          }],
          "type": "panel"
         },
         {
          "configs": {
           "layout": "fit",
           "itemId": "moveListbPanel",
           "split": "true",
           "collapsed": "true",
           "region": "south",
           "collapsible": "true",
           "height": "150"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "moveGridb",
            "multiColumnSort": "true",
            "tbar": "app.tbarMoveb",
            "disabled": "false",
            "multiSelect": "true"
           },
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "store",
              "pageSize": "50",
              "sorters": "'ID'",
              "url": "m?xwl=controlManage/task/worktaskcraneedit/moveListbSelect"
             },
             "expanded": false,
             "children": [],
             "type": "store"
            },
            {
             "configs": {"itemId": "columns"},
             "expanded": true,
             "children": [
              {
               "configs": {
                "itemId": "column1",
                "xtype": "rownumberer"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "BILL_NO99",
                "dataIndex": "BILL_NO",
                "text": "提单号码"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR99",
                "dataIndex": "GOODS_NOTES",
                "width": "120",
                "text": "货名"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "PHASE999",
                "renderer": "var map = {\
  PLN: '计划',\
  SND: '发送',\
  CNL: '撤销',\
  EXE: '执行',\
  TMP: '暂存',\
  FIN: '完成'\
};\
var color = app.TASK_STATE && app.TASK_STATE[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return map[value] || value;",
                "dataIndex": "PHASE",
                "width": "40",
                "text": "状态",
                "align": "center"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_POS99",
                "dataIndex": "FROM_POS",
                "width": "65",
                "text": "起点"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_POS99",
                "dataIndex": "TO_POS",
                "width": "65",
                "text": "终点"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "C_CNTR_TYP99",
                "dataIndex": "CNTR_TYPE",
                "width": "65",
                "text": "类型"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS199",
                "dataIndex": "TRCLASS1",
                "width": "40",
                "text": "机械类型1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1995",
                "dataIndex": "TRANSPORTER1",
                "width": "40",
                "text": "机械1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1991",
                "dataIndex": "TRCLASS2",
                "width": "40",
                "text": "机械类型2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19911",
                "dataIndex": "TRANSPORTER2",
                "width": "40",
                "text": "机载2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1992",
                "dataIndex": "TRCLASS3",
                "width": "40",
                "text": "机械类型3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19921",
                "dataIndex": "TRANSPORTER3",
                "width": "40",
                "text": "机载3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1993",
                "dataIndex": "TRCLASS4",
                "width": "40",
                "text": "机械类型4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19931",
                "dataIndex": "TRANSPORTER4",
                "width": "40",
                "text": "机械4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1994",
                "dataIndex": "TRCLASS5",
                "text": "机械类型5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19941",
                "dataIndex": "TRANSPORTER5",
                "text": "机械5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_YPOINT99",
                "dataIndex": "FROM_YPOINT",
                "text": "起始坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_XPOINT99",
                "dataIndex": "TO_XPOINT",
                "text": "目标坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "ORIGIN99",
                "dataIndex": "CARRIER_CODE",
                "text": "原始位置"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CARRIER_ATA99",
                "dataIndex": "CARRIER_ATA",
                "text": "来的时间"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SAFE_WT99",
                "dataIndex": "SAFE_WT",
                "text": "安全重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SCALE_WT99",
                "dataIndex": "SCALE_WT",
                "text": "过磅重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SERVICE99",
                "dataIndex": "SERVICE",
                "text": "航线"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OPL99",
                "dataIndex": "OPL",
                "text": "装货港"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRUCKING_CO99",
                "dataIndex": "TRUCKING_CO",
                "text": "车队"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRANSPORTER199",
                "dataIndex": "TRANSPORTER1",
                "text": "作业机械"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "LINE99",
                "dataIndex": "LINE",
                "width": "120",
                "text": "船公司"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_MAN99",
                "hidden": "true",
                "dataIndex": "CREATED_BY",
                "text": "创建人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_ON99",
                "dataIndex": "CREATED_ON",
                "text": "创建时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_ON99",
                "dataIndex": "UPDATED_ON",
                "text": "修改时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_MAN99",
                "hidden": "true",
                "dataIndex": "UPDATED_BY",
                "text": "修改人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_LENGTH99",
                "hidden": "true",
                "dataIndex": "CNTR_LENGTH",
                "text": "长度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_HIGHT99",
                "hidden": "true",
                "dataIndex": "CNTR_HIGHT",
                "text": "高度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OVERHEIGHT99",
                "hidden": "true",
                "dataIndex": "OVERHEIGHT",
                "text": "超重"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "POSITION_STATUS99",
                "dataIndex": "POSITION_STATUS",
                "text": "位置状态"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              }
             ],
             "type": "array"
            },
            {
             "configs": {
              "itemId": "popupMenu",
              "normalName": "menu1"
             },
             "expanded": true,
             "children": [{
              "configs": {
               "itemId": "popupComp",
               "tooltip": "查看在场箱信息",
               "text": "查看在场箱信息",
               "iconCls": "object_icon"
              },
              "expanded": false,
              "children": [],
              "type": "item",
              "events": {"click": "Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: app.moveGrid.selModel.lastFocused.data.CNTR_ID\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
 // win.setPosition(\"100\",\"400\");\
\
    wins.show();\
  }\
});"}
             }],
             "type": "menu",
             "events": {"show": "var rows = app.moveGrid.getSelection();\
if (!(rows && rows[0])) {\
  menu.hide();\
  return;\
}"}
            }
           ],
           "type": "grid"
          }],
          "type": "panel"
         }
        ],
        "type": "panel"
       },
       {
        "configs": {
         "border": "false",
         "layout": "border",
         "itemId": "panelPrint",
         "region": "south",
         "height": "0"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "border": "false",
           "itemId": "panelPrintF",
           "width": "60",
           "region": "east",
           "height": "0"
          },
          "expanded": false,
          "children": [],
          "type": "panel"
         },
         {
          "configs": {
           "border": "false",
           "itemId": "panelPrintE",
           "region": "center",
           "height": "0"
          },
          "expanded": false,
          "children": [],
          "type": "panel"
         }
        ],
        "type": "panel"
       }
      ],
      "type": "panel"
     },
     {
      "configs": {
       "itemId": "xwl1",
       "file": "m?xwl=system/common/rabbitMq"
      },
      "expanded": false,
      "children": [],
      "type": "xwl"
     }
    ],
    "type": "viewport"
   }
  ],
  "type": "module",
  "events": {
   "finalize": "window[\"init\" + opt] = function(id) {\
  var m = document.getElementById(opt);\
\
m.func(\"setCookie\", \"JSESSIONID={#JSESSIONID#}\");\
\
  if (id == opt) {\
    m.func(\"Build\", 'supcan/report/print/receipt_E.xml?' + Math.round(Math.random() * 100));\
    m.func(\"Build\", 'supcan/report/print/receipt_E.xml?' + Math.round(Math.random() * 100));\
    m.func(\"SetSource\", \"m?xwl=system/common/report/reportTemplate/dataSource&dd=\"+  Math.round(Math.random() * 100));\
    m.func(\"DisableMenu\", \"showRuler,exportAll,printAll,delete,insert,import,curselMode,hue,language,enter\\r\\
 true\");\
  }\
};\
\
window[\"init\" + opt1] = function(id) {\
  var m = document.getElementById(opt1);\
   m.func(\"setCookie\", \"JSESSIONID={#JSESSIONID#}\");\
  if (id == opt1) {\
   \
    m.func(\"Build\", 'supcan/report/print/receipt_F.xml?' + Math.round(Math.random() * 100));\
    m.func(\"Build\", 'supcan/report/print/receipt_F.xml?' + Math.round(Math.random() * 100));\
    m.func(\"DisableMenu\", \"showRuler,exportAll,printAll,delete,insert,import,curselMode,hue,language,enter\\r\\
 true\");\
  }\
};\
\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/taskColor\",\
  success: function(res) {\
    Wb.apply(app, Wb.decode(res.responseText));\
  }\
});\
\
var mt1 = bldStr(\"LuxForm\", opt, \"\", \"99%\");\
app.panelPrintE.update(mt1);\
var mt2 = bldStr(\"LuxForm\", opt1, \"\", \"99%\");\
app.panelPrintF.update(mt2);\
",
   "initialize": "var opt = Wb.getId();\
var opt1 = Wb.getId();"
  }
 }],
 "roles": {
  "SCANJB": 1,
  "xlablh": 1,
  "xlcd": 1,
  "ZSZKCZ": 1
 },
 "title": "任务指令查询",
 "iconCls": "",
 "inframe": false,
 "pageLink": ""
}