{
 "hidden": false,
 "children": [{
  "configs": {"itemId": "module"},
  "expanded": true,
  "children": [
   {
    "configs": {
     "layout": "border",
     "itemId": "disWin",
     "dialog": "true",
     "closeAction": "hide",
     "width": "500",
     "height": "400"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "tbar",
       "region": "north"
      },
      "expanded": false,
      "children": [{
       "configs": {
        "itemId": "W_TYPE",
        "width": "200"
       },
       "expanded": false,
       "children": [
        {
         "configs": {
          "itemId": "radio1",
          "boxLabel": "班组   ",
          "hidden": "true",
          "flex": "1"
         },
         "expanded": false,
         "children": [],
         "type": "radio"
        },
        {
         "configs": {
          "itemId": "radio2",
          "boxLabel": "拖车  ",
          "hidden": "true",
          "flex": "1"
         },
         "expanded": false,
         "children": [],
         "type": "radio"
        },
        {
         "configs": {
          "itemId": "radio4",
          "boxLabel": "设备  ",
          "hidden": "true",
          "flex": "1",
          "checked": "true"
         },
         "expanded": false,
         "children": [],
         "type": "radio"
        }
       ],
       "type": "radiogroup",
       "events": {"change": "app.disGrid.store.load({\
  params: {\
    taskId: app.taskId,\
    type:newValue\
  }\
});"}
      }],
      "type": "toolbar"
     },
     {
      "configs": {
       "itemId": "disGrid",
       "selType": "checkboxmodel",
       "disabled": "false",
       "region": "center",
       "multiSelect": "true"
      },
      "expanded": false,
      "children": [
       {
        "configs": {
         "groupField": "WTYPE",
         "itemId": "store",
         "pageSize": "-1",
         "sorters": "'ID'",
         "url": "m?xwl=controlManage/task/worktaskcraneedit/unselect"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "colID",
           "hidden": "true",
           "dataIndex": "ID",
           "text": "ID"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colTENANCY_ID",
           "hidden": "true",
           "dataIndex": "TENANCY_ID",
           "text": "租户"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "column1",
           "xtype": "rownumberer"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colRESOURCE_ID",
           "dataIndex": "RESOURCE_ID",
           "width": "80",
           "text": "工号"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "RESOURCE_NAMECOLUMN",
           "dataIndex": "RESOURCE_NAME",
           "width": "80",
           "text": "名称"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "RESOURCE_NAMECOLUMN1",
           "dataIndex": "GROUPING",
           "width": "80",
           "keyName": "C_EMPLOYEE_TEAM",
           "text": "班组"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colW_TYPE",
           "renderer": "if (value == '0') {\
  return \"操作人员\";\
}\
if (value == '1') {\
  return \"车辆\";\
}\
if (value == '2') {\
  return \"拖卡\";\
}\
if (value == '3') {\
  return \"场内机械设备\";\
}",
           "hidden": "true",
           "dataIndex": "W_TYPE",
           "text": "类型"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colBEG_WORK_TIM",
           "dataIndex": "BEG_WORK_TIM",
           "width": "120",
           "text": "工作开始时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colEND_WORK_TIM",
           "dataIndex": "END_WORK_TIM",
           "width": "120",
           "text": "工作结束时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colREMARK_TXT",
           "hidden": "true",
           "dataIndex": "REMARK_TXT",
           "width": "260",
           "text": "备注"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colSTATUS",
           "hidden": "true",
           "dataIndex": "STATUS",
           "text": "状态"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid"
     }
    ],
    "type": "window",
    "events": {
     "show": "app.disGrid.store.load({\
  params: {\
    taskId: app.taskId,\
    type:app.W_TYPE.getValue()\
  }\
});",
     "ok": "var s = app.disGrid.getSelection();\
var disArray = s.map(function(sel) {\
  return {\
    ID: sel.data.ID\
  };\
});\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/insertDisWork',\
  params: {\
    task: disArray,\
    taskId: app.taskId\
  },\
  success: function(resp) {\
    //Wb.toast(\"保存成功\",true);\
    app.gridworkduty.store.load({\
      params: {\
        taskId: app.taskId\
      }\
    });\
    win.close();\
  }\
});"
    }
   },
   {
    "configs": {
     "layout": "fit",
     "itemId": "dispatchWin",
     "dialog": "true",
     "closeAction": "hide",
     "width": "500",
     "title": "派工",
     "height": "400"
    },
    "expanded": false,
    "children": [{
     "configs": {
      "itemId": "disGrid",
      "selType": "checkboxmodel",
      "disabled": "false",
      "region": "center",
      "multiSelect": "true"
     },
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "store",
        "pageSize": "-1",
        "url": "m?xwl=controlManage/task/worktaskcraneedit/dispatch/select"
       },
       "expanded": false,
       "children": [],
       "type": "store"
      },
      {
       "configs": {"itemId": "columns"},
       "expanded": true,
       "children": [
        {
         "configs": {
          "itemId": "colID",
          "hidden": "true",
          "dataIndex": "ID",
          "text": "ID"
         },
         "expanded": false,
         "children": [],
         "type": "column"
        },
        {
         "configs": {
          "itemId": "colTENANCY_ID",
          "hidden": "true",
          "dataIndex": "TENANCY_ID",
          "text": "租户"
         },
         "expanded": false,
         "children": [],
         "type": "column"
        },
        {
         "configs": {
          "itemId": "column1",
          "xtype": "rownumberer"
         },
         "expanded": false,
         "children": [],
         "type": "column"
        },
        {
         "configs": {
          "itemId": "colTEAM_NAME",
          "dataIndex": "TEAM_NAME",
          "width": "80",
          "keyName": "C_EMPLOYEE_TEAM",
          "text": "班组名称"
         },
         "expanded": false,
         "children": [],
         "type": "column"
        },
        {
         "configs": {
          "itemId": "colEMPNO",
          "dataIndex": "EMPNO",
          "width": "80",
          "text": "工号"
         },
         "expanded": false,
         "children": [],
         "type": "column"
        },
        {
         "configs": {
          "itemId": "colEMPNAME",
          "dataIndex": "EMPNAME",
          "width": "80",
          "text": "名称"
         },
         "expanded": false,
         "children": [],
         "type": "column"
        }
       ],
       "type": "array"
      }
     ],
     "type": "grid"
    }],
    "type": "window",
    "events": {
     "show": "app.disGrid.store.load({\
  params: {\
    taskId: app.taskId\
  }\
});",
     "ok": "var s = app.disGrid.getSelection();\
var disArray = s.map(function(sel) {\
  return {\
    ID: sel.data.ID\
  };\
});\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/dispatch/insert',\
  params: {\
    task: disArray,\
    taskId: app.taskId\
  },\
  success: function(resp) {\
    //Wb.toast(\"保存成功\",true);\
    app.gridworkduty.store.load({\
      params: {\
        taskId: app.taskId\
      }\
    });\
    win.close();\
  }\
});"
    }
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "exptWin",
     "closeAction": "hide",
     "width": "600",
     "title": "异常箱登记",
     "height": "300"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "toolbar1",
       "region": "north",
       "height": "30"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "addadd",
         "tooltip": "增加",
         "text": "增加",
         "iconCls": "record_add_icon"
        },
        "expanded": false,
        "children": [],
        "type": "button",
        "events": {"click": "Wb.addEdit(app.cntrGrid, {\
  VID: app.treeTask.getSelection()[0].raw.ship,\
  EXCEPTION_TYPE: 'SHORT'\
});"}
       },
       {
        "configs": {
         "itemId": "deleteadd",
         "text": "删除",
         "iconCls": "record_delete_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "Wb.remove(app.cntrGrid);"}
       },
       {
        "configs": {
         "itemId": "saveadd",
         "text": "保存",
         "iconCls": "save_icon"
        },
        "expanded": false,
        "children": [],
        "type": "button",
        "events": {"click": "if (!Wb.verifyGrid(app.cntrGrid)) //验证数据是否合法\
  return;\
Wb.sync({\
  grid: app.cntrGrid,\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/saveExceptionCntr',\
  message: '正在保存中...',\
  success: function(resp) {\
    app.cntrGrid.store.commitChanges();\
    Wb.info('保存成功!');\
  }\
});"}
       }
      ],
      "type": "toolbar"
     },
     {
      "configs": {
       "itemId": "cntrGrid",
       "editable": "true",
       "region": "center"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "store",
         "url": "m?xwl=controlManage/task/worktaskcraneedit/selectExceptionCntr"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "VID",
           "dataIndex": "VID",
           "width": "0"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "EXCEPTION_TYPE",
           "dataIndex": "EXCEPTION_TYPE",
           "width": "0"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR",
           "dataIndex": "CNTR",
           "width": "110",
           "text": "箱号"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "isUpperCase": "true"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_ISO",
           "dataIndex": "CNTR_ISO",
           "width": "40",
           "text": "ISO"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "isUpperCase": "true"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_TYPE",
           "hidden": "false",
           "dataIndex": "CNTR_TYPE",
           "text": "箱型"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "keyName": "CNTR_TYPE"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_SIZE",
           "hidden": "false",
           "dataIndex": "CNTR_SIZE",
           "text": "尺寸"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "keyName": "CNTR_SIZE"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "E_F_ID",
           "hidden": "false",
           "dataIndex": "E_F_ID",
           "text": "空重"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "allowBlank": "false",
            "keyName": "E_F_ID"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "NOTES",
           "dataIndex": "NOTES",
           "width": "200",
           "text": "备注"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "height": "100"
           },
           "expanded": false,
           "children": [],
           "type": "textarea"
          }],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid"
     }
    ],
    "type": "window",
    "events": {"show": "app.cntrGrid.store.reload({\
  params: {\
    vid: app.treeTask.getSelection()[0].raw.ship\
  }\
});"}
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "exptViewWin",
     "closeAction": "hide",
     "width": "300",
     "title": "异常箱查看",
     "height": "500"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "toolbar1",
       "region": "north",
       "height": "30"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "delete",
         "text": "删除",
         "iconCls": "record_delete_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "Wb.confirm(\"删除后图片将无法找回，是否要删除当前异常信息？\", function() {\
  Wb.request({\
    url: \"m?xwl=controlManage/task/worktaskcraneedit/deleteExceptImage\",\
    params: {\
      id: app.taskId\
    },\
    success: function() {\
      app.exptViewWin.close();\
    }\
  });\
});"}
       },
       {
        "configs": {
         "itemId": "prev",
         "disabled": "true",
         "text": "上一张",
         "iconCls": "left_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "app.next.enable();\
app.img.setSrc(app.urls[--app.index]);\
if (app.index === 0)\
  app.prev.disable();"}
       },
       {
        "configs": {
         "itemId": "next",
         "disabled": "true",
         "text": "下一张",
         "iconCls": "right_icon"
        },
        "expanded": true,
        "children": [],
        "type": "button",
        "events": {"click": "app.prev.enable();\
app.img.setSrc(app.urls[++app.index]);\
if (app.index === app.urls.length - 1)\
  app.next.disable();"}
       }
      ],
      "type": "toolbar"
     },
     {
      "configs": {
       "layout": "absolute",
       "itemId": "panel1",
       "width": "296",
       "height": "480"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "CNTR",
         "fieldLabel": "箱号",
         "x": "8",
         "width": "180",
         "y": "0",
         "readOnly": "true",
         "labelWidth": "40",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "CNTR_SIZE",
         "fieldLabel": "尺寸",
         "x": "200",
         "width": "80",
         "y": "0",
         "readOnly": "true",
         "labelWidth": "40",
         "height": "22"
        },
        "expanded": true,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "img",
         "x": "0",
         "width": "296",
         "y": "48",
         "height": "400"
        },
        "expanded": false,
        "children": [],
        "type": "image"
       },
       {
        "configs": {
         "itemId": "URL",
         "x": "136",
         "width": "36",
         "y": "72",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "hidden"
       },
       {
        "configs": {
         "itemId": "SHIP",
         "fieldLabel": "船舶",
         "x": "8",
         "width": "273",
         "y": "24",
         "readOnly": "true",
         "labelWidth": "40",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       }
      ],
      "type": "panel"
     }
    ],
    "type": "window",
    "events": {"show": "app.prev.disable();\
app.next.disable();\
var url = app.URL.getValue();\
if (url) {\
  app.urls = url.split(',');\
  app.index = 0;\
  if (app.urls.length > 0) {\
    app.img.setSrc(app.urls[0]);\
    if (app.urls.length > 1)\
      app.next.enable();\
  }\
}"}
   },
   {
    "configs": {
     "itemId": "movReqWin",
     "dialog": "true",
     "title": "移箱申请"
    },
    "expanded": false,
    "children": [{
     "configs": {"itemId": "panel1"},
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "pos",
        "fieldLabel": "当前箱位"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "to_pos",
        "allowBlank": "false",
        "vtype": "alphanum",
        "fieldLabel": "目标位置",
        "isUpperCase": "true"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {"itemId": "cntr"},
       "expanded": false,
       "children": [],
       "type": "hidden"
      },
      {
       "configs": {
        "itemId": "needTruck",
        "fieldLabel": "需要拖车",
        "value": "true"
       },
       "expanded": false,
       "children": [],
       "type": "check"
      },
      {
       "configs": {
        "itemId": "remark",
        "fieldLabel": "备注信息"
       },
       "expanded": false,
       "children": [],
       "type": "textarea"
      }
     ],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var val = Wb.getValue(win);\
var task = {\
  task_type: 'MOVE',\
  to_pos: val.to_pos,\
  needTruck: val.needTruck ? '' : 'ROR',\
  remark: val.remark,\
  cntrs: [val.cntr]\
};\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/insertTask\",\
  params: task,\
  showError: false,\
  success: function() {\
    win.close();\
  },\
  failure: function(resp) {\
    app.moveListWin.cntr = val.cntr;\
    app.moveListWin.show();\
    Wb.except(resp);\
  }\
});"}
   },
   {
    "configs": {
     "layout": "fit",
     "itemId": "moveListWin",
     "width": "800",
     "title": "任务列表",
     "height": "500"
    },
    "expanded": false,
    "children": [{
     "configs": {
      "layout": "fit",
      "itemId": "moveListPanel",
      "region": "center"
     },
     "expanded": true,
     "children": [{
      "configs": {
       "itemId": "moveWndGrid",
       "multiColumnSort": "true",
       "tbar": "app.tbarMove",
       "disabled": "false",
       "viewConfig": "{\
\t 'itemcontextmenu':function(view,record,item,index,e,eOpts){  \
\t                     //禁用浏览器的右键相应事件  \
\t                    e.preventDefault();  \
                         e.stopEvent();  \
     }\
}",
       "multiSelect": "true"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "sortOnLoad": "true",
         "itemId": "store",
         "pageSize": "1000",
         "url": "m?xwl=controlManage/task/worktaskcraneedit/moveListSelectByCntr"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": false,
        "children": [
         {
          "configs": {
           "itemId": "column1",
           "renderer": "if (app.taskType == 'VOUT' || app.taskType == 'VIN') {\
  if (record.data.IV == 0)\
    metaData.style = 'background-color:red;';\
  else if (record.data.CNUM > 1)\
    metaData.style = 'background-color:yellow;';\
}\
return rowIndex + 1;",
           "xtype": "rownumberer"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "PHASE",
           "renderer": "var map = {\
  PLN: '计划',\
  SND: '发送',\
  CNL: '撤销',\
  EXE: '执行',\
  TMP: '暂存',\
  FIN: '完成'\
};\
var color = app.TASK_STATE && app.TASK_STATE[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return map[value] || value;",
           "dataIndex": "PHASE",
           "width": "40",
           "text": "状态",
           "align": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR99",
           "renderer": "if (record.data.PRIORITY == 2)\
  metaData.style = 'background-color:red;';\
return value;",
           "dataIndex": "CNTR",
           "width": "90",
           "text": "箱号"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "C_CNTR_SIZ",
           "dataIndex": "CNTR_SIZE",
           "width": "40",
           "text": "尺寸"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "C_CNTR_TYP99",
           "dataIndex": "CNTR_TYPE",
           "width": "40",
           "keyName": "CNTR_TYPE",
           "text": "类型"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "FROM_POS",
           "dataIndex": "FROM_POS",
           "width": "65",
           "text": "起点"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TO_POS",
           "dataIndex": "TO_POS",
           "width": "65",
           "text": "终点"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CREATED_ON99",
           "dataIndex": "CREATED_ON",
           "text": "创建时间"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "UPDATED_ON99",
           "dataIndex": "UPDATED_ON",
           "text": "修改时间"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "BILL_NO",
           "dataIndex": "BILL_NO",
           "text": "提单号码"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CMDY_CODE",
           "dataIndex": "CMDY_CODE",
           "text": "货物名称"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "RELEASE_ID",
           "renderer": "if (top.Wb.yardCfsMap) //过虑不需要显示放行信息的记录\
{\
  if (record.data.TRADE_ID != '1') //内贸\
    return '';\
  if (app.taskType == 'GIN') //入闸\
    return '';\
  if (!(record.data.FROM_POS_TYP == 'V' || record.data.TO_POS_TYP == 'V')) //不是装卸船\
  {\
    var fromCfs = top.Wb.yardCfsMap[record.data.FROM_POS.substr(0, 2)] || 'JGQ';\
    if(app.taskType == 'GOUT' && fromCfs !='JGQ')//非监管区出闸\
      return '';\
    var toCfs = top.Wb.yardCfsMap[record.data.TO_POS.substr(0, 2)] || (record.data.TO_POS_TYP == 'B' ? 'JGQ' : undefined);\
    if (fromCfs == toCfs ||  !(toCfs == 'JGQ' || fromCfs == 'JGQ') || toCfs=='JGQ')\
      return '';\
  }\
}\
var color = value == '1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";\
return value == '1' ? '已放行' : '未放行';",
           "dataIndex": "RELEASE_ID",
           "width": "50",
           "text": "海关"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CARD_WRITE_ID",
           "renderer": "/*var color = value =='1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";*/\
return value =='1' ? '已写卡' : '';",
           "dataIndex": "CARD_WRITE_ID",
           "width": "50",
           "text": "已写卡"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "E_F_ID",
           "renderer": "var color = app.E_F_ID && app.E_F_ID[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return value === 'P' ? '拼柜' : value === 'F' ? '重柜' : '吉柜';",
           "dataIndex": "E_F_ID",
           "width": "40",
           "text": "吉重"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS199",
           "dataIndex": "TRCLASS1",
           "width": "40",
           "text": "机械类型1"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1995",
           "dataIndex": "TRANSPORTER1",
           "width": "40",
           "text": "机械1"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1991",
           "dataIndex": "TRCLASS2",
           "width": "40",
           "text": "机械类型2"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19911",
           "dataIndex": "TRANSPORTER2",
           "width": "40",
           "text": "机载2"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1992",
           "dataIndex": "TRCLASS3",
           "width": "40",
           "text": "机械类型3"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19921",
           "dataIndex": "TRANSPORTER3",
           "width": "40",
           "text": "机载3"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1993",
           "dataIndex": "TRCLASS4",
           "width": "40",
           "text": "机械类型4"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19931",
           "dataIndex": "TRANSPORTER4",
           "width": "40",
           "text": "机械4"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1994",
           "dataIndex": "TRCLASS5",
           "text": "机械类型5"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19941",
           "dataIndex": "TRANSPORTER5",
           "text": "机械5"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "FROM_YPOINT99",
           "dataIndex": "FROM_YPOINT",
           "text": "起始坐标"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TO_XPOINT99",
           "dataIndex": "TO_XPOINT",
           "text": "目标坐标"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "ORIGIN99",
           "dataIndex": "CARRIER_CODE",
           "text": "原始位置"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CARRIER_ATA99",
           "dataIndex": "CARRIER_ATA",
           "text": "来的时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SAFE_WT99",
           "dataIndex": "SAFE_WT",
           "text": "安全重量"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SCALE_WT99",
           "dataIndex": "SCALE_WT",
           "text": "过磅重量"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SERVICE99",
           "dataIndex": "SERVICE",
           "text": "航线"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "OPL99",
           "dataIndex": "OPL",
           "text": "装货港"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRUCKING_CO99",
           "dataIndex": "TRUCKING_CO",
           "text": "车队"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRANSPORTER199",
           "dataIndex": "TRANSPORTER1",
           "text": "作业机械"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "LINE99",
           "dataIndex": "LINE",
           "width": "120",
           "text": "船公司"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CREATED_MAN99",
           "hidden": "true",
           "dataIndex": "CREATED_BY",
           "text": "创建人"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "UPDATED_MAN99",
           "hidden": "true",
           "dataIndex": "UPDATED_BY",
           "text": "修改人"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_LENGTH99",
           "hidden": "true",
           "dataIndex": "CNTR_LENGTH",
           "text": "长度"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_HIGHT99",
           "hidden": "true",
           "dataIndex": "CNTR_HIGHT",
           "text": "高度"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "OVERHEIGHT99",
           "hidden": "true",
           "dataIndex": "OVERHEIGHT",
           "text": "超重"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "POSITION_STATUS99",
           "dataIndex": "POSITION_STATUS",
           "text": "位置状态"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       },
       {
        "configs": {
         "itemId": "popupMenu",
         "normalName": "menu1"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "popupComp",
           "tooltip": "查看在场箱信息",
           "text": "查看在场箱信息",
           "iconCls": "property_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: app.moveGrid.selModel.lastFocused.data.CNTR_ID\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
 // win.setPosition(\"100\",\"400\");\
\
    wins.show();\
  }\
});"}
         },
         {
          "configs": {
           "itemId": "sendBtn",
           "tooltip": "发送",
           "text": "发送",
           "iconCls": "flag1_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (sels.length === 0)\
  return Wb.error('请选择要操作的记录');\
var sel = sels[0];\
if (sel.raw.TASK_TYPE == 'VOUT') //装船替换掉小伟的逻辑\
{\
  Wb.request({\
    url: 'm?xwl=controlManage/task/worktaskcraneedit/sendIns',\
    params: {\
      tskid: sel.raw.QUEUE_ID,\
      ship: sel.raw.CARRIER_CALL,\
      type: sel.raw.TASK_TYPE,\
      moves: [sel.data.ID]\
    },\
    success: function(resp) {\
      Wb.info(resp.responseText);\
    }\
  });\
  return;\
}\
\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/instSplit',\
  params: {\
    id: sel.raw.QUEUE_ID,\
    type: sel.raw.TASK_TYPE,\
    cntrs: [sel.data.CNTR],\
    moves: [sel.data.ID]\
  },\
  success: function(resp) {\
    Wb.info(resp.responseText);\
  }\
});"}
         },
         {
          "configs": {
           "itemId": "cancelBtn",
           "tooltip": "取消发送",
           "text": "取消",
           "iconCls": "undo_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (sels.length === 0)\
  return Wb.error('请选择要操作的记录');\
var sel = sels[0];\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/delInstSplit',\
  params: {\
    taskId: sel.raw.QUEUE_ID,\
    ship: sel.raw.CARRIER_CALL,\
    type: sel.raw.TASK_TYPE,\
    moves: [sel.data.ID]\
  },\
  success: function(resp) {\
    Wb.info(\"成功\"); //resp.responseText);\
  }\
});"}
         },
         {
          "configs": {
           "itemId": "writeCardBtn",
           "tooltip": "写卡",
           "text": "写卡",
           "iconCls": "book_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "app.card.writeCardWin.HANDLE_ID = app.moveWndGrid.selModel.lastFocused.data.ID;\
app.card.writeCardWin.show();"}
         },
         {
          "configs": {
           "itemId": "modifyCyBtn",
           "tooltip": "指定目标场位",
           "text": "指定目标场位",
           "iconCls": "boxs_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (!(sels && sels.length))\
  return;\
var olds = [];\
var moves = [];\
Wb.each(sels, function(r) {\
  if ((r.data.TO_POS_TYP === 'B' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN') {\
    if (olds.indexOf(r.data.TO_POS)== -1)\
      olds.push(r.data.TO_POS);\
    moves.push(r.data.ID);\
  }\
});\
Wb.setValue(app.toPosWin, {\
  old_pos: olds ? olds.join(',') : '',\
  to_pos: ''\
});\
app.toPosWin.moves = moves;\
app.toPosWin.show();"}
         },
         {
          "configs": {
           "itemId": "popupPrint",
           "tooltip": "放行条",
           "text": "放行条",
           "iconCls": "yellow-orders_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sel = app.moveWndGrid.getSelection()[0];\
var tenancyid = \"{#sys.TENANCY_ID#}\";\
var whereSql = encodeURI(\" and r.tenancy_id='\" + tenancyid + \"' and r.id='\" + sel.data.HANDLE_ID + \"'\");\
var AF1 = document.getElementById(opt);\
AF1.func(\"SetParas\", \"ds1 \\r\\
 para=1;whereSql=\" + whereSql);\
var cfsCod = Wb.yardCfsMap[sel.data.TO_POS.substr(0, 2)];\
\
if (cfsCod == \"NMQ\") {\
  AF1.func(\"SetCellData\", \"<data B4='出口拼柜仓' B18='出口拼柜仓' B33='出口拼柜仓' B47='出口拼柜仓'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}\
if (cfsCod == \"LN\") {\
  AF1.func(\"SetCellData\", \"<data B4='路南' B18='路南' B33='路南' B47='路南'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}\
\
if (cfsCod == \"JGQ\") {\
  AF1.func(\"SetCellData\", \"<data B4='监管区' B18='监管区' B33='监管区' B47='监管区'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}"}
         },
         {
          "configs": {
           "itemId": "popupTruck",
           "tooltip": "换车",
           "text": "换车",
           "iconCls": "vans_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (!(sels && sels.length))\
  return;\
var olds = [];\
var moves = [];\
Wb.each(sels, function(r) {\
  moves.push(r.data.ID);\
  for (var i = 1; i < 5; ++i)\
    if (r.data['TRCLASS' + i] == 'TG') {\
      var truck = r.data['TRANSPORTER' + i];\
      if (!olds.includes(truck))\
        olds.push(truck);\
      break;\
    }\
});\
Wb.setValue(app.truckWin, {\
  old_truck: olds ? olds.join(',') : '',\
  truck: ''\
});\
app.truckWin.moves = moves;\
app.truckWin.show();"}
         },
         {
          "configs": {
           "itemId": "popupRevoke",
           "tooltip": "撤销",
           "text": "撤销",
           "iconCls": "cancel_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/revoke',\
  params: {\
    id: app.moveWndGrid.selModel.lastFocused.data.ID,\
    cntr: app.moveWndGrid.selModel.lastFocused.data.CNTR,\
    type: app.moveWndGrid.selModel.lastFocused.raw.TASK_TYPE\
  },\
  success: function(resp) {\
    var ret = Wb.decode(resp.responseText);\
    if (!ret.success) {\
      Wb.error(\"保存撤销标志失败\");\
      return;\
    }\
    app.moveGrid.selModel.lastFocused.set('PHASE', 'CNL');\
    app.moveGrid.selModel.lastFocused.commit();\
  }\
});"}
         },
         {
          "configs": {
           "itemId": "popupGateCnl",
           "tooltip": "取消进门",
           "text": "取消进门",
           "iconCls": "first_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.request({\
  url: 'm?xwl=receiptInout/gate/gatebackedit/gateTiBack',\
  params: {\
    cntr: sels[0].data.CNTR\
  },\
  success: function(resp) {\
    var ret = JSON.parse(resp.responseText);\
    if(!ret.success)\
      Wb.error(ret.errstr);\
    else\
    {\
      Wb.info('取消成功');\
      app.treeTask.store.reload();\
    }\
  }\
});"}
         },
         {
          "configs": {
           "itemId": "popupPriority",
           "tooltip": "设置优先作业",
           "text": "设置优先作业",
           "iconCls": "top_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/prior',\
  params: {\
    ship: sel.raw.CARRIER_CALL,\
    type: sel.raw.TASK_TYPE,\
    ids: sels.map(function(s) {\
      return s.data.ID;\
    }),\
    taskId: sel.raw.QUEUE_ID\
  },\
  success: function(resp) {}\
});"}
         },
         {
          "configs": {
           "itemId": "popupPriorityCnl",
           "tooltip": "取消优先作业",
           "text": "取消优先作业",
           "iconCls": "top_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/canclePrior',\
  params: {\
    ship: sel.raw.CARRIER_CALL,\
      type: sel.raw.TASK_TYPE,\
    ids: sels.map(function(s) {\
      return s.data.ID;\
    }),\
    taskId: sel.raw.QUEUE_ID\
  },\
  success: function(resp) {}\
});"}
         },
         {
          "configs": {
           "itemId": "popupRemark",
           "tooltip": "设置备注",
           "text": "备注",
           "iconCls": "notepad_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveWndGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.setValue(app.remarkWin, {\
  notes: sels[0].data.NOTES,\
  id:sels[0].data.ID\
});\
app.remarkWin.show();"}
         }
        ],
        "type": "menu",
        "events": {"show": "var rows = app.moveWndGrid.getSelection();\
if (!(rows && rows[0])) {\
  menu.hide();\
  return;\
}\
//发送按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'PLN';\
  }))\
  menu.down(\"#sendBtn\").show();\
else\
  menu.down(\"#sendBtn\").hide();\
\
//取消按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'SND' && r.data.FROM_POS_TYP != 'G' && r.data.TO_POS_TYP != 'G';\
  }))\
  menu.down(\"#cancelBtn\").show();\
else\
  menu.down(\"#cancelBtn\").hide();\
\
//写卡按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.RELEASE_ID == 1 && (r.data.Y2Y_ID === 1 || r.data.TO_POS_TYP === 'G' || r.data.FROM_POS_TYP === 'G');\
  }))\
  menu.down(\"#writeCardBtn\").show();\
else\
  menu.down(\"#writeCardBtn\").hide();\
\
\
//修改场位是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return (r.data.TO_POS_TYP === 'B' || r.data.TO_POS_TYP === 'V' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN';\
  }))\
  menu.down(\"#modifyCyBtn\").show();\
else\
  menu.down(\"#modifyCyBtn\").hide();\
\
//撤销是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'PLN';\
  }))\
  menu.down(\"#popupRevoke\").show();\
else\
  menu.down(\"#popupRevoke\").hide();\
\
//取消进门是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.TO_POS_TYP === 'G' && r.data.PHASE === 'SND';\
  }))\
  menu.down(\"#popupGateCnl\").show();\
else\
  menu.down(\"#popupGateCnl\").hide();\
\
//设置优先作业是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PRIORITY === 1;\
  }))\
  menu.down(\"#popupPriority\").show();\
else\
  menu.down(\"#popupPriority\").hide();\
\
//取消优先作业是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PRIORITY === 2;\
  }))\
  menu.down(\"#popupPriorityCnl\").show();\
else\
  menu.down(\"#popupPriorityCnl\").hide();\
\
//打印放行条是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.Y2Y_ID;\
  }))\
  menu.down(\"#popupPrint\").show();\
else\
  menu.down(\"#popupPrint\").hide();\
"}
       }
      ],
      "type": "grid",
      "events": {"afterrender": "grid.store.sort('CREATED_ON','DESC');"}
     }],
     "type": "panel"
    }],
    "type": "window",
    "events": {"show": "app.moveWndGrid.store.reload({\
  params: {\
    cntr: win.cntr\
  }\
});"}
   },
   {
    "configs": {
     "itemId": "selCntrWin",
     "dialog": "true",
     "title": "选择"
    },
    "expanded": false,
    "children": [{
     "configs": {"itemId": "panel1"},
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "cntr",
        "allowBlank": "false",
        "pickList": "[]",
        "fieldLabel": "箱号"
       },
       "expanded": false,
       "children": [],
       "type": "combo",
       "events": {"change": "var cntr = combo.getValue();\
if (!cntr)\
  return;\
var win = combo.up('window');\
var types = win.data.reduce(function(arr, r) {\
  if (r.CNTR == cntr && !Ext.Array.contains(arr, r.TASK_TYPE))\
    arr.push(r.TASK_TYPE);\
  return arr;\
}, []);\
var type = win.down('#type');\
\
if (!app.hasTriggerClick) {\
  type.onTriggerClick();\
  app.hasTriggerClick = true;\
}\
\
type.store.filterBy(function(i) {\
  return Ext.Array.contains(types, i.data.K);\
});\
type.select('');\
if (types.length == 1) {\
  type.select(types[0]);\
  type.setReadOnly(true);\
} else\
  type.setReadOnly(false);"}
      },
      {
       "configs": {
        "allowBlank": "false",
        "itemId": "type",
        "fieldLabel": "任务类型",
        "keyName": "TASK_TYPE",
        "queryCaching": "true",
        "selectOnFocus": "true"
       },
       "expanded": false,
       "children": [],
       "type": "combo"
      }
     ],
     "type": "panel"
    }],
    "type": "window",
    "events": {
     "show": "var cntr = win.down('#cntr');\
cntr.select('');\
var cntrs = win.data.reduce(function(arr, r) {\
  if (!Ext.Array.contains(arr, r.CNTR))\
    arr.push(r.CNTR);\
  return arr;\
}, []).map(function(c) {\
  return [c];\
});\
cntr.store.loadData(cntrs);\
if (cntrs.length == 1) {\
  cntr.select(cntrs[0][0]);\
  cntr.setReadOnly(true);\
} else\
  cntr.setReadOnly(false);",
     "ok": "var data = Wb.getValue(win);\
var rows = win.data.filter(function(r) {\
  return r.CNTR == data.cntr && r.TASK_TYPE == data.type;\
});\
var pnl = win.target;\
if (pnl === app.panelCntr2 && rows[0].CNTR_SIZE > 20)\
  return Wb.error('妈柜不能有40尺柜');\
win.target.cntrInfo = rows[0];\
Wb.setValue(win.target, rows[0]);\
app.truck.setValue(pnl.cntrInfo.IN_CAR);\
app.plate.setValue(pnl.cntrInfo.PLAT_NO);\
win.close();"
    }
   },
   {
    "configs": {
     "itemId": "toPosWin",
     "dialog": "true",
     "title": "修改目标场位"
    },
    "expanded": false,
    "children": [{
     "configs": {"itemId": "panel1"},
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "old_pos",
        "fieldLabel": "原计划位置"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "to_pos",
        "allowBlank": "false",
        "vtype": "alphanum",
        "fieldLabel": "新计划位置",
        "isUpperCase": "true"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      }
     ],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var val = Wb.getValue(win);\
var param = {\
  to_pos: val.to_pos,\
  moves: win.moves,\
  ship: app.treeTask.getSelection()[0].raw.ship,\
  type: app.treeTask.getSelection()[0].parentNode.data.id,\
  taskId: app.taskId\
};\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/modifyToPos\",\
  params: param,\
  success: function() {\
    win.close();\
  }\
});"}
   },
   {
    "configs": {
     "itemId": "cyBackWin",
     "dialog": "true",
     "title": "返场目标场位"
    },
    "expanded": false,
    "children": [{
     "configs": {"itemId": "panel1"},
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "old_pos",
        "fieldLabel": "原位置"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "to_pos",
        "allowBlank": "false",
        "vtype": "alphanum",
        "fieldLabel": "新计划位置",
        "isUpperCase": "true"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      }
     ],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/cyBack',\
  params: Wb.apply({\
    id: app.moveGrid.selModel.lastFocused.data.ID\
  }, Wb.getValue(win)),\
  success: function(resp) {\
    var ret = Wb.decode(resp.responseText);\
    if (!ret.success) {\
      Wb.error(ret.errstr);\
      return;\
    }\
    win.close();\
  }\
});"}
   },
   {
    "configs": {
     "itemId": "truckWin",
     "dialog": "true",
     "title": "修改拖车"
    },
    "expanded": false,
    "children": [{
     "configs": {"itemId": "panel1"},
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "old_truck",
        "fieldLabel": "原拖车"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "truck",
        "allowBlank": "false",
        "vtype": "alphanum",
        "fieldLabel": "新拖车",
        "isUpperCase": "true"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      }
     ],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var val = Wb.getValue(win);\
var param = {\
  truck: val.truck,\
  moves: win.moves,\
  ship: app.treeTask.getSelection()[0].raw.ship,\
  type: app.treeTask.getSelection()[0].parentNode.data.id,\
  taskId: app.taskId\
};\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/modifyTruck\",\
  params: param,\
  success: function() {\
    win.close();\
  }\
});"}
   },
   {
    "configs": {
     "itemId": "discWin",
     "dialog": "true",
     "title": "卸船确认"
    },
    "expanded": false,
    "children": [{
     "configs": {"itemId": "panel1"},
     "expanded": true,
     "children": [{
      "configs": {
       "itemId": "truck",
       "allowBlank": "false",
       "vtype": "alphanum",
       "fieldLabel": "拖车",
       "isUpperCase": "true"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     }],
     "type": "panel"
    }],
    "type": "window",
    "events": {"ok": "var val = Wb.getValue(win);\
var sels = app.moveGrid.getSelection();\
Wb.each(sels, function(sel) {\
  Wb.request({\
    url: 'appFun',\
    params: Wb.apply({\
      funId: 'SAVE_UNLOAD',\
      cntr: sel.data.CNTR,\
      ship: app.treeTask.selModel.selected.items[0].raw.ship\
    }, val),\
    success: function(resp) {\
      var ret = Wb.decode(resp.responseText);\
      if (!ret.sucess && ret.errstr)\
        Wb.error(ret.errstr);\
    }\
  });\
});"}
   },
   {
    "configs": {
     "itemId": "loadBackWin",
     "dialog": "true",
     "title": "装船回退"
    },
    "expanded": false,
    "children": [{
     "configs": {"itemId": "panel1"},
     "expanded": true,
     "children": [
      {
       "configs": {
        "itemId": "truck",
        "fieldLabel": "拖车",
        "isUpperCase": "true"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      },
      {
       "configs": {
        "itemId": "to_pos",
        "allowBlank": "false",
        "vtype": "alphanum",
        "fieldLabel": "位置",
        "isUpperCase": "true"
       },
       "expanded": false,
       "children": [],
       "type": "text"
      }
     ],
     "type": "panel"
    }],
    "type": "window",
    "events": {
     "show": "var truck = app.moveGrid.selModel.lastFocused.data.TRANSPORTER1;\
Wb.setValue(win, {\
  truck: truck,\
  to_pos: ''\
});",
     "ok": "var val = Wb.getValue(win);\
var sel = app.moveGrid.getSelection()[0];\
if (!sel)\
  return;\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/loadBack\",\
  params: Wb.apply(val, {\
    id: sel.data.ID,\
    cntr: sel.data.CNTR,\
    ship: sel.data.CARRIER_CALL\
  }),\
  success: function(resp) {\
    var result = Wb.decode(resp.responseText);\
    if (result.success) {\
      win.close();\
    } else\
      Wb.error(result.errstr);\
  }\
});"
    }
   },
   {
    "configs": {
     "itemId": "remarkWin",
     "dialog": "true",
     "title": "设置备注"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "itemId": "notes",
       "width": "300",
       "height": "200"
      },
      "expanded": false,
      "children": [],
      "type": "textarea"
     },
     {
      "configs": {"itemId": "id"},
      "expanded": false,
      "children": [],
      "type": "hidden"
     }
    ],
    "type": "window",
    "events": {"ok": "var val = Wb.getValue(win);\
var sel = app.moveGrid.getSelection()[0];\
if (!sel)\
  return;\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/setRemark\",\
  params: Wb.apply(val, {\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id\
  }),\
  success: function(resp) {\
    var result = Wb.decode(resp.responseText);\
    if (result.success) {\
      win.close();\
      sel.set('NOTES', val.notes);\
      sel.commit();\
    } else\
      Wb.error(result.errstr);\
  }\
});"}
   },
   {
    "configs": {
     "itemId": "card",
     "file": "m?xwl=controlManage/task/writeCardWin"
    },
    "expanded": false,
    "children": [],
    "type": "xwl"
   },
   {
    "configs": {
     "layout": "fit",
     "itemId": "viewport1"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "layout": "border",
       "itemId": "panel2"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "layout": "border",
         "itemId": "panelLeft",
         "split": "true",
         "width": "260",
         "region": "west"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "layout": "absolute",
           "itemId": "panelInfo",
           "split": "true",
           "width": "232",
           "region": "center",
           "collapsible": "true",
           "height": "400"
          },
          "expanded": true,
          "children": [
           {
            "configs": {
             "itemId": "find",
             "vtype": "alphanum",
             "fieldLabel": "查找",
             "x": "8",
             "width": "216",
             "y": "8",
             "isUpperCase": "true",
             "labelWidth": "40",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "text",
            "events": {"specialkey": "if (e.keyCode == 13) {\
  var pnl = app.tabCntr.getActiveTab();\
  pnl.cntrInfo = {\
    CNTR: '',\
    CNTR_SIZE: '',\
    TO_POS: '',\
    YARD_POSITION: '',\
    RELEASE_ID: '',\
    IN_CAR: '',\
    PLAT_NO: '',\
    E_F_ID: '',\
    I_E_ID: '',\
    CMDY_CODE: '',\
    CNTR_OPERATOR: ''\
\
  };\
  Wb.setValue(pnl, pnl.cntrInfo);\
  app.truck.setValue('');\
  app.plate.setValue('');\
  Wb.request({\
    url: 'm?xwl=controlManage/task/worktaskcraneedit/cntrInfo',\
    params: {\
      find: text.getValue().trim()\
    },\
    success: function(resp) {\
      var rows = JSON.parse(resp.responseText);\
      if (rows.length === 0) {\
        Wb.error('找不到箱信息');\
      } else if (rows.length > 1) {\
        app.selCntrWin.target = pnl;\
        app.selCntrWin.data = rows;\
        app.selCntrWin.show();\
      } else if (pnl === app.panelCntr2 && rows[0].CNTR_SIZE > 20)\
        Wb.error('孖柜不能有40尺柜');\
      else {\
        pnl.cntrInfo = rows[0];\
        Wb.setValue(pnl, pnl.cntrInfo);\
        app.truck.setValue(pnl.cntrInfo.IN_CAR);\
        app.plate.setValue(pnl.cntrInfo.PLAT_NO);\
      }\
    }\
  });\
}"}
           },
           {
            "configs": {
             "itemId": "btnPrint",
             "x": "80",
             "width": "70",
             "y": "40",
             "text": "打印放行条",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "var pnl = app.tabCntr.getActiveTab();\
var id = pnl.cntrInfo && pnl.cntrInfo.HANDLE_ID;\
if (!id)\
  return Wb.error(\"此箱无待作业任务\");\
var whereSql = encodeURI(\" and r.tenancy_id='{#sys.TENANCY_ID#}' and r.id='\" + id + \"'\");\
var AF1;\
if (pnl.cntrInfo.E_F_ID == 'E') {\
  var AF1 = document.getElementById(opt);\
  if (pnl.cntrInfo.TO_POS_TYP === 'B') {\
    var pos = pnl.cntrInfo.TO_POS || '';\
    var cfsCod = Wb.yardCfsMap[pos.substr(0, 2)] || 'JGQ';\
    if (cfsCod == \"NMQ\")\
      AF1.func(\"SetCellData\", \"<data B4='出口拼柜仓' B18='出口拼柜仓' B33='出口拼柜仓' B47='出口拼柜仓'/>\");\
    if (cfsCod == \"LN\")\
      AF1.func(\"SetCellData\", \"<data B4='路南' B18='路南' B33='路南' B47='路南'/>\");\
    if (cfsCod == \"JGQ\")\
      AF1.func(\"SetCellData\", \"<data B4='监管区' B18='监管区' B33='监管区' B47='监管区'/>\");\
  }\
} else\
  var AF1 = document.getElementById(opt1);\
\
AF1.func(\"SetParas\", \"ds1 \\r\\
 para=1;whereSql=\" + whereSql + \";drr=\" + new Date().getTime()+\";tenancyId=\"+'{#sys.TENANCY_ID#}');\
AF1.func(\"Calc\", \"\");\
AF1.func(\"callfunc\", \"18\");"}
           },
           {
            "configs": {
             "itemId": "btnWrite",
             "x": "152",
             "width": "70",
             "y": "40",
             "text": "写IC卡",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "var pnl = button.getRefOwner();\
var find = pnl.queryById(\"find\");\
if (!find.getValue()) {\
  app.card.writeCardWin.HANDLE_ID = '';\
  app.card.writeCardWin.show();\
  Wb.setValue(app.card.writeCardWin, {\
    type: 'KC',\
    plate: ''\
  });\
  return;\
}\
pnl = app.tabCntr.getActiveTab();\
var id = pnl.cntrInfo && pnl.cntrInfo.MID;\
if (!id)\
  return Wb.error(\"此箱无作业任务\");\
/*if (pnl.cntrInfo.RELEASE_ID == '未放行')\
  return Wb.error(\"海关未放行\");*/\
\
app.card.writeCardWin.HANDLE_ID = id;\
app.card.writeCardWin.show();"}
           },
           {
            "configs": {
             "itemId": "btnInGate",
             "x": "8",
             "width": "70",
             "y": "40",
             "text": "进口提柜",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "/*var taskType = pnl.cntrInfo && pnl.cntrInfo.TASK_TYPE;\
if(taskType != 'GOUT')\
  return Wb.error(\"请先选择提箱任务\");*/\
var truck = app.truck.getValue();\
if (!truck)\
  return Wb.error(\"提箱拖车号不能为空\", function() {\
    app.truck.focus();\
  });\
var ids = [];\
var cfs;\
var pnl = app.panelCntr1;\
var id = pnl.cntrInfo && pnl.cntrInfo.RID;\
if (id) {\
  ids.push(id);\
  var pos = pnl.cntrInfo.YARD_POSITION || '';\
  cfs = Wb.yardCfsMap[pos.substr(0, 2)] || 'JGQ';\
}\
pnl = app.panelCntr2;\
var id = pnl.cntrInfo && pnl.cntrInfo.RID;\
if (id) {\
  var pos = pnl.cntrInfo.YARD_POSITION || '';\
  var cfs2 = Wb.yardCfsMap[pos.substr(0, 2)] || 'JGQ';\
  if (cfs2 !== cfs)\
    return Wb.error(\"双箱所在闸区不一致\");\
  ids.push(id);\
}\
if (ids.length === 0)\
  return Wb.error(\"无待入闸设备交接单\");\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/inGate\",\
  params: Wb.apply({\
    ids: ids,\
    cfs: cfs,\
    truck: truck\
  }),\
  success: function(resp) {\
    var result = Wb.decode(resp.responseText);\
    if (result.success) {\
      Wb.info('办理成功', function() {\
        var find = app.tabCntr.getRefOwner().queryById('find');\
        find.fireEvent('specialkey', find, {\
          keyCode: 13\
        });\
      });\
    } else\
      Wb.error(result.errstr);\
  }\
});"}
           },
           {
            "configs": {
             "itemId": "tabCntr",
             "x": "0",
             "width": "232",
             "y": "72",
             "height": "304"
            },
            "expanded": false,
            "children": [
             {
              "configs": {
               "layout": "absolute",
               "itemId": "panelCntr1",
               "width": "232",
               "title": " 柜信息1",
               "height": "296"
              },
              "expanded": false,
              "children": [
               {
                "configs": {
                 "itemId": "DETAIL",
                 "x": "16",
                 "width": "88",
                 "y": "232",
                 "text": "详细信息",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "button",
                "events": {"click": "var pnl = button.getRefOwner();\
var id = pnl.cntrInfo && pnl.cntrInfo.CNTR_ID;\
if(!id)\
  return Wb.error(\"请先查询箱\");\
Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: id\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
    wins.show();\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "CNTR",
                 "fieldLabel": "箱号",
                 "x": "8",
                 "width": "216",
                 "y": "8",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text",
                "events": {"change": "var canModify = false;\
var pnl = text.getRefOwner();\
if (pnl.cntrInfo && pnl.cntrInfo.MID && !Ext.Array.contains(['GOUT','VOUT'],pnl.cntrInfo.TASK_TYPE))\
  canModify = true;\
\
if (canModify)\
  pnl.down(\"#MODIFY_POS\").enable();\
else\
  pnl.down(\"#MODIFY_POS\").disable();\
pnl.down('#TO_POS').setReadOnly(!canModify);"}
               },
               {
                "configs": {
                 "itemId": "CNTR_SIZE",
                 "fieldLabel": "尺寸",
                 "x": "8",
                 "width": "80",
                 "y": "32",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "YARD_POSITION",
                 "fieldLabel": "场位",
                 "x": "8",
                 "width": "216",
                 "y": "56",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "TO_POS",
                 "fieldLabel": "目标",
                 "x": "8",
                 "width": "150",
                 "y": "80",
                 "isUpperCase": "true",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "MODIFY_POS",
                 "x": "164",
                 "width": "60",
                 "y": "80",
                 "disabled": "true",
                 "text": "修改",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "button",
                "events": {"click": "var pnl = button.getRefOwner();\
var id = pnl.cntrInfo && pnl.cntrInfo.CNTR_ID;\
if(!id)\
  return Wb.error(\"请先查询箱\");\
var param = {\
  to_pos: pnl.down(\"#TO_POS\").getValue(),\
  moves: [pnl.cntrInfo.MID],\
  ship: pnl.cntrInfo.CARRIER_CALL,\
  type: pnl.cntrInfo.TASK_TYPE,\
  taskId: pnl.cntrInfo.TID\
};\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/modifyToPos\",\
  params: param,\
  success: function() {\
    Wb.info(\"修改成功\");\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "RELEASE_ID",
                 "fieldLabel": "放行",
                 "x": "8",
                 "width": "216",
                 "y": "104",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "E_F_ID",
                 "fieldLabel": "吉重",
                 "x": "8",
                 "width": "216",
                 "keyName": "E_F_ID",
                 "y": "128",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "combo"
               },
               {
                "configs": {
                 "itemId": "moveReq",
                 "x": "120",
                 "width": "88",
                 "y": "232",
                 "text": "移箱申请",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "button",
                "events": {"click": "var pnl = button.getRefOwner();\
var id = pnl.cntrInfo && pnl.cntrInfo.CNTR_ID;\
if (!id)\
  return Wb.error(\"请先查询箱\");\
Wb.setValue(app.movReqWin, {\
  cntr: pnl.cntrInfo.CNTR,\
  pos: pnl.cntrInfo.YARD_POSITION,\
  cntr_id: id\
});\
app.movReqWin.show();"}
               },
               {
                "configs": {
                 "itemId": "I_E_ID",
                 "fieldLabel": "进出",
                 "x": "8",
                 "width": "216",
                 "keyName": "I_E_ID",
                 "y": "152",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "combo"
               },
               {
                "configs": {
                 "itemId": "CNTR_OPERATOR",
                 "fieldLabel": "驳船",
                 "x": "8",
                 "width": "216",
                 "y": "176",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "CMDY_CODE",
                 "fieldLabel": "货名",
                 "x": "8",
                 "width": "216",
                 "y": "200",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "CNTR_TYPE",
                 "fieldLabel": "类型",
                 "x": "88",
                 "width": "136",
                 "keyName": "CNTR_TYPE",
                 "y": "32",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "combo"
               }
              ],
              "type": "panel"
             },
             {
              "configs": {
               "layout": "absolute",
               "itemId": "panelCntr2",
               "width": "232",
               "title": "柜信息2",
               "height": "296"
              },
              "expanded": true,
              "children": [
               {
                "configs": {
                 "itemId": "DETAIL",
                 "x": "16",
                 "width": "88",
                 "y": "232",
                 "text": "详细信息",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "button",
                "events": {"click": "var pnl = button.getRefOwner();\
var id = pnl.cntrInfo && pnl.cntrInfo.CNTR_ID;\
if(!id)\
  return Wb.error(\"请先查询箱\");\
Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: id\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
    wins.show();\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "CNTR",
                 "fieldLabel": "箱号",
                 "x": "8",
                 "width": "216",
                 "y": "8",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "CNTR_SIZE",
                 "fieldLabel": "尺寸",
                 "x": "8",
                 "width": "216",
                 "y": "32",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "YARD_POSITION",
                 "fieldLabel": "场位",
                 "x": "8",
                 "width": "216",
                 "y": "56",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "TO_POS",
                 "fieldLabel": "目标",
                 "x": "8",
                 "width": "150",
                 "y": "80",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text",
                "events": {"change": "var canModify = false;\
var pnl = text.getRefOwner();\
if (pnl.cntrInfo && pnl.cntrInfo.MID && !Ext.Array.contains(['GOUT','VOUT'],pnl.cntrInfo.TASK_TYPE))\
  canModify = true;\
\
if (canModify)\
  pnl.down(\"#MODIFY_POS\").enable();\
else\
  pnl.down(\"#MODIFY_POS\").disable();\
text.setReadOnly(!canModify);"}
               },
               {
                "configs": {
                 "itemId": "MODIFY_POS",
                 "x": "164",
                 "width": "60",
                 "y": "80",
                 "disabled": "true",
                 "text": "修改",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "button",
                "events": {"click": "var pnl = button.getRefOwner();\
var id = pnl.cntrInfo && pnl.cntrInfo.CNTR_ID;\
if(!id)\
  return Wb.error(\"请先查询箱\");\
var param = {\
  to_pos: pnl.down(\"#TO_POS\").getValue(),\
  moves: [pnl.cntrInfo.MID],\
  ship: pnl.cntrInfo.CARRIER_CALL,\
  type: pnl.cntrInfo.TASK_TYPE,\
  taskId: pnl.cntrInfo.TID\
};\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/modifyToPos\",\
  params: param,\
  success: function() {\
    Wb.info(\"修改成功\");\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "RELEASE_ID",
                 "fieldLabel": "放行",
                 "x": "8",
                 "width": "216",
                 "y": "104",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "E_F_ID",
                 "fieldLabel": "吉重",
                 "x": "8",
                 "width": "216",
                 "keyName": "E_F_ID",
                 "y": "128",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "combo"
               },
               {
                "configs": {
                 "itemId": "moveReq",
                 "x": "128",
                 "width": "88",
                 "y": "232",
                 "text": "移箱申请",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "button",
                "events": {"click": "var pnl = button.getRefOwner();\
var id = pnl.cntrInfo && pnl.cntrInfo.CNTR_ID;\
if(!id)\
  return Wb.error(\"请先查询箱\");\
var pnl = button.getRefOwner();\
var id = pnl.cntrInfo && pnl.cntrInfo.CNTR_ID;\
if(!id)\
  return Wb.error(\"请先查询箱\");\
Wb.setValue(app.movReqWin,{cntr:pnl.cntrInfo.CNTR,pos:pnl.cntrInfo.YARD_POSITION});\
app.movReqWin.show();"}
               },
               {
                "configs": {
                 "itemId": "I_E_ID",
                 "fieldLabel": "进出",
                 "x": "8",
                 "width": "216",
                 "keyName": "I_E_ID",
                 "y": "152",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "combo"
               },
               {
                "configs": {
                 "itemId": "CNTR_OPERATOR",
                 "fieldLabel": "驳船",
                 "x": "8",
                 "width": "216",
                 "y": "176",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "CMDY_CODE",
                 "fieldLabel": "货名",
                 "x": "8",
                 "width": "216",
                 "y": "200",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "text"
               },
               {
                "configs": {
                 "itemId": "CNTR_TYPE",
                 "fieldLabel": "类型",
                 "x": "88",
                 "width": "136",
                 "keyName": "CNTR_TYPE",
                 "y": "32",
                 "labelWidth": "40",
                 "readOnly": "true",
                 "height": "22"
                },
                "expanded": false,
                "children": [],
                "type": "combo"
               }
              ],
              "type": "panel"
             }
            ],
            "type": "tab",
            "events": {"tabchange": "if (newCard == app.panelCntr2) {\
  var pnl = app.panelCntr1;\
  if (!(pnl.cntrInfo && pnl.cntrInfo.CNTR))\
    tab.setActiveTab(app.panelCntr1);\
  else if (pnl.cntrInfo.CNTR_SIZE > 20)\
    tab.setActiveTab(app.panelCntr1);\
  else\
    Wb.confirm('确实要进行提孖柜操作?', [function(){}, function() {\
      tab.setActiveTab(app.panelCntr1);\
    }]);\
}"}
           },
           {
            "configs": {
             "isUpperCase": "true",
             "labelWidth": "40",
             "valueField": "TRUCK_NO",
             "queryDelay": "100",
             "itemId": "truck",
             "labelAlign": "right",
             "fieldLabel": "车头",
             "x": "0",
             "width": "224",
             "displayField": "TRUCK_NO",
             "y": "387",
             "forceSelection": "true",
             "height": "22"
            },
            "expanded": false,
            "children": [{
             "configs": {
              "itemId": "store",
              "autoLoad": "true",
              "pageSize": "-1",
              "url": "m?xwl=receiptInout/gate/gateinedit/selectV_CAR"
             },
             "expanded": false,
             "children": [],
             "type": "store"
            }],
            "type": "combo",
            "events": {"change": "var r = combo.store.findRecord('TRUCK_NO', newValue);\
if (r)\
  app.plate.setValue(r.data.PLAT_NO);"}
           },
           {
            "configs": {
             "itemId": "plate",
             "labelAlign": "right",
             "fieldLabel": "车牌",
             "x": "0",
             "width": "224",
             "y": "410",
             "isUpperCase": "true",
             "labelWidth": "40",
             "readOnly": "true",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "text"
           }
          ],
          "type": "panel"
         },
         {
          "configs": {
           "layout": "fit",
           "itemId": "panelNote",
           "title": "便签",
           "region": "south",
           "collapsible": "true",
           "height": "150"
          },
          "expanded": true,
          "children": [{
           "configs": {"itemId": "textarea1"},
           "expanded": false,
           "children": [],
           "type": "textarea",
           "events": {
            "afterrender": "if(localStorage && localStorage[\"taskDemo_{#sys.username#}\"])\
  textarea.setValue(localStorage[\"taskDemo_{#sys.username#}\"]);",
            "blur": "if(localStorage)\
  localStorage[\"taskDemo_{#sys.username#}\"] = textarea.getValue();"
           }
          }],
          "type": "panel"
         }
        ],
        "type": "panel"
       },
       {
        "configs": {
         "layout": "border",
         "itemId": "panelRight",
         "region": "center"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "layout": "border",
           "itemId": "panel1",
           "split": "true",
           "region": "north",
           "height": "200"
          },
          "expanded": true,
          "children": [
           {
            "configs": {
             "itemId": "treeTask",
             "root": "{\
  text: '作业任务'\
}",
             "viewConfig": "{\
\t 'itemcontextmenu':function(view,record,item,index,e,eOpts){  \
\t                     //禁用浏览器的右键相应事件  \
\t                    e.preventDefault();  \
                         e.stopEvent();  \
     }\
}",
             "region": "center",
             "tools": "Wb.getTreeTools()"
            },
            "expanded": true,
            "children": [
             {
              "configs": {"itemId": "tbar"},
              "expanded": false,
              "children": [
               {
                "configs": {
                 "itemId": "date",
                 "width": "100"
                },
                "expanded": false,
                "children": [],
                "type": "date",
                "events": {
                 "afterrender": "date.setValue(new Date());",
                 "change": "app.treeTask.store.reload();"
                }
               },
               {
                "configs": {
                 "itemId": "trade",
                 "width": "60",
                 "keyName": "TRADE_ID",
                 "value": "12",
                 "forceSelection": "true"
                },
                "expanded": false,
                "children": [],
                "type": "combo",
                "events": {"change": "app.treeTask.store.reload();"}
               },
               {
                "configs": {
                 "itemId": "button1",
                 "toggleHandler": "app.showFinTask = state;\
if (app.taskType == 'GIN' || app.taskType == 'GOUT' || app.taskType == 'MOVE')\
  app.moveGrid.store.load({\
    params: {\
      QUEUE_ID: app.taskId,\
      task_type: app.taskType,\
      showFin: app.showFinTask\
    }\
  });",
                 "text": "显示完成",
                 "iconCls": "check_icon",
                 "enableToggle": "true"
                },
                "expanded": true,
                "children": [],
                "type": "button"
               }
              ],
              "type": "toolbar"
             },
             {
              "configs": {
               "itemId": "store",
               "url": "m?xwl=controlManage/task/worktaskcraneedit/loadTask"
              },
              "expanded": false,
              "children": [],
              "type": "treestore",
              "events": {"beforeload": "Wb.apply(operation.params, Wb.getValue(app.treeTask.down('toolbar')));"}
             },
             {
              "configs": {
               "itemId": "popupMenu",
               "normalName": "menu1"
              },
              "expanded": false,
              "children": [
               {
                "configs": {
                 "itemId": "disBtn",
                 "tooltip": "派工",
                 "text": "派工",
                 "iconCls": "slider_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "app.dispatchWin.show();\
// app.disWin.show();\
"}
               },
               {
                "configs": {
                 "itemId": "sendBtn",
                 "tooltip": "发送",
                 "text": "发送",
                 "iconCls": "flag1_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "if (app.taskType == 'VOUT') //装船替换掉小伟的逻辑\
{\
  console.log(app.taskType);\
  Wb.request({\
    url: 'm?xwl=controlManage/task/worktaskcraneedit/sendIns',\
    params: {\
      tskid: app.taskId,\
      ship: app.treeTask.getSelection()[0].raw.ship,\
      type: app.taskType\
    },\
    success: function(resp) {\
      Wb.info(resp.responseText);\
    }\
  });\
  return;\
}\
else{\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/instSplit',\
  params: {\
    id: app.taskId,\
    type: app.taskType\
  },\
  success: function(resp) {\
    Wb.info(resp.responseText);\
  }\
});\
}"}
               },
               {
                "configs": {
                 "itemId": "finBtn",
                 "tooltip": "任务完成确认",
                 "text": "完成确认",
                 "iconCls": "check_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/finishTask\",\
  params: {\
    id: app.taskId,\
    taskType:app.sels[0].raw.type\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "ediBtn",
                 "hidden": "true",
                 "tooltip": "EDI发送",
                 "text": "EDI发送",
                 "iconCls": "connect_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/EdiSendTask\",\
  params: {\
    id: app.taskId,\
    taskType:app.sels[0].raw.type\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "delBtn",
                 "tooltip": "删除任务",
                 "disabled": "true",
                 "text": "删除任务",
                 "iconCls": "file_delete_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "Wb.confirm(\"只能删除计划状态的任务，是否要删除当前任务？\", function() {\
  Wb.request({\
    url: \"m?xwl=controlManage/task/worktaskcraneedit/deleteTask\",\
    params: {\
      id: app.taskId\
    }\
  });\
});"}
               },
               {
                "configs": {
                 "itemId": "cancelBtn",
                 "tooltip": "取消发送",
                 "text": "取消发送",
                 "iconCls": "undo_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/delInstSplit',\
  params: {\
    taskId: app.sels[0].data.id,\
    ship: app.sels[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id\
  },\
  success: function(resp) {\
    Wb.info(\"成功\"); //resp.responseText);\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "exceptionBtn",
                 "tooltip": "异常箱登记",
                 "text": "异常箱登记",
                 "iconCls": "box-exclamation_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "app.exptWin.show();"}
               },
               {
                "configs": {
                 "itemId": "exceptViewBtn",
                 "tooltip": "查看异常箱",
                 "text": "查看异常箱",
                 "iconCls": "box-exclamation_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "var s = app.treeTask.getSelection()[0];\
Wb.setValue(app.exptViewWin, s.raw);\
app.exptViewWin.show();"}
               },
               {
                "configs": {
                 "itemId": "exceptDelBtn",
                 "tooltip": "删除异常箱",
                 "text": "删除异常箱",
                 "iconCls": "box-exclamation_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "Wb.confirm(\"删除后图片将无法找回，是否要删除当前异常信息？\", function() {\
  Wb.request({\
    url: \"m?xwl=controlManage/task/worktaskcraneedit/deleteExceptImage\",\
    params: {\
      id: app.taskId\
    }\
  });\
});"}
               },
               {
                "configs": {
                 "itemId": "batchUnloadBtn",
                 "tooltip": "批量吉柜卸船",
                 "text": "批量吉柜卸船",
                 "iconCls": "flag1_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/batchUnload',\
  params: {\
    id: app.taskId\
  },\
  success: function(resp) {\
    Wb.info(resp.responseText);\
  }\
});"}
               },
               {
                "configs": {
                 "itemId": "batchLoadBtn",
                 "tooltip": "批量吉柜装船",
                 "text": "批量吉柜装船",
                 "iconCls": "flag1_icon"
                },
                "expanded": false,
                "children": [],
                "type": "item",
                "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/batchLoad',\
  params: {\
    id: app.taskId\
  },\
  success: function(resp) {\
    Wb.info(resp.responseText);\
  }\
});"}
               }
              ],
              "type": "menu",
              "events": {"show": "var rows = app.treeTask.getSelection();\
app.sels = rows;\
if (!(rows && rows[0])) {\
  menu.hide();\
  return;\
}\
\
var sel = rows[0];\
var isLeaf = sel.isLeaf();\
if (isLeaf) {\
  if (app.taskType === 'VIN') {\
    menu.down(\"#exceptionBtn\").show();\
    menu.down(\"#batchUnloadBtn\").show();\
  } else {\
    menu.down(\"#exceptionBtn\").hide();\
    menu.down(\"#batchUnloadBtn\").hide();\
  }\
  if (app.taskType === 'VOUT')\
    menu.down(\"#batchLoadBtn\").show();\
  else\
    menu.down(\"#batchLoadBtn\").hide();\
//   if (app.taskType === 'VIN' || app.taskType === 'VOUT')\
//     menu.down(\"#ediBtn\").hide();\
//   else\
//     menu.down(\"#ediBtn\").hide();\
\
\
  if (app.taskType === 'EXCEPT') {\
    menu.down(\"#exceptViewBtn\").show();\
    menu.down(\"#exceptDelBtn\").show();\
    menu.down(\"#disBtn\").hide();\
    menu.down(\"#sendBtn\").hide();\
    menu.down(\"#delBtn\").hide();\
    menu.down(\"#finBtn\").hide();\
    menu.down(\"#cancelBtn\").hide();\
  } else {\
    menu.down(\"#disBtn\").show();\
    menu.down(\"#sendBtn\").show();\
    menu.down(\"#delBtn\").show();\
    menu.down(\"#finBtn\").show();\
    menu.down(\"#cancelBtn\").show();\
    menu.down(\"#exceptViewBtn\").hide();\
    menu.down(\"#exceptDelBtn\").hide();\
  }\
} else {\
  menu.hide();\
}"}
             }
            ],
            "type": "tree",
            "events": {
             "selectionchange": "var record = selected[0];\
if (!record)\
  return;\
app.taskId = record.data.id;\
if (!record.raw.leaf)\
  return;\
if (!app.taskId)\
  return;\
if (app.lastSubKey)\
  app.xwl1.unsubscribe(app.lastSubKey);\
app.taskType = record.parentNode.data.id;\
switch (app.taskType) {\
  case 'GOUT':\
  case 'GIN':\
    app.lastSubKey = '/exchange/ex_instruction/gate.#';\
    break;\
  case 'VIN':\
  case 'VOUT':\
    app.lastSubKey = '/exchange/ex_instruction/ship.' + record.raw.ship;\
    break;\
  case 'MOVE':\
    app.lastSubKey = '/exchange/ex_instruction/cy.#';\
    break;\
}\
app.xwl1.subscribe(app.lastSubKey, function(d) {\
  var msg = d.body;\
  //console.log(msg);\
  var record = app.moveGrid.store.data.findBy(function(r, k) {\
    return r.data.ID === msg.data.id;\
  });\
  switch (msg.info.action) {\
    case 'create':\
    case 'update':\
    case 'confirm':\
      Wb.request({\
        url: \"m?xwl=controlManage/task/worktaskcraneedit/moveListMsg\",\
        params: Wb.apply(msg.data, {\
          taskType: app.taskType,\
          taskId: app.taskId\
        }),\
        success: function(res) {\
          data = Wb.decode(res.responseText);\
          if (!record) {\
            Wb.add(app.moveGrid, data.rows);\
            newMoveCount = app.moveGrid.store.getCount();\
            setHeight();\
          } else\
            Wb.update(record, data.rows[0]);\
        }\
      });\
      break;\
    case 'delete':\
      if (record) {\
        Wb.remove(app.moveGrid, [record]);\
      }\
      break;\
    case 'batch':\
      if (app.taskId === msg.data.id)\
        app.moveGrid.store.reload();\
      break;\
    default:\
      console.log(msg);\
      break;\
  }\
  app.chart1.store.reload();\
});\
\
var oldMoveCount = app.moveGrid.store.getCount();\
var oldMovebCount = app.moveGridb.store.getCount();\
var newMoveCount = -1;\
var newMovebCount = -1;\
\
function setHeight() {\
  if (newMoveCount < 0 || newMovebCount < 0)\
    return;\
  var b = app.moveListPanel.getBox();\
  if (newMoveCount) {\
    app.moveListPanel.expand(false);\
  } else\
    app.moveListPanel.collapse(false);\
\
  if (newMovebCount) {\
    if (newMoveCount)\
      app.moveListbPanel.setHeight((window.innerHeight - b.top) / 2);\
    else\
      app.moveListbPanel.setHeight(window.innerHeight - b.top - 24);\
    app.moveListbPanel.expand(false);\
  } else\
    app.moveListbPanel.collapse(false);\
\
}\
app.moveGrid.store.load({\
  params: {\
    QUEUE_ID: app.taskId,\
    task_type: app.taskType,\
    showFin: app.showFinTask\
  },\
  callback: function() {\
    newMoveCount = app.moveGrid.store.getCount();\
    setHeight();\
  }\
});\
app.moveGridb.store.load({\
  params: {\
    QUEUE_ID: app.taskId\
  },\
  callback: function() {\
    newMovebCount = app.moveGridb.store.getCount();\
    setHeight();\
  }\
});\
app.chart1.store.load({\
  params: {\
    QUEUE_ID: app.taskId\
  }\
});",
             "load": "if (app.taskId) {\
  var rec = app.treeTask.getRootNode().findChildBy(function(n) {\
    return n.data.id === app.taskId;\
  }, null, 2);\
  if (rec) {\
    rec.parentNode.expand();\
    app.treeTask.selModel.select(rec);\
  }\
}",
             "afterrender": "app.xwl1.subscribe(\"/exchange/ex_task/#\", function(d) {\
  var msg = d.body;\
  var root = tree.store.getRootNode();\
  var node = root.findChild('id', msg.data.id, 2);\
  switch (msg.info.action) {\
    case 'create':\
    case 'update':\
      Wb.request({\
        url: \"m?xwl=controlManage/task/worktaskcraneedit/taskMsg\",\
        params: Wb.apply(msg.data, Wb.getValue(app.treeTask.down('toolbar'))),\
        success: function(res) {\
          var data = Wb.decode(res.responseText);\
          if (data.rows.length > 0) {\
            var row = data.rows[0];\
            if (!node) {\
              var p = root.findChild('id', row.type);\
              p.appendChild(p.createNode(row));\
            } else\
              node.updateInfo(true,row);\
          }\
        }\
      });\
      break;\
    case 'delete':\
      if (node)\
        node.remove();\
      break;\
  }\
  //app.treeTask.store.reload();\
});"
            }
           },
           {
            "configs": {
             "layout": "fit",
             "itemId": "panel1",
             "split": "true",
             "width": "480",
             "region": "east",
             "height": "320"
            },
            "expanded": false,
            "children": [{
             "configs": {"itemId": "chart1"},
             "expanded": true,
             "children": [
              {
               "configs": {
                "itemId": "store",
                "url": "m?xwl=controlManage/task/worktaskcraneedit/loadTaskChart"
               },
               "expanded": false,
               "children": [],
               "type": "store"
              },
              {
               "configs": {"itemId": "axes"},
               "expanded": true,
               "children": [
                {
                 "configs": {
                  "itemId": "leftAxis",
                  "position": "left",
                  "type": "numeric"
                 },
                 "expanded": true,
                 "children": [],
                 "type": "axis"
                },
                {
                 "configs": {
                  "itemId": "bottomAxis",
                  "position": "bottom",
                  "label": "{\
  renderer: function(value) {\
    if (app.taskType == 'VIN' || app.taskType == 'VOUT') {\
      var r = app.chart1.store.findRecord('CAT', value);\
      if (r && (r.data.NUM || r.data.VNUM))\
        value += '\\r\\
' + (r.data.NUM || 0) + '&' + (r.data.VNUM || 0);\
    }\
    return value;\
  }\
}",
                  "type": "category",
                  "fields": "CAT"
                 },
                 "expanded": true,
                 "children": [],
                 "type": "axis"
                }
               ],
               "type": "array"
              },
              {
               "configs": {"itemId": "series"},
               "expanded": true,
               "children": [{
                "configs": {
                 "itemId": "plan",
                 "renderer": "var yField = this.items[index].yField;\
var color = app.TASK_STATE && app.TASK_STATE[yField] || '#bbbbbb';\
return Wb.apply(attributes, {\
  fill: color\
});",
                 "xField": "name",
                 "stacked": "true",
                 "yField": "['PLN','SND','TMP','EXE','FIN']",
                 "axis": "left",
                 "type": "column",
                 "tips": "{\
  trackMouse: true,\
  renderer: function(record, item) {\
    var tip = \"尺码类型:\" + record.data.CAT;\
    for (var k in record.data) {\
      var name = '';\
      switch (k) {\
        case 'PLN':\
          name = '计划状态:';\
          break;\
        case 'SND':\
          name = '发送状态:';\
          break;\
        case 'TMP':\
          name = '暂存状态:';\
          break;\
        case 'EXE':\
          name = '执行状态:';\
          break;\
        case 'FIN':\
          name = '完成状态:';\
          break;\
        case 'NUM':\
          name = '任务总量:';\
          break;\
        case 'VNUM':\
          name = '舱单数量:';\
          break;\
      }\
      if (name && record.data[k] || k == 'VNUM')\
        tip += \"<br><br>\" + name + record.data[k];\
    }\
    this.update(tip);\
  }\
}"
                },
                "expanded": true,
                "children": [{
                 "configs": {
                  "itemId": "label",
                  "padding": "20",
                  "createInstance": "false",
                  "field": "['PLN','SND','TMP','EXE','FIN','CNL']",
                  "color": "black",
                  "display": "insideEnd"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "chartlabel"
                }],
                "type": "series",
                "events": {"itemdblclick": "var phase = item.yField;\
var cat = item.storeItem.data.CAT;\
var records = app.moveGrid.store.queryBy(function(r) {\
  return r.data.PHASE === phase && cat === (r.data.CNTR_SIZE + (r.data.E_F_ID == 'E' ? '尺吉' : '尺重'));\
});\
app.moveGrid.selModel.select(records.items);"}
               }],
               "type": "array"
              }
             ],
             "type": "chart",
             "events": {"refresh": "if (app.taskType == 'VOUT' || app.taskType == 'VIN')\
  chart.store.each(function(r) {\
    if (r.data.NUM != r.data.VNUM) {\
      t = app.chart1.el.down('text[text^=' + r.data.CAT + ']');\
      if (t)\
        t.dom.setAttribute('fill', 'red');\
    }\
  });"}
            }],
            "type": "panel"
           }
          ],
          "type": "panel"
         },
         {
          "configs": {
           "layout": "fit",
           "itemId": "moveListPanel",
           "collapsed": "true",
           "region": "center",
           "collapsible": "true"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "moveGrid",
            "multiColumnSort": "true",
            "editable": "true",
            "tbar": "app.tbarMove",
            "disabled": "false",
            "viewConfig": "{\
\t 'itemcontextmenu':function(view,record,item,index,e,eOpts){  \
\t                     //禁用浏览器的右键相应事件  \
\t                    e.preventDefault();  \
                         e.stopEvent();  \
     }\
}",
            "multiSelect": "true"
           },
           "expanded": true,
           "children": [
            {
             "configs": {
              "sortOnLoad": "true",
              "itemId": "store",
              "pageSize": "1000",
              "url": "m?xwl=controlManage/task/worktaskcraneedit/moveListSelect"
             },
             "expanded": false,
             "children": [],
             "type": "store"
            },
            {
             "configs": {"itemId": "columns"},
             "expanded": true,
             "children": [
              {
               "configs": {
                "itemId": "column1",
                "renderer": "if (app.taskType == 'VOUT' || app.taskType == 'VIN') {\
  if (record.data.IV == 0)\
    metaData.style = 'background-color:red;';\
  else if (record.data.CNUM > 1)\
    metaData.style = 'background-color:yellow;';\
}\
return rowIndex + 1;",
                "xtype": "rownumberer"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "PHASE",
                "renderer": "var map = {\
  PLN: '计划',\
  SND: '发送',\
  CNL: '撤销',\
  EXE: '执行',\
  TMP: '暂存',\
  FIN: '完成'\
};\
var color = app.TASK_STATE && app.TASK_STATE[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return map[value] || value;",
                "dataIndex": "PHASE",
                "width": "40",
                "text": "状态",
                "align": "center"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR99",
                "renderer": "if (record.data.PRIORITY == 2)\
  metaData.style = 'background-color:red;';\
return value;",
                "dataIndex": "CNTR",
                "width": "90",
                "text": "箱号"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "C_CNTR_SIZ",
                "dataIndex": "CNTR_SIZE",
                "width": "40",
                "text": "尺寸"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "C_CNTR_TYP99",
                "dataIndex": "CNTR_TYPE",
                "width": "40",
                "keyName": "CNTR_TYPE",
                "text": "类型"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_POS",
                "dataIndex": "FROM_POS",
                "width": "65",
                "text": "起点"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_POS",
                "dataIndex": "TO_POS",
                "width": "65",
                "text": "终点"
               },
               "expanded": true,
               "children": [{
                "configs": {
                 "itemId": "editor",
                 "isUpperCase": "true"
                },
                "expanded": false,
                "children": [],
                "type": "text",
                "events": {"specialkey": "if (e.keyCode == 13) {\
  var record = app.moveGrid.findPlugin('cellediting').context.record;\
  var param = {\
    to_pos: text.value,\
    moves: [record.raw.ID],\
    ship: record.raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    taskId: app.taskId\
  };\
  Wb.request({\
    url: \"m?xwl=controlManage/task/worktaskcraneedit/modifyToPos\",\
    params: param,\
    success: function() {\
      record.commit();\
    }\
  });\
}"}
               }],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_ON99",
                "dataIndex": "CREATED_ON",
                "text": "创建时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_ON99",
                "dataIndex": "UPDATED_ON",
                "text": "修改时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "BILL_NO",
                "dataIndex": "BILL_NO",
                "text": "提单号码"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CMDY_CODE",
                "dataIndex": "CMDY_CODE",
                "text": "货物名称"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "RELEASE_ID",
                "renderer": "if (top.Wb.yardCfsMap) //过虑不需要显示放行信息的记录\
{\
  if (record.data.TRADE_ID != '1') //内贸\
    return '';\
  if (app.taskType == 'GIN') //入闸\
    return '';\
  if (!(record.data.FROM_POS_TYP == 'V' || record.data.TO_POS_TYP == 'V')) //不是装卸船\
  {\
    var fromCfs = top.Wb.yardCfsMap[record.data.FROM_POS.substr(0, 2)] || 'JGQ';\
    if(app.taskType == 'GOUT' && fromCfs !='JGQ')//非监管区出闸\
      return '';\
    var toCfs = top.Wb.yardCfsMap[record.data.TO_POS.substr(0, 2)] || (record.data.TO_POS_TYP == 'B' ? 'JGQ' : undefined);\
    if (fromCfs == toCfs ||  !(toCfs == 'JGQ' || fromCfs == 'JGQ') || toCfs=='JGQ')\
      return '';\
  }\
}\
var color = value == '1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";\
return value == '1' ? '已放行' : '未放行';",
                "dataIndex": "RELEASE_ID",
                "width": "50",
                "text": "海关"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CARD_WRITE_ID",
                "renderer": "/*var color = value =='1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";*/\
return value =='1' ? '已写卡' : '';",
                "dataIndex": "CARD_WRITE_ID",
                "width": "50",
                "text": "已写卡"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "E_F_ID",
                "renderer": "var color = app.E_F_ID && app.E_F_ID[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return value === 'P' ? '拼柜' : value === 'F' ? '重柜' : '吉柜';",
                "dataIndex": "E_F_ID",
                "width": "40",
                "text": "吉重"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS199",
                "dataIndex": "TRCLASS1",
                "width": "40",
                "text": "机械类型1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1995",
                "dataIndex": "TRANSPORTER1",
                "width": "40",
                "text": "机械1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1991",
                "dataIndex": "TRCLASS2",
                "width": "40",
                "text": "机械类型2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19911",
                "dataIndex": "TRANSPORTER2",
                "width": "40",
                "text": "机载2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1992",
                "dataIndex": "TRCLASS3",
                "width": "40",
                "text": "机械类型3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19921",
                "dataIndex": "TRANSPORTER3",
                "width": "40",
                "text": "机载3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1993",
                "dataIndex": "TRCLASS4",
                "width": "40",
                "text": "机械类型4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19931",
                "dataIndex": "TRANSPORTER4",
                "width": "40",
                "text": "机械4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1994",
                "dataIndex": "TRCLASS5",
                "text": "机械类型5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19941",
                "dataIndex": "TRANSPORTER5",
                "text": "机械5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_YPOINT99",
                "dataIndex": "FROM_YPOINT",
                "text": "起始坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_XPOINT99",
                "dataIndex": "TO_XPOINT",
                "text": "目标坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "ORIGIN99",
                "dataIndex": "CARRIER_CODE",
                "text": "原始位置"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CARRIER_ATA99",
                "dataIndex": "CARRIER_ATA",
                "text": "来的时间"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SAFE_WT99",
                "dataIndex": "SAFE_WT",
                "text": "安全重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SCALE_WT99",
                "dataIndex": "SCALE_WT",
                "text": "过磅重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SERVICE99",
                "dataIndex": "SERVICE",
                "text": "航线"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OPL99",
                "dataIndex": "POL",
                "width": "60",
                "text": "装货港"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OPL991",
                "dataIndex": "POD",
                "width": "60",
                "text": "目的港"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRUCKING_CO99",
                "dataIndex": "TRUCKING_CO",
                "text": "车队"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRANSPORTER199",
                "dataIndex": "TRANSPORTER1",
                "text": "作业机械"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "LINE99",
                "dataIndex": "LINE",
                "width": "120",
                "text": "船公司"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_MAN99",
                "hidden": "true",
                "dataIndex": "CREATED_BY",
                "text": "创建人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_MAN99",
                "hidden": "true",
                "dataIndex": "UPDATED_BY",
                "text": "修改人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_LENGTH99",
                "hidden": "true",
                "dataIndex": "CNTR_LENGTH",
                "text": "长度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_HIGHT99",
                "hidden": "true",
                "dataIndex": "CNTR_HIGHT",
                "text": "高度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OVERHEIGHT99",
                "hidden": "true",
                "dataIndex": "OVERHEIGHT",
                "text": "超重"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "POSITION_STATUS99",
                "dataIndex": "POSITION_STATUS",
                "text": "位置状态"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "notes",
                "dataIndex": "NOTES",
                "text": "备注信息"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              }
             ],
             "type": "array"
            },
            {
             "configs": {
              "itemId": "popupMenu",
              "normalName": "menu1"
             },
             "expanded": false,
             "children": [
              {
               "configs": {
                "itemId": "popupComp",
                "tooltip": "查看在场箱信息",
                "text": "查看在场箱信息",
                "iconCls": "property_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: app.moveGrid.selModel.lastFocused.data.CNTR_ID\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
 // win.setPosition(\"100\",\"400\");\
\
    wins.show();\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "sendBtn",
                "tooltip": "发送",
                "text": "发送",
                "iconCls": "flag1_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "if (app.taskType == 'VOUT') //装船替换掉小伟的逻辑\
{\
  Wb.request({\
    url: 'm?xwl=controlManage/task/worktaskcraneedit/sendIns',\
    params: {\
      tskid: app.taskId,\
      ship: app.treeTask.getSelection()[0].raw.ship,\
      type: app.taskType,\
      moves: app.moveGrid.getSelection().map(function(sel) {\
        return sel.data.ID;\
      })\
    },\
    success: function(resp) {\
      Wb.info(resp.responseText);\
    }\
  });\
  return;\
} else if (app.taskType == 'MOVE') { //移箱逻辑\
  var sel = app.treeTask.getSelection();\
  if (sel.length > 1) {\
    Wb.error('移箱一次只能激活一个！');\
    return;\
  }\
}\
\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/instSplit',\
  params: {\
    id: app.taskId,\
    type: app.taskType,\
    cntrs: app.moveGrid.getSelection().map(function(sel) {\
      return sel.data.CNTR;\
    }),\
    moves: app.moveGrid.getSelection().map(function(sel) {\
      return sel.data.ID;\
    })\
  },\
  success: function(resp) {\
    Wb.info(resp.responseText);\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "cancelBtn",
                "tooltip": "取消发送",
                "text": "取消",
                "iconCls": "undo_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/delInstSplit',\
  params: {\
    taskId: app.taskId,\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    moves: app.moveGrid.getSelection().map(function(sel) {\
      return sel.data.ID;\
    })\
  },\
  success: function(resp) {\
    Wb.info(\"成功\"); //resp.responseText);\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "enableBtn",
                "tooltip": "启用指令",
                "text": "启用",
                "iconCls": "lamp_green_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "// Wb.info(app.menu1.popupComp.itemId); //同一menu可以用于多个控件，popupComp指向使菜单弹出的控件\
//(激活现在就先改下状态)\
var sels = app.moveGrid.getSelection();\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/enableIns',\
  params: {\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    ids: sels.map(function(s){return s.data.ID;}),\
    taskId: app.taskId\
  },\
  success: function(resp) {}\
});"}
              },
              {
               "configs": {
                "itemId": "disableBtn",
                "tooltip": "禁用指令",
                "text": "禁用",
                "iconCls": "lamp_red_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "// Wb.info(app.menu1.popupComp.itemId); //同一menu可以用于多个控件，popupComp指向使菜单弹出的控件\
//(激活现在就先改下状态)\
var sels = app.moveGrid.getSelection();\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/disableIns',\
  params: {\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    ids: sels.map(function(s) {\
      return s.data.ID;\
    }),\
    taskId: app.taskId\
  },\
  success: function(resp) {}\
});"}
              },
              {
               "configs": {
                "itemId": "writeCardBtn",
                "tooltip": "写卡",
                "text": "写卡",
                "iconCls": "book_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "app.card.writeCardWin.HANDLE_ID = app.moveGrid.selModel.lastFocused.data.ID;\
app.card.writeCardWin.show();"}
              },
              {
               "configs": {
                "itemId": "unloadBtn",
                "tooltip": "卸船测试",
                "text": "卸船测试",
                "iconCls": "yellow-freighter_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
Wb.each(sels, function(sel) {\
  Wb.request({\
    url: 'appFun',\
    params: {\
      funId: 'SAVE_UNLOAD',\
      cntr: sel.data.CNTR,\
      ship:app.treeTask.selModel.selected.items[0].raw.ship\
    },\
    success: function(resp) {\
      var ret = Wb.decode(resp.responseText);\
      if (!ret.sucess && ret.errstr)\
        Wb.error(ret.errstr);\
    }\
  });\
});"}
              },
              {
               "configs": {
                "itemId": "loadBtn",
                "tooltip": "装船测试",
                "text": "装船测试",
                "iconCls": "yellow-freighter_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
Wb.each(sels, function(sel) {\
  Wb.request({\
    url: 'appFun',\
    params: {\
      funId: 'SAVE_LOAD',\
      cntr: sel.data.CNTR,\
      ship:app.treeTask.selModel.selected.items[0].raw.ship\
    },\
    success: function(resp) {\
      var ret = Wb.decode(resp.responseText);\
      if (!ret.sucess && ret.errstr)\
        Wb.error(ret.errstr);\
    }\
  });\
});"}
              },
              {
               "configs": {
                "itemId": "modifyCyBtn",
                "tooltip": "指定目标场位",
                "text": "指定目标场位",
                "iconCls": "boxs_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
if (!(sels && sels.length))\
  return;\
var olds = [];\
var moves = [];\
Wb.each(sels, function(r) {\
  if ((r.data.TO_POS_TYP === 'B' || r.data.TO_POS_TYP === 'V' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN') {\
    if (olds.indexOf(r.data.TO_POS)== -1)\
      olds.push(r.data.TO_POS);\
    moves.push(r.data.ID);\
  }\
});\
Wb.setValue(app.toPosWin, {\
  old_pos: olds ? olds.join(',') : '',\
  to_pos: ''\
});\
app.toPosWin.moves = moves;\
app.toPosWin.show();"}
              },
              {
               "configs": {
                "itemId": "popupPrint",
                "tooltip": "放行条",
                "text": "放行条",
                "iconCls": "yellow-orders_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sel = app.moveGrid.getSelection()[0];\
var tenancyid = \"{#sys.TENANCY_ID#}\";\
var whereSql = encodeURI(\" and r.tenancy_id='\" + tenancyid + \"' and r.id='\" + sel.data.HANDLE_ID + \"'\");\
var AF1 = document.getElementById(opt);\
AF1.func(\"SetParas\", \"ds1 \\r\\
 para=1;whereSql=\" + whereSql);\
var cfsCod = Wb.yardCfsMap[sel.data.TO_POS.substr(0, 2)];\
\
if (cfsCod == \"NMQ\") {\
  AF1.func(\"SetCellData\", \"<data B4='出口拼柜仓' B18='出口拼柜仓' B33='出口拼柜仓' B47='出口拼柜仓'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}\
if (cfsCod == \"LN\") {\
  AF1.func(\"SetCellData\", \"<data B4='路南' B18='路南' B33='路南' B47='路南'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}\
\
if (cfsCod == \"JGQ\") {\
  AF1.func(\"SetCellData\", \"<data B4='监管区' B18='监管区' B33='监管区' B47='监管区'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}"}
              },
              {
               "configs": {
                "itemId": "popupTruck",
                "tooltip": "换车",
                "text": "换车",
                "iconCls": "vans_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
if (!(sels && sels.length))\
  return;\
var olds = [];\
var moves = [];\
Wb.each(sels, function(r) {\
  moves.push(r.data.ID);\
  for (var i = 1; i < 5; ++i)\
    if (r.data['TRCLASS' + i] == 'TG') {\
      var truck = r.data['TRANSPORTER' + i];\
      if (!olds.includes(truck))\
        olds.push(truck);\
      break;\
    }\
});\
Wb.setValue(app.truckWin, {\
  old_truck: olds ? olds.join(',') : '',\
  truck: ''\
});\
app.truckWin.moves = moves;\
app.truckWin.show();"}
              },
              {
               "configs": {
                "itemId": "popupLoadBack",
                "tooltip": "退装",
                "text": "退装",
                "iconCls": "yellow-line-conveyor-belt_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "app.loadBackWin.show();\
"}
              },
              {
               "configs": {
                "itemId": "popupRevoke",
                "tooltip": "撤销",
                "text": "撤销",
                "iconCls": "cancel_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/revoke',\
  params: {\
    id: app.moveGrid.selModel.lastFocused.data.ID,\
    cntr: app.moveGrid.selModel.lastFocused.data.CNTR,\
    type: app.taskType\
  },\
  success: function(resp) {\
    var ret = Wb.decode(resp.responseText);\
    if (!ret.success) {\
      Wb.error(\"保存撤销标志失败\");\
      return;\
    }\
    app.moveGrid.selModel.lastFocused.set('PHASE', 'CNL');\
    app.moveGrid.selModel.lastFocused.commit();\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "popupCyBack",
                "tooltip": "返场",
                "text": "返场",
                "iconCls": "yellow-crane_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "app.cyBackWin.show();\
Wb.setValue(app.cyBackWin, {\
  old_pos: app.moveGrid.selModel.lastFocused.data.FROM_POS\
});"}
              },
              {
               "configs": {
                "itemId": "popupGateCnl",
                "tooltip": "取消进门",
                "text": "取消进门",
                "iconCls": "first_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.request({\
  url: 'm?xwl=receiptInout/gate/gatebackedit/gateTiBack',\
  params: {\
    cntr: sels[0].data.CNTR\
  },\
  success: function(resp) {\
    var ret = JSON.parse(resp.responseText);\
    if(!ret.success)\
      Wb.error(ret.errstr);\
    else\
    {\
      Wb.info('取消成功');\
      app.treeTask.store.reload();\
    }\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "popupPriority",
                "tooltip": "设置优先作业",
                "text": "设置优先作业",
                "iconCls": "top_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/prior',\
  params: {\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    ids: sels.map(function(s) {\
      return s.data.ID;\
    }),\
    taskId: app.taskId\
  },\
  success: function(resp) {}\
});"}
              },
              {
               "configs": {
                "itemId": "popupPriorityCnl",
                "tooltip": "取消优先作业",
                "text": "取消优先作业",
                "iconCls": "top_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/canclePrior',\
  params: {\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    ids: sels.map(function(s) {\
      return s.data.ID;\
    }),\
    taskId: app.taskId\
  },\
  success: function(resp) {}\
});"}
              },
              {
               "configs": {
                "itemId": "popupRemark",
                "tooltip": "设置备注",
                "text": "备注",
                "iconCls": "notepad_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.setValue(app.remarkWin, {\
  notes: sels[0].data.NOTES,\
  id:sels[0].data.ID\
});\
app.remarkWin.show();"}
              }
             ],
             "type": "menu",
             "events": {"show": "var rows = app.moveGrid.getSelection();\
if (!(rows && rows[0])) {\
  menu.hide();\
  return;\
}\
//发送按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'PLN';\
  }))\
  menu.down(\"#sendBtn\").show();\
else\
  menu.down(\"#sendBtn\").hide();\
\
//取消按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'SND';\
  }) && (app.taskType === 'VIN' || app.taskType === 'VOUT' || app.taskType === 'MOVE'))\
  menu.down(\"#cancelBtn\").show();\
else\
  menu.down(\"#cancelBtn\").hide();\
\
//启用按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.ENABLE_ID === 0;\
  }))\
  menu.down(\"#enableBtn\").show();\
else\
  menu.down(\"#enableBtn\").hide();\
\
//取消按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.ENABLE_ID === 1;\
  }))\
  menu.down(\"#disableBtn\").show();\
else\
  menu.down(\"#disableBtn\").hide();\
\
//写卡按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.RELEASE_ID == 1 && (r.data.Y2Y_ID === 1 || r.data.TO_POS_TYP === 'G' || r.data.FROM_POS_TYP === 'G');\
  }))\
  menu.down(\"#writeCardBtn\").show();\
else\
  menu.down(\"#writeCardBtn\").hide();\
\
//卸船测试是否可见\
if (app.taskType === 'VIN' && Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'PLN' || r.data.PHASE === 'SND' || r.data.PHASE === 'TMP';\
  }))\
  menu.down(\"#unloadBtn\").show();\
else\
  menu.down(\"#unloadBtn\").hide();\
\
//装船测试是否可见\
if (app.taskType === 'VOUT' && Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'EXE' || r.data.PHASE === 'TMP';\
  }))\
  menu.down(\"#loadBtn\").show();\
else\
  menu.down(\"#loadBtn\").hide();\
\
//修改场位是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return (r.data.TO_POS_TYP === 'B' || r.data.TO_POS_TYP === 'V' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN';\
  }))\
  menu.down(\"#modifyCyBtn\").show();\
else\
  menu.down(\"#modifyCyBtn\").hide();\
\
//装船回退是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.TO_POS_TYP === 'V' && (r.data.PHASE == 'FIN' || r.data.PHASE == 'EXE');\
  }))\
  menu.down(\"#popupLoadBack\").show();\
else\
  menu.down(\"#popupLoadBack\").hide();\
\
//撤销是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'PLN';\
  }))\
  menu.down(\"#popupRevoke\").show();\
else\
  menu.down(\"#popupRevoke\").hide();\
\
//返场是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.TO_POS_TYP === 'G' && r.data.PHASE === 'EXE';\
  }))\
  menu.down(\"#popupCyBack\").show();\
else\
  menu.down(\"#popupCyBack\").hide();\
\
//取消进门是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.TO_POS_TYP === 'G' && r.data.PHASE === 'SND';\
  }))\
  menu.down(\"#popupGateCnl\").show();\
else\
  menu.down(\"#popupGateCnl\").hide();\
\
//设置优先作业是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PRIORITY === 1;\
  }))\
  menu.down(\"#popupPriority\").show();\
else\
  menu.down(\"#popupPriority\").hide();\
\
//取消优先作业是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PRIORITY === 2;\
  }))\
  menu.down(\"#popupPriorityCnl\").show();\
else\
  menu.down(\"#popupPriorityCnl\").hide();\
\
//打印放行条是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.Y2Y_ID;\
  }))\
  menu.down(\"#popupPrint\").show();\
else\
  menu.down(\"#popupPrint\").hide();"}
            }
           ],
           "type": "grid",
           "events": {"afterrender": "grid.store.sort('CREATED_ON','DESC');"}
          }],
          "type": "panel"
         },
         {
          "configs": {
           "layout": "fit",
           "itemId": "moveListbPanel",
           "split": "true",
           "collapsed": "true",
           "region": "south",
           "collapsible": "true",
           "height": "150"
          },
          "expanded": false,
          "children": [{
           "configs": {
            "itemId": "moveGridb",
            "multiColumnSort": "true",
            "tbar": "app.tbarMoveb",
            "disabled": "false",
            "multiSelect": "true"
           },
           "expanded": true,
           "children": [
            {
             "configs": {
              "itemId": "store",
              "pageSize": "50",
              "sorters": "'ID'",
              "url": "m?xwl=controlManage/task/worktaskcraneedit/moveListbSelect"
             },
             "expanded": false,
             "children": [],
             "type": "store"
            },
            {
             "configs": {"itemId": "columns"},
             "expanded": false,
             "children": [
              {
               "configs": {
                "itemId": "column1",
                "xtype": "rownumberer"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "BILL_NO99",
                "dataIndex": "BILL_NO",
                "text": "提单号码"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR99",
                "dataIndex": "GOODS_NOTES",
                "width": "120",
                "text": "货名"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "PHASE999",
                "renderer": "var map = {\
  PLN: '计划',\
  SND: '发送',\
  CNL: '撤销',\
  EXE: '执行',\
  TMP: '暂存',\
  FIN: '完成'\
};\
var color = app.TASK_STATE && app.TASK_STATE[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return map[value] || value;",
                "dataIndex": "PHASE",
                "width": "40",
                "text": "状态",
                "align": "center"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_POS99",
                "dataIndex": "FROM_POS",
                "width": "65",
                "text": "起点"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_POS99",
                "dataIndex": "TO_POS",
                "width": "65",
                "text": "终点"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "C_CNTR_TYP99",
                "dataIndex": "CNTR_TYPE",
                "width": "40",
                "text": "类型"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS199",
                "dataIndex": "TRCLASS1",
                "width": "40",
                "text": "机械类型1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1995",
                "dataIndex": "TRANSPORTER1",
                "width": "40",
                "text": "机械1"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1991",
                "dataIndex": "TRCLASS2",
                "width": "40",
                "text": "机械类型2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19911",
                "dataIndex": "TRANSPORTER2",
                "width": "40",
                "text": "机载2"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1992",
                "dataIndex": "TRCLASS3",
                "width": "40",
                "text": "机械类型3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19921",
                "dataIndex": "TRANSPORTER3",
                "width": "40",
                "text": "机载3"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1993",
                "dataIndex": "TRCLASS4",
                "width": "40",
                "text": "机械类型4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19931",
                "dataIndex": "TRANSPORTER4",
                "width": "40",
                "text": "机械4"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS1994",
                "dataIndex": "TRCLASS5",
                "text": "机械类型5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRCLASS19941",
                "dataIndex": "TRANSPORTER5",
                "text": "机械5"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "FROM_YPOINT99",
                "dataIndex": "FROM_YPOINT",
                "text": "起始坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TO_XPOINT99",
                "dataIndex": "TO_XPOINT",
                "text": "目标坐标"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "ORIGIN99",
                "dataIndex": "CARRIER_CODE",
                "text": "原始位置"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CARRIER_ATA99",
                "dataIndex": "CARRIER_ATA",
                "text": "来的时间"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SAFE_WT99",
                "dataIndex": "SAFE_WT",
                "text": "安全重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SCALE_WT99",
                "dataIndex": "SCALE_WT",
                "text": "过磅重量"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "SERVICE99",
                "dataIndex": "SERVICE",
                "text": "航线"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OPL99",
                "dataIndex": "OPL",
                "text": "装货港"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRUCKING_CO99",
                "dataIndex": "TRUCKING_CO",
                "text": "车队"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "TRANSPORTER199",
                "dataIndex": "TRANSPORTER1",
                "text": "作业机械"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "LINE99",
                "dataIndex": "LINE",
                "width": "120",
                "text": "船公司"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_MAN99",
                "hidden": "true",
                "dataIndex": "CREATED_BY",
                "text": "创建人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CREATED_ON99",
                "dataIndex": "CREATED_ON",
                "text": "创建时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_ON99",
                "dataIndex": "UPDATED_ON",
                "text": "修改时间"
               },
               "expanded": true,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "UPDATED_MAN99",
                "hidden": "true",
                "dataIndex": "UPDATED_BY",
                "text": "修改人"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_LENGTH99",
                "hidden": "true",
                "dataIndex": "CNTR_LENGTH",
                "text": "长度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "CNTR_HIGHT99",
                "hidden": "true",
                "dataIndex": "CNTR_HIGHT",
                "text": "高度"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "OVERHEIGHT99",
                "hidden": "true",
                "dataIndex": "OVERHEIGHT",
                "text": "超重"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              },
              {
               "configs": {
                "itemId": "POSITION_STATUS99",
                "dataIndex": "POSITION_STATUS",
                "text": "位置状态"
               },
               "expanded": false,
               "children": [],
               "type": "column"
              }
             ],
             "type": "array"
            },
            {
             "configs": {
              "itemId": "popupMenu",
              "normalName": "menu1"
             },
             "expanded": true,
             "children": [
              {
               "configs": {
                "itemId": "popupComp",
                "tooltip": "查看在场箱信息",
                "text": "查看在场箱信息",
                "iconCls": "object_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: app.moveGrid.selModel.lastFocused.data.CNTR_ID\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
 // win.setPosition(\"100\",\"400\");\
\
    wins.show();\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "sendBtn",
                "tooltip": "发送",
                "text": "发送",
                "iconCls": "flag1_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/instSplit',\
  params: {\
    id: app.taskId,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    cntrs: app.moveGrid.getSelection().map(function(sel) {\
      return sel.data.CNTR;\
    })\
  },\
  success: function(resp) {\
    Wb.info(resp.responseText);\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "cancelBtn",
                "tooltip": "取消发送",
                "text": "取消",
                "iconCls": "undo_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/taskDubbo/delInstSplit',\
  params: {\
    taskId: app.taskId,\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    cntrs: app.moveGrid.getSelection().map(function(sel) {\
      return sel.data.CNTR;\
    })\
  },\
  success: function(resp) {\
    Wb.info(\"成功\"); //resp.responseText);\
  }\
});"}
              },
              {
               "configs": {
                "itemId": "enableBtn",
                "tooltip": "启用指令",
                "text": "启用",
                "iconCls": "lamp_green_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "// Wb.info(app.menu1.popupComp.itemId); //同一menu可以用于多个控件，popupComp指向使菜单弹出的控件\
//(激活现在就先改下状态)\
var sels = app.moveGrid.getSelection();\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/enableIns',\
  params: {\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    ids: sels.map(function(s){return s.data.ID;}),\
    taskId: app.taskId\
  },\
  success: function(resp) {}\
});"}
              },
              {
               "configs": {
                "itemId": "disableBtn",
                "tooltip": "禁用指令",
                "text": "禁用",
                "iconCls": "lamp_red_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "// Wb.info(app.menu1.popupComp.itemId); //同一menu可以用于多个控件，popupComp指向使菜单弹出的控件\
//(激活现在就先改下状态)\
var sels = app.moveGrid.getSelection();\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/disableIns',\
  params: {\
    ship: app.treeTask.getSelection()[0].raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    ids: sels.map(function(s) {\
      return s.data.ID;\
    }),\
    taskId: app.taskId\
  },\
  success: function(resp) {}\
});"}
              },
              {
               "configs": {
                "itemId": "writeCardBtn",
                "tooltip": "写卡",
                "text": "写卡",
                "iconCls": "book_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "app.card.writeCardWin.show();\
"}
              },
              {
               "configs": {
                "itemId": "unloadBtn",
                "tooltip": "卸船测试",
                "text": "卸船测试",
                "iconCls": "anonymous_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "app.discWin.show();"}
              },
              {
               "configs": {
                "itemId": "loadBtn",
                "tooltip": "装船测试",
                "text": "装船测试",
                "iconCls": "anonymous_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
Wb.each(sels, function(sel) {\
  Wb.request({\
    url: 'appFun',\
    params: {\
      funId: 'SAVE_LOAD',\
      cntr: sel.data.CNTR,\
      ship:app.treeTask.selModel.selected.items[0].raw.ship\
    },\
    success: function(resp) {\
      var ret = Wb.decode(resp.responseText);\
      if (!ret.sucess && ret.errstr)\
        Wb.error(ret.errstr);\
    }\
  });\
});"}
              },
              {
               "configs": {
                "itemId": "modifyCyBtn",
                "tooltip": "指定目标场位",
                "text": "指定目标场位",
                "iconCls": "boxs_icon"
               },
               "expanded": false,
               "children": [],
               "type": "item",
               "events": {"click": "var sels = app.moveGrid.getSelection();\
if (!(sels && sels.length))\
  return;\
var olds = [];\
var moves = [];\
Wb.each(sels, function(r) {\
  if ((r.data.TO_POS_TYP === 'B' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN') {\
    if (!olds.includes(r.data.TO_POS))\
      olds.push(r.data.TO_POS);\
    moves.push(r.data.ID);\
  }\
});\
Wb.setValue(app.toPosWin, {\
  old_pos: olds ? olds.join(',') : '',\
  to_pos: ''\
});\
app.toPosWin.moves = moves;\
app.toPosWin.show();"}
              }
             ],
             "type": "menu",
             "events": {"show": "var rows = app.moveGrid.getSelection();\
if (!(rows && rows[0])) {\
  menu.hide();\
  return;\
}\
//发送按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'PLN';\
  }))\
  menu.down(\"#sendBtn\").show();\
else\
  menu.down(\"#sendBtn\").hide();\
\
//取消按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'SND';\
  }))\
  menu.down(\"#cancelBtn\").show();\
else\
  menu.down(\"#cancelBtn\").hide();\
\
//启用按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.ENABLE_ID === 0;\
  }))\
  menu.down(\"#enableBtn\").show();\
else\
  menu.down(\"#enableBtn\").hide();\
\
//取消按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.ENABLE_ID === 1;\
  }))\
  menu.down(\"#disableBtn\").show();\
else\
  menu.down(\"#disableBtn\").hide();\
\
//写卡按钮是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return r.data.Y2Y_ID === 1 || r.data.TO_POS_TYP === 'G' || r.data.FROM_POS_TYP === 'G';\
  }))\
  menu.down(\"#writeCardBtn\").show();\
else\
  menu.down(\"#writeCardBtn\").hide();\
\
//卸船测试是否可见\
if (app.taskType === 'VIN' && Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'PLN' || r.data.PHASE === 'SND' || r.data.PHASE === 'TMP';\
  }))\
  menu.down(\"#unloadBtn\").show();\
else\
  menu.down(\"#unloadBtn\").hide();\
\
//装船测试是否可见\
if (app.taskType === 'VOUT' && Ext.Array.findBy(rows, function(r) {\
    return r.data.PHASE === 'EXE' || r.data.PHASE === 'TMP';\
  }))\
  menu.down(\"#loadBtn\").show();\
else\
  menu.down(\"#loadBtn\").hide();\
\
//修改场位是否可见\
if (Ext.Array.findBy(rows, function(r) {\
    return (r.data.TO_POS_TYP === 'B' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN';\
  }))\
  menu.down(\"#modifyCyBtn\").show();\
else\
  menu.down(\"#modifyCyBtn\").hide();"}
            }
           ],
           "type": "grid"
          }],
          "type": "panel"
         }
        ],
        "type": "panel"
       },
       {
        "configs": {
         "border": "false",
         "layout": "border",
         "itemId": "panelPrint",
         "region": "south",
         "height": "0"
        },
        "expanded": false,
        "children": [
         {
          "configs": {
           "border": "false",
           "itemId": "panelPrintF",
           "width": "60",
           "region": "east",
           "height": "0"
          },
          "expanded": false,
          "children": [],
          "type": "panel"
         },
         {
          "configs": {
           "border": "false",
           "itemId": "panelPrintE",
           "region": "center",
           "height": "0"
          },
          "expanded": false,
          "children": [],
          "type": "panel"
         }
        ],
        "type": "panel"
       }
      ],
      "type": "panel"
     },
     {
      "configs": {
       "itemId": "xwl1",
       "file": "m?xwl=system/common/rabbitMq"
      },
      "expanded": false,
      "children": [],
      "type": "xwl"
     }
    ],
    "type": "viewport"
   }
  ],
  "type": "module",
  "events": {
   "finalize": "window[\"init\" + opt] = function(id) {\
  var m = document.getElementById(opt);\
\
m.func(\"setCookie\", \"JSESSIONID={#JSESSIONID#}\");\
\
  if (id == opt) {\
    m.func(\"Build\", '/supcan/report/print/receipt_E.xml?' + Math.round(Math.random() * 100));\
    m.func(\"SetSource\", \"m?xwl=system/common/report/reportTemplate/dataSource&dd=\"+  Math.round(Math.random() * 100));\
    m.func(\"DisableMenu\", \"showRuler,exportAll,printAll,delete,insert,import,curselMode,hue,language,enter\\r\\
 true\");\
  }\
};\
\
window[\"init\" + opt1] = function(id) {\
  var m = document.getElementById(opt1);\
   m.func(\"setCookie\", \"JSESSIONID={#JSESSIONID#}\");\
  if (id == opt1) {\
   \
    m.func(\"Build\", '/supcan/report/print/receipt_F.xml?' + Math.round(Math.random() * 100));\
    m.func(\"DisableMenu\", \"showRuler,exportAll,printAll,delete,insert,import,curselMode,hue,language,enter\\r\\
 true\");\
  }\
};\
\
Wb.request({\
  url: \"m?xwl=controlManage/task/worktaskcraneedit/taskColor\",\
  success: function(res) {\
    Wb.apply(app, Wb.decode(res.responseText));\
  }\
});\
\
var mt1 = bldStr(\"LuxForm\", opt, \"\", \"99%\");\
app.panelPrintE.update(mt1);\
var mt2 = bldStr(\"LuxForm\", opt1, \"\", \"99%\");\
app.panelPrintF.update(mt2);",
   "initialize": "var opt = Wb.getId();\
var opt1 = Wb.getId();"
  }
 }],
 "roles": {
  "JTLD": 1,
  "ZSJJ": 1,
  "SCANJB": 1,
  "xlzk": 1,
  "xlcd": 1,
  "ZSZKCZ": 1
 },
 "title": "任务指令",
 "iconCls": "",
 "inframe": false,
 "pageLink": ""
}