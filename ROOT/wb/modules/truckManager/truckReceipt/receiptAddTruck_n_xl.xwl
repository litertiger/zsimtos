{
 "hidden": false,
 "children": [{
  "configs": {"itemId": "module"},
  "expanded": true,
  "children": [
   {
    "configs": {
     "layout": "@{type:'table',columns:2}",
     "itemId": "winAccDetails",
     "dialog": "true",
     "defaults": "{\
  labelWidth: 60,\
  width: 220,\
  margin: '8 8 0 8'\
}",
     "closeAction": "destroy",
     "width": "500",
     "title": "补充费用",
     "height": "160"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "itemId": "RID_A",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "RID",
       "readOnly": "true"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "CNTR",
       "labelAlign": "right",
       "fieldLabel": "箱号",
       "readOnly": "true"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "FEE_LIST_ID",
       "allowBlank": "false",
       "labelAlign": "right",
       "fieldLabel": "费目",
       "keyName": "C_BASE_CHARGING_ITEM",
       "anyMatch": "true",
       "forceSelection": "true"
      },
      "expanded": true,
      "children": [],
      "type": "combo",
      "events": {"change": "// Wb.request({\
//   url: \"m?xwl=BuzManage/bandanedit/getReat\",\
//   params: {\
//     mth: \"find\",\
//     bill_no: app.ACCBILL_NO.getValue(),\
//     FEE_LIST_ID: app.FEE_LIST_ID.getValue(),\
//     CNTR: app.CNTR.getValue()\
//   },\
//   success: function(resp) {\
//     var result = Wb.decode(resp.responseText);\
//     console.log(result);\
//     if (result.length > 0) {\
//       app.ACTUAL_JOB_COUNT.setValue(result[0].actualJobCount);\
//       app.AMOUNT1.setValue(result[0].amount);\
//       app.DWELLDAYS.setValue(result[0].dwellDays);\
//       app.AMOUNT.setValue(result[0].amount);\
//     }\
//   }\
// });"}
     },
     {
      "configs": {
       "itemId": "ACTUAL_JOB_COUNT",
       "allowBlank": "false",
       "minValue": "1",
       "labelAlign": "right",
       "fieldLabel": "数量",
       "value": "1"
      },
      "expanded": true,
      "children": [],
      "type": "number",
      "events": {"change": "var a = Wb.isEmpty(newValue) ? 0 : newValue;\
var b = Wb.isEmpty(app.AMOUNT1.getValue()) ? 0 : app.AMOUNT1.getValue();\
app.AMOUNT.setValue(a * b);"}
     },
     {
      "configs": {
       "itemId": "AMOUNT1",
       "allowBlank": "false",
       "minValue": "1",
       "labelAlign": "right",
       "fieldLabel": "单价"
      },
      "expanded": false,
      "children": [],
      "type": "number",
      "events": {"change": "var a = Wb.isEmpty(newValue) ? 0 : newValue;\
var b = Wb.isEmpty(app.ACTUAL_JOB_COUNT.getValue()) ? 0 : app.ACTUAL_JOB_COUNT.getValue();\
app.AMOUNT.setValue(a * b);"}
     },
     {
      "configs": {
       "itemId": "AMOUNT",
       "allowBlank": "false",
       "minValue": "1",
       "labelAlign": "right",
       "fieldLabel": "金额"
      },
      "expanded": false,
      "children": [],
      "type": "number"
     },
     {
      "configs": {
       "itemId": "MANUAL_NODES",
       "labelAlign": "right",
       "fieldLabel": "确认人"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     }
    ],
    "type": "window",
    "events": {"ok": "Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/insertAccount\",\
  params: {\
    billid: app.RID_A.getValue(),\
    FEE_LIST_ID: app.FEE_LIST_ID.getValue(),\
    AMOUNT: app.AMOUNT.getValue(),\
    ACTUAL_JOB_COUNT: app.ACTUAL_JOB_COUNT.getValue(),\
    MANUAL_NODES: app.MANUAL_NODES.getValue(),\
    trade: \"1\"\
  },\
  success: function(resp) {\
    var res = Wb.decode(resp.responseText);\
    if (res.success) {\
      Wb.info(res.msg);\
      app.winAccDetails.close();\
    }\
  }\
});"}
   },
   {
    "configs": {
     "layout": "@{type:'table',columns:2}",
     "itemId": "winCar_team",
     "dialog": "true",
     "defaults": "{\
  labelWidth: 60,\
  width: 300,\
  margin: '8 8 0 8'\
}",
     "closeAction": "destroy",
     "width": "360",
     "title": "修改车队",
     "height": "100"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "ids",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "RID"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "UP_CAR_TEAM",
       "allowBlank": "false",
       "labelAlign": "right",
       "fieldLabel": "车队",
       "displayField": "CNAME",
       "valueField": "ID",
       "forceSelection": "true"
      },
      "expanded": true,
      "children": [{
       "configs": {
        "itemId": "store",
        "autoLoad": "true",
        "pageSize": "-1",
        "url": "m?xwl=receiptInout/receipt/receiptedit/selectCarTeam"
       },
       "expanded": false,
       "children": [],
       "type": "store"
      }],
      "type": "combo"
     }
    ],
    "type": "window",
    "events": {"ok": "if (!Wb.verify(app.UP_CAR_TEAM))\
  return;\
Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/updcarteam\",\
  params: {\
    ids: app.ids.getValue(),\
    car_team: app.UP_CAR_TEAM.getValue()\
  },\
  success: function(resp) {\
    Wb.info(\"修改完成\");\
    app.winCar_team.close();\
    app.searchRBtn.fireEvent(\"click\");\
  }\
});"}
   },
   {
    "configs": {
     "layout": "@{type:'table',columns:1}",
     "itemId": "winUpd",
     "dialog": "true",
     "defaults": "{\
  labelWidth: 85,\
  width: 320,\
  margin: '8 8 0 8'\
}",
     "closeAction": "destroy",
     "width": "360",
     "title": "修改",
     "height": "100"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "idsupd",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "RID"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "PLAN_STIME",
       "fieldLabel": "计划送货时间"
      },
      "expanded": false,
      "children": [],
      "type": "datetime"
     }
    ],
    "type": "window",
    "events": {"ok": "Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/update\",\
  out: app.winUpd,\
  success: function(resp) {\
    Wb.info(\"修改完成\");\
    app.winUpd.close();\
    app.searchRBtn.fireEvent(\"click\");\
  }\
});"}
   },
   {
    "configs": {
     "layout": "@{type:'table',columns:1}",
     "itemId": "winShuai",
     "dialog": "true",
     "defaults": "{\
  labelWidth: 85,\
  width: 320,\
  margin: '8 8 0 8'\
}",
     "closeAction": "destroy",
     "width": "360",
     "title": "甩卡",
     "height": "100"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "itemId": "shuaiid",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "RID"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "shuai",
       "allowBlank": "false",
       "labelAlign": "right",
       "pickList": "[\
  [\"F\", \"工厂甩卡\"],\
  [\"C\", \"码头甩卡\"]\
]",
       "fieldLabel": "甩卡地点",
       "forceSelection": "true"
      },
      "expanded": true,
      "children": [],
      "type": "combo",
      "events": {"specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.IN_CAR.focus();\
    app.IN_CAR.selectText();\
  }\
}"}
     }
    ],
    "type": "window",
    "events": {"ok": "Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/shuaika\",\
  out: app.winShuai,\
  success: function(resp) {\
    Wb.info(\"操作完成\");\
    app.winShuai.close();\
    app.searchRBtn.fireEvent(\"click\");\
  }\
});"}
   },
   {
    "configs": {
     "itemId": "bbarp",
     "enableOverflow": "true",
     "style": "background:white;"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "itemId": "btnpai",
       "width": "100",
       "text": "<span style='font-size:14px;font-weight:bold;'>派&nbsp;&nbsp;&nbsp;车(F8)<\/span>",
       "iconCls": "yellow-line-conveyor-belt_icon"
      },
      "expanded": false,
      "children": [],
      "type": "item",
      "events": {"click": "if (app.SHIPPER_WAY.getValue() == \"1\") {\
  //   app.S_ADRESS.allowBlank = false;\
  //   app.FEI_ADDDRESS.allowBlank = false;\
} else {\
  //   app.S_ADRESS.allowBlank = true;\
  //   app.FEI_ADDDRESS.allowBlank = true;\
}\
if (Wb.isEmpty(app.RID.getValue())) {\
  Wb.warn(\"请选择设备交接单\");\
  return;\
}\
if (!Wb.verify(app.panelForm)) {\
  return;\
}\
Wb.request({\
  url: 'm?xwl=truckManager/truckReceipt/receiptAddTruckedit_n/paiche',\
  out: app.panelForm,\
  success: function(resp) {\
    var result = Wb.decode(resp.responseText);\
    if (result.success) {\
      Wb.reset(app.panelForm);\
      app.searchRBtn.fireEvent(\"click\");\
      //       Wb.info(\"派车完成\");\
      app.txtCNTR_NO_R.focus();\
      app.txtCNTR_NO_R.selectText();\
    } else {\
      Wb.error(result.errstr);\
    }\
  }\
});"}
     },
     {
      "configs": {
       "itemId": "btnti",
       "width": "100",
       "text": "<span style='font-size:14px;font-weight:bold;'>提&nbsp;&nbsp;&nbsp;箱(F9)<\/span>",
       "iconCls": "yellow-line-crane_icon"
      },
      "expanded": false,
      "children": [],
      "type": "item",
      "events": {"click": "/*var taskType = pnl.cntrInfo && pnl.cntrInfo.TASK_TYPE;\
if(taskType != 'GOUT')\
  return Wb.error(\"请先选择提箱任务\");*/\
var pnl = app.panelForm;\
pnl.cntrInfo = {\
  CNTR: '',\
  CNTR_SIZE: '',\
  TO_POS: '',\
  YARD_POSITION: '',\
  RELEASE_ID: '',\
  IN_CAR: '',\
  PLAT_NO: '',\
  E_F_ID: '',\
  I_E_ID: '',\
  CMDY_CODE: '',\
  CNTR_OPERATOR: ''\
\
};\
Wb.request({\
  url: 'm?xwl=controlManage/task/worktaskcraneedit/cntrInfo',\
  params: {\
    find: app.panelForm.down('#CNTR').getValue()\
  },\
  success: function(resp) {\
    var rows = JSON.parse(resp.responseText);\
    if (rows.length === 0) {\
      Wb.error('找不到箱信息');\
    } else if (rows.length > 1) {\
      app.selCntrWin.target = pnl;\
      app.selCntrWin.data = rows;\
      app.selCntrWin.show();\
    }\
    //       } else if (pnl === app.panelCntr2 && rows[0].CNTR_SIZE > 20)\
    //         Wb.error('孖柜不能有40尺柜');\
    else {\
      pnl.cntrInfo = rows[0];\
      Wb.setValue(pnl, pnl.cntrInfo);\
      //         app.truck.setValue(pnl.cntrInfo.IN_CAR);\
      //         app.plate.setValue(pnl.cntrInfo.PLAT_NO);\
    }\
\
    var ids = [];\
    var cfs;\
    var id = pnl.cntrInfo && pnl.cntrInfo.RID;\
    if (id) {\
      ids.push(id);\
      var pos = pnl.cntrInfo.YARD_POSITION || '';\
      cfs = Wb.yardCfsMap[pos.substr(0, 2)] || 'JGQ';\
    }\
    // pnl = app.panelCntr2;\
    // var id = pnl.cntrInfo && pnl.cntrInfo.RID;\
    // if (id) {\
    //   var pos = pnl.cntrInfo.YARD_POSITION || '';\
    //   var cfs2 = Wb.yardCfsMap[pos.substr(0, 2)] || 'JGQ';\
    //   if (cfs2 !== cfs)\
    //     return Wb.error(\"双箱所在闸区不一致\");\
    //   ids.push(id);\
    // }\
    //       alert(app.panelForm.down('#IN_CAR').getValue());\
    if (ids.length === 0)\
      return Wb.error(\"无待入闸设备交接单\");\
    Wb.request({\
      url: \"m?xwl=controlManage/task/worktaskcraneedit/inGate\",\
      params: Wb.apply({\
        ids: ids,\
        cfs: cfs,\
        truck: app.panelForm.down('#IN_CAR').getValue()\
      }),\
      success: function(resp) {\
        var result = Wb.decode(resp.responseText);\
        if (result.success) {\
          Wb.info('办理成功', function() {\
            var find = app.tabCntr.getRefOwner().queryById('find');\
            find.fireEvent('specialkey', find, {\
              keyCode: 13\
            });\
          });\
        } else\
          Wb.error(result.errstr);\
      }\
    });\
  }\
});"}
     },
     {
      "configs": {
       "itemId": "btnreset",
       "width": "70",
       "text": "<span style='font-size:14px;font-weight:bold;'>重&nbsp;&nbsp;置<\/span>",
       "iconCls": "redo_icon"
      },
      "expanded": false,
      "children": [],
      "type": "item",
      "events": {"click": "Wb.reset(app.panelForm);"}
     }
    ],
    "type": "toolbar"
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "viewport1"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "itemId": "xwl1",
       "file": "m?xwl=system/common/rabbitMq"
      },
      "expanded": false,
      "children": [],
      "type": "xwl"
     },
     {
      "configs": {
       "layout": "@{type:'table',columns:1}",
       "itemId": "panelForm",
       "defaults": "{\
  labelWidth: 80,\
  width: 260,\
  margin: '6 0 0 0'\
}",
       "width": "280",
       "region": "west",
       "title": "派车信息",
       "bbar": "app.bbarp"
      },
      "expanded": false,
      "children": [
       {
        "configs": {
         "itemId": "RID",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "RID"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "CNTR_OPERATOR_COD",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "CNTR_OPERATOR_COD"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "CNTR",
         "labelAlign": "right",
         "fieldLabel": "箱号/提单",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "RID1",
         "labelAlign": "right",
         "fieldLabel": "双托",
         "displayField": "CNTR",
         "isUpperCase": "true",
         "valueField": "ID",
         "queryDelay": "200",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit_n1/selectReceipt1"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {"specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.SHIPPER_WAY.focus();\
    app.SHIPPER_WAY.selectText();\
  }\
}"}
       },
       {
        "configs": {
         "itemId": "SHIPPER_WAY",
         "allowBlank": "false",
         "labelAlign": "right",
         "pickList": "[\
  [1, \"码头承运\"],\
  [3, \"驳船承运\"]\
]",
         "fieldLabel": "承运方式",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [],
        "type": "combo",
        "events": {"specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.IN_CAR.focus();\
    app.IN_CAR.selectText();\
  }\
}"}
       },
       {
        "configs": {
         "tagConfigs": "matchFieldWidth: false",
         "itemId": "IN_CAR",
         "allowBlank": "false",
         "tpl": "<table cellspacing='0' width='100%'>\
  <tr>\
    <td width='20%'>\
      编号\
    <\/td>\
    <td width='20%'>\
      车牌\
    <\/td>\
    <td width='60%'>\
      车队\
    <\/td>\
  <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td>\
        {TRUCK_NO}\
      <\/td>\
      <td>\
        {PLAT_NO}\
      <\/td>\
      <td>\
        {NAME}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
         "labelAlign": "right",
         "fieldLabel": "车头",
         "displayField": "TRUCK_NO",
         "isUpperCase": "true",
         "listConfig": "{\
  width: 400\
}",
         "valueField": "TRUCK_NO",
         "queryDelay": "200",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit/loadTruck"
         },
         "expanded": false,
         "children": [],
         "type": "store",
         "events": {"beforeload": "operation.params = {\
  carteam: app.CAR_TEAM.getValue(),\
  query: operation.params.query\
};"}
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.IN_CAMPI.focus();\
    app.IN_CAMPI.selectText();\
  }\
}",
         "select": "Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/selectT\",\
  params: {\
    truckno: combo.getValue()\
  },\
  success: function(resp) {\
    var result = Wb.decode(resp.responseText);\
    app.IN_CAR_HP.setValue(result.rows[0].PLAT_NO);\
    //     app.IN_CAMPI.setValue(result.rows[0].TRAY_NO);\
    //     app.IN_TRAY_NO.setValue(result.rows[0].TRAY_NO);\
    app.IN_DRIVER_ID.setValue(result.rows[0].TRUCKER_NO);\
    app.IN_DRIVER_NAME.setValue(result.rows[0].TRUCKER_NAM);\
    app.pt_type(app.CNTR_OPERATOR_COD.getValue());\
  }\
});"
        }
       },
       {
        "configs": {
         "itemId": "IN_CAR_HP",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "车牌号",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "IN_CAMPI",
         "tpl": "<table cellspacing='0' width='100%'>\
  <tr>\
    <td>\
      编号\
    <\/td>\
    <td>\
      拖卡\
    <\/td>\
  <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td >\
        {TRAY_NO}\
      <\/td>\
      <td>\
        {TRAY_NAM}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
         "labelAlign": "right",
         "fieldLabel": "拖卡",
         "displayField": "TRAY_NO",
         "isUpperCase": "true",
         "valueField": "TRAY_NO",
         "queryDelay": "200",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit/loadTray"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.IN_DRIVER_ID.focus();\
    app.IN_DRIVER_ID.selectText();\
  }\
}",
         "select": "app.OUT_CAMPI.setValue(combo.getValue());\
app.IN_TRAY_NO.setValue(combo.getValue());\
app.OUT_TRAY_NO.setValue(combo.getValue());"
        }
       },
       {
        "configs": {
         "itemId": "IN_TRAY_NO",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "拖卡号",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "IN_DRIVER_ID",
         "allowBlank": "false",
         "labelAlign": "right",
         "fieldLabel": "司机",
         "displayField": "EMPNAME",
         "valueField": "EMPNO",
         "queryDelay": "200",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit/loadDriver"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.OUT_CAR.focus();\
    app.OUT_CAR.selectText();\
  }\
}",
         "select": "app.OUT_DRIVER_ID.setValue(combo.getValue());\
app.IN_DRIVER_NAME.setValue(combo.getRawValue());\
app.OUT_DRIVER_NAME.setValue(combo.getRawValue());"
        }
       },
       {
        "configs": {
         "itemId": "IN_DRIVER_NAME",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "司机名",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "tagConfigs": "matchFieldWidth: false",
         "itemId": "OUT_CAR",
         "tpl": "<table cellspacing='0' width='100%'>\
  <tr>\
    <td width='20%'>\
      编号\
    <\/td>\
    <td width='20%'>\
      车牌\
    <\/td>\
    <td width='60%'>\
      车队\
    <\/td>\
  <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td>\
        {TRUCK_NO}\
      <\/td>\
      <td>\
        {PLAT_NO}\
      <\/td>\
      <td>\
        {NAME}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
         "labelAlign": "right",
         "fieldLabel": "回程车头",
         "displayField": "TRUCK_NO",
         "isUpperCase": "true",
         "listConfig": "{\
  width: 400\
}",
         "valueField": "TRUCK_NO",
         "queryDelay": "200",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit/loadTruck"
         },
         "expanded": false,
         "children": [],
         "type": "store",
         "events": {"beforeload": "operation.params = {\
  carteam: app.CAR_TEAM.getValue(),\
  query: operation.params.query\
};"}
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.OUT_CAMPI.focus();\
    app.OUT_CAMPI.selectText();\
  }\
}",
         "select": "Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/selectT\",\
  params: {\
    truckno: combo.getValue()\
  },\
  success: function(resp) {\
    var result = Wb.decode(resp.responseText);\
    app.OUT_CAR.setValue(combo.getValue());\
    app.OUT_CAR_HP.setValue(result.rows[0].PLAT_NO);\
  }\
});"
        }
       },
       {
        "configs": {
         "itemId": "OUT_CAR_HP",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "车牌号",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "OUT_CAMPI",
         "tpl": "<table cellspacing='0' width='100%'>\
  <tr>\
    <td>\
      编号\
    <\/td>\
    <td>\
      拖卡\
    <\/td>\
  <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td >\
        {TRAY_NO}\
      <\/td>\
      <td>\
        {TRAY_NAM}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
         "labelAlign": "right",
         "fieldLabel": "回程拖卡",
         "displayField": "TRAY_NO",
         "isUpperCase": "true",
         "readOnly": "true",
         "valueField": "TRAY_NO",
         "queryDelay": "200",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit/loadTray"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.OUT_DRIVER_ID.focus();\
    app.OUT_DRIVER_ID.selectText();\
  }\
}",
         "select": "app.OUT_CAMPI.setValue(combo.getValue());\
app.OUT_TRAY_NO.setValue(combo.getValue());"
        }
       },
       {
        "configs": {
         "itemId": "OUT_TRAY_NO",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "拖卡号",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "OUT_DRIVER_ID",
         "labelAlign": "right",
         "fieldLabel": "回程司机",
         "displayField": "EMPNAME",
         "valueField": "EMPNO",
         "queryDelay": "200",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit/loadDriver"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.S_ADRESS.focus();\
    app.S_ADRESS.selectText();\
  }\
}",
         "select": "app.OUT_DRIVER_NAME.setValue(combo.getRawValue());"
        }
       },
       {
        "configs": {
         "itemId": "OUT_DRIVER_NAME",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "司机名",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "tagConfigs": "matchFieldWidth: false",
         "itemId": "S_ADRESS",
         "tpl": "<table cellspacing='0' width='100%'>\
  <tr>\
    <td>\
      地址\
    <\/td>\
    <td>\
      距离\
    <\/td>\
    <td>\
      区域\
    <\/td>\
  <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td >\
        {NAME}\
      <\/td>\
      <td>\
        {DISTANCE}\
      <\/td>\
      <td>\
        {AREANAME}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
         "allowBlank": "false",
         "labelAlign": "right",
         "fieldLabel": "交货地址",
         "displayField": "NAME",
         "listConfig": "{\
  width: 300\
}",
         "valueField": "ID",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "url": "m?xwl=receiptInout/receipt/receiptedit/selectADRESS"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.CAR_TEAM.focus();\
    app.CAR_TEAM.selectText();\
  }\
}",
         "select": "app.FEI_ADDDRESS.setValue(records[0].data.ARID);"
        }
       },
       {
        "configs": {
         "itemId": "FEI_ADDDRESS",
         "labelAlign": "right",
         "fieldLabel": "计费区域",
         "keyName": "C_AREA",
         "pageSize": "-1",
         "readOnly": "true",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [],
        "type": "combo"
       },
       {
        "configs": {
         "itemId": "CAR_TEAM",
         "allowBlank": "false",
         "labelAlign": "right",
         "fieldLabel": "车队",
         "displayField": "CNAME",
         "valueField": "ID",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=receiptInout/receipt/receiptedit/selectCarTeam"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {"specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.SHIP_CONSIGN_COD.focus();\
    app.SHIP_CONSIGN_COD.selectText();\
  }\
}"}
       },
       {
        "configs": {
         "itemId": "PT_TYPE",
         "allowBlank": "false",
         "labelAlign": "right",
         "fieldLabel": "车辆性质",
         "keyName": "PT_TYPE",
         "readOnly": "true",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [],
        "type": "combo"
       },
       {
        "configs": {
         "tagConfigs": "matchFieldWidth: false",
         "hideTrigger": "true",
         "allowBlank": "false",
         "itemId": "SHIP_CONSIGN_COD",
         "labelAlign": "right",
         "fieldLabel": "货主",
         "pageSize": "50",
         "displayField": "CNAME",
         "listConfig": "{\
  width: 250\
}",
         "valueField": "ID",
         "forceSelection": "true",
         "height": "22"
        },
        "expanded": true,
        "children": [{
         "configs": {
          "itemId": "store",
          "params": "{fldId:'CE'}",
          "url": "m?xwl=system/common/client/clientSelect"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        }],
        "type": "combo",
        "events": {
         "specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.SHUN_INVERSE.focus();\
    app.SHUN_INVERSE.selectText();\
  }\
}",
         "select": "app.SHIPPER_CONSIGNEE.setValue(combo.getRawValue());\
app.CONSIGNEE_COD.setValue(combo.getValue());\
app.CONSIGNEE.setValue(combo.getRawValue());"
        }
       },
       {
        "configs": {
         "itemId": "SHIPPER_CONSIGNEE",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "货主",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "CONSIGNEE_COD",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "收货人COD",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "CONSIGNEE",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "收货人",
         "readOnly": "true"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "SHUN_INVERSE",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "同逆向",
         "keyName": "SHUN_INVERSE",
         "anyMatch": "true",
         "forceSelection": "true"
        },
        "expanded": true,
        "children": [],
        "type": "combo",
        "events": {"specialkey": "if (e.getKey() == e.ENTER) {\
  if (!combo.isExpanded) { //判断combo不展开才切换焦点\
    app.RID1.focus();\
    app.RID1.selectText();\
  }\
}"}
       },
       {
        "configs": {
         "itemId": "DESTUFFING_FLAG",
         "labelAlign": "right",
         "fieldLabel": "拆箱"
        },
        "expanded": false,
        "children": [],
        "type": "check"
       }
      ],
      "type": "panel"
     },
     {
      "configs": {
       "itemId": "gridReceipt",
       "selType": "checkboxmodel",
       "region": "center"
      },
      "expanded": false,
      "children": [
       {
        "configs": {
         "itemId": "tbar",
         "enableOverflow": "true",
         "region": "north"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "txtCNTR_NO_R",
           "emptyText": "箱号,箱号,箱号",
           "isUpperCase": "true"
          },
          "expanded": true,
          "children": [],
          "type": "text",
          "events": {"specialkey": "if (e.getKey() == e.ENTER)\
  app.searchRBtn.fireEvent('click');"}
         },
         {
          "configs": {
           "itemId": "txtBILL_NO",
           "emptyText": "提单号",
           "isUpperCase": "true"
          },
          "expanded": true,
          "children": [],
          "type": "text",
          "events": {"specialkey": "if (e.getKey() == e.ENTER)\
  app.searchRBtn.fireEvent('click');"}
         },
         {
          "configs": {
           "itemId": "tbI_E_ID",
           "emptyText": "进出口",
           "keyName": "I_E_ID",
           "width": "60",
           "anyMatch": "true"
          },
          "expanded": false,
          "children": [],
          "type": "combo"
         },
         {
          "configs": {
           "itemId": "tbPHASE",
           "pickList": "[\
  [\"\", \"全部\"],\
  [\"PLN\", \"未派车\"],\
  [\"EXE\", \"已派车\"],\
  [\"FIN\", \"完成\"],\
  [\"CNL\", \"取消\"],\
  [\"GET\", \"场内提箱\"],\
  [\"RTN\", \"场内还箱\"],\
  [\"OUT\", \"场外\"]\
]",
           "emptyText": "状态",
           "width": "80",
           "anyMatch": "true",
           "forceSelection": "true"
          },
          "expanded": false,
          "children": [],
          "type": "combo"
         },
         {
          "configs": {
           "itemId": "tbpdate",
           "emptyText": "计划送货日期"
          },
          "expanded": false,
          "children": [],
          "type": "date"
         },
         {
          "configs": {
           "itemId": "searchRBtn",
           "text": "@Str.find",
           "iconCls": "search_icon"
          },
          "expanded": true,
          "children": [],
          "type": "item",
          "events": {"click": "app.gridReceipt.store.load({\
  out: app.tbar\
});\
\
Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/selectCount\",\
  params: {\
    date: app.tbpdate.getRawValue(),\
    tradeid: \"2\"\
  },\
  success: function(resp) {\
    var res = Wb.decode(resp.responseText);\
    if (res.length > 0) {\
      app.lblcount.setText(\"总数量:\" + res[0].ZONG + \", 未完成:\" + res[0].EXE + \", 已完成:\" + res[0].FIN);\
    }\
  }\
});"}
         },
         {
          "configs": {
           "itemId": "accountBtn",
           "hidden": "true",
           "text": "计费",
           "iconCls": "write_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sel = app.gridReceipt.getSelection()[0];\
if (Wb.isEmpty(sel)) {\
  Wb.warn(\"请先选择设备交接单\");\
  return;\
}\
Wb.request({\
  url: \"m?xwl=truckManager/truckReceipt/receiptAddTruckedit/getReat\",\
  params: {\
    rid: sel.data.ID\
  },\
  success: function(resp) {}\
});"}
         },
         {
          "configs": {
           "itemId": "item1",
           "text": "->"
          },
          "expanded": true,
          "children": [],
          "type": "item"
         },
         {
          "configs": {"itemId": "lblcount"},
          "expanded": false,
          "children": [],
          "type": "label"
         }
        ],
        "type": "toolbar"
       },
       {
        "configs": {
         "itemId": "store",
         "url": "m?xwl=truckManager/truckReceipt/receiptAddTruckedit_n1/selectReceipt"
        },
        "expanded": true,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "column1",
           "xtype": "rownumberer"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCREATED_ON",
           "dataIndex": "CREATED_ON",
           "width": "120",
           "text": "创建时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colPHASE",
           "renderer": "if (value == \"PLN\")\
  return \"未派车\";\
if (value == \"EXE\")\
  return \"已派车\";\
if (value == \"FIN\")\
  return \"完成\";\
if (value == \"CNL\")\
  return \"取消\";\
if (value == \"GET\")\
  return \"场内提箱\";\
if (value == \"RTN\")\
  return \"场内还箱\";\
if (value == \"OUT\")\
  return \"场外\";",
           "dataIndex": "PHASE",
           "width": "66",
           "text": "状态"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colBILL_NO",
           "dataIndex": "BILL_NO",
           "text": "提单号"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCNTR",
           "dataIndex": "CNTR",
           "text": "箱号"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCNTR_OPERATOR_COD",
           "dataIndex": "CNTR_OPERATOR_COD",
           "keyName": "AG_SHORT",
           "text": "船公司"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colSHIP_CONSIGN_COD",
           "renderer": "return Wb.getCustomerByCode(value);",
           "dataIndex": "SHIP_CONSIGN_COD",
           "text": "货主"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCONSIGNEE_COD",
           "hidden": "true",
           "dataIndex": "CONSIGNEE_COD",
           "text": "收货人"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCONSIGNEE",
           "hidden": "true",
           "dataIndex": "CONSIGNEE",
           "text": "收货人"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colS_ADRESS",
           "dataIndex": "S_ADRESS",
           "keyName": "C_ADDRESS",
           "text": "交货地址"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "solYARD_POSITION",
           "dataIndex": "YARD_POSITION",
           "width": "80",
           "text": "堆存位置"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCNTR_SIZE",
           "dataIndex": "CNTR_SIZE",
           "keyName": "CNTR_SIZE",
           "width": "66",
           "text": "箱尺寸"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCNTR_TYPE",
           "dataIndex": "CNTR_TYPE",
           "keyName": "CNTR_TYPE",
           "width": "66",
           "text": "箱型"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "solPLAN_STIME",
           "dataIndex": "PLAN_STIME",
           "width": "120",
           "text": "计划送货时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCAR_TEAM",
           "dataIndex": "CAR_TEAM",
           "keyName": "TU_CUSTOMER",
           "text": "车队"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colFEI_ADDDRESS",
           "dataIndex": "FEI_ADDDRESS",
           "keyName": "C_AREA",
           "text": "计费区域"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colNOTES",
           "dataIndex": "NOTES",
           "text": "备注"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCNTR_ISO",
           "dataIndex": "CNTR_ISO",
           "width": "66",
           "text": "箱ISO"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colCMDY_CODE",
           "dataIndex": "CMDY_CODE",
           "text": "货名"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colT_ADDRESS",
           "dataIndex": "T_ADDRESS",
           "width": "80",
           "keyName": "C_CFS",
           "text": "提箱地点"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colF_ADDRESS",
           "dataIndex": "F_ADDRESS",
           "width": "80",
           "keyName": "C_CFS",
           "text": "返场地址"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colWORK_TYPE",
           "dataIndex": "WORK_TYPE",
           "keyName": "WORK_WAY",
           "width": "80",
           "text": "作业方式"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colPT_TYPE",
           "dataIndex": "PT_TYPE",
           "keyName": "PT_TYPE",
           "text": "派车方式"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colGATEOUT_TIME_T",
           "dataIndex": "GATEOUT_TIME_T",
           "width": "120",
           "text": "出门时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colGATEIN_TIME_S",
           "dataIndex": "GATEIN_TIME_S",
           "width": "120",
           "text": "进门时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colPC_BY",
           "dataIndex": "PC_BY",
           "keyName": "WB_USER",
           "text": "派车人"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "colPC_ON",
           "dataIndex": "PC_ON",
           "width": "120",
           "text": "派车时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       },
       {
        "configs": {
         "itemId": "popupMenu",
         "normalName": "menuR"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "popupClean",
           "text": "取消",
           "iconCls": "delete_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var rowData = app.menuR.selectRow.data; //selectRow在popupMenu的show事件中设置\
Wb.confirm(\"确认取消操作\", function() {\
  var phase = \"PLN\";\
  if (rowData.WORK_TYPE == 'EITC' || rowData.WORK_TYPE == 'FITC')\
    phase = \"OUT\";\
  Wb.request({\
    url: 'm?xwl=truckManager/truckReceipt/receiptAddTruckedit/quxiao',\
    params: {\
      ID: rowData.ID,\
      PHASE: phase\
    },\
    success: function() {\
      Wb.reset(app.panelForm);\
      app.searchRBtn.fireEvent(\"click\");\
    }\
  });\
});"}
         },
         {
          "configs": {
           "itemId": "popupCar_team",
           "text": "修改车队",
           "iconCls": "yellow-trolley_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.gridReceipt.getSelection();\
var ids = \"\";\
Wb.each(sels, function(sel) {\
  ids += \"'\" + sel.data.ID + \"',\";\
});\
ids = ids.substring(0, ids.length - 1);\
var win = new Ext.window.Window(app._winCar_team);\
win.show();\
app.ids.setValue(ids);"}
         },
         {
          "configs": {
           "itemId": "popupUpd",
           "text": "修改信息",
           "iconCls": "table_edit_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.gridReceipt.getSelection();\
var ids = \"\";\
Wb.each(sels, function(sel) {\
  ids += \"'\" + sel.data.ID + \"',\";\
});\
ids = ids.substring(0, ids.length - 1);\
var win = new Ext.window.Window(app._winUpd);\
win.show();\
app.idsupd.setValue(ids);\
app.PLAN_STIME.setValue(sels[0].data.PLAN_STIME);"}
         },
         {
          "configs": {
           "itemId": "popupAddFee",
           "text": "补充费用",
           "iconCls": "add_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var rowData = app.menuR.selectRow.data; //selectRow在popupMenu的show事件中设置\
var win = new Ext.window.Window(app._winAccDetails); //app._win指向配置对象而非实例\
win.setTitle(\"补充费用\");\
win.show();\
app.RID_A.setValue(rowData.ID);\
app.CNTR.setValue(rowData.CNTR);"}
         },
         {
          "configs": {
           "itemId": "popupShuai",
           "text": "甩卡",
           "iconCls": "yellow-trolley_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var rowData = app.menuR.selectRow.data; //selectRow在popupMenu的show事件中设置\
var win = new Ext.window.Window(app._winShuai); //app._win指向配置对象而非实例\
win.show();\
app.shuaiid.setValue(rowData.ID);"}
         }
        ],
        "type": "menu",
        "events": {"show": "var nature = \"{#sys.NATURE#}\";\
var rows = app.gridReceipt.getSelection();\
app.popupClean.setDisabled(rows.length != 1 || rows[0].data.PHASE != \"EXE\");\
app.popupUpd.setDisabled(rows.length < 1 || (rows[0].data.PHASE != \"EXE\" && rows[0].data.PHASE != \"PLN\"));\
app.popupAddFee.setDisabled(rows.length != 1);\
menu.selectRow = rows[0];"}
       }
      ],
      "type": "grid",
      "events": {"itemclick": "var nature = \"{#sys.NATURE#}\";\
Wb.setValue(app.panelForm, record.data);\
app.RID.setValue(record.data.ID);\
app.CNTR.setValue(record.data.NO_CNTR == \"1\" ? record.data.BILL_NO : record.data.CNTR);\
app.RID1.store.load({\
  callback: function(r, options, success) { //r:返回的数据,r.length,r[0].data.属性 success:是否回调成功,true,false\
    if (success) {\
      app.RID1.setValue(record.data.RID1);\
    }\
  }\
});\
app.IN_CAR.store.load({\
  params: {\
    carteam: record.data.CAR_TEAM\
  },\
  callback: function(r, options, success) {\
    if (success) {\
      app.IN_CAR.setValue(record.data.IN_CAR);\
    }\
  }\
});\
app.IN_CAMPI.store.load({\
  callback: function(r, options, success) {\
    if (success) {\
      app.IN_CAMPI.setValue(record.data.IN_CAMPI);\
    }\
  }\
});\
app.IN_DRIVER_ID.store.load({\
  callback: function(r, options, success) {\
    if (success) {\
      app.IN_DRIVER_ID.setValue(record.data.IN_DRIVER_ID);\
    }\
  }\
});\
app.OUT_CAR.store.load({\
  params: {\
    carteam: record.data.CAR_TEAM\
  },\
  callback: function(r, options, success) {\
    if (success) {\
      app.OUT_CAR.setValue(record.data.OUT_CAR);\
    }\
  }\
});\
app.OUT_CAMPI.store.load({\
  callback: function(r, options, success) {\
    if (success) {\
      app.OUT_CAMPI.setValue(record.data.OUT_CAMPI);\
    }\
  }\
});\
app.OUT_DRIVER_ID.store.load({\
  callback: function(r, options, success) {\
    if (success) {\
      app.OUT_DRIVER_ID.setValue(record.data.OUT_DRIVER_ID);\
    }\
  }\
});\
Wb.loadComboAdd(app.S_ADRESS, [{\
  \"ID\": record.data.S_ADRESS,\
  \"NAME\": record.data.CNAME\
}], function() {\
  app.S_ADRESS.setValue(record.data.S_ADRESS);\
});\
app.FEI_ADDDRESS.store.load({\
  callback: function(r, options, success) {\
    if (success) {\
      app.FEI_ADDDRESS.setValue(record.data.FEI_ADDDRESS);\
    }\
  }\
});\
app.CAR_TEAM.store.load({\
  callback: function(r, options, success) {\
    if (success) {\
      app.CAR_TEAM.setValue(record.data.CAR_TEAM);\
    }\
  }\
});\
//货主赋值\
Wb.loadComboAdd(app.SHIP_CONSIGN_COD, [{\
  \"ID\": record.data.SHIP_CONSIGN_COD,\
  \"CNAME\": record.data.SHIPPER_CONSIGNEE\
}], function() {\
  app.SHIP_CONSIGN_COD.setValue(record.data.SHIP_CONSIGN_COD);\
  app.SHIPPER_CONSIGNEE.setValue(record.data.SHIPPER_CONSIGNEE);\
});\
if (nature == \"5\" && record.data.SHIPPER_WAY == \"1\") {\
  app.IN_CAR.setReadOnly(true);\
  app.IN_CAMPI.setReadOnly(true);\
  app.IN_DRIVER_ID.setReadOnly(true);\
  app.OUT_CAR.setReadOnly(true);\
  app.OUT_CAMPI.setReadOnly(true);\
  app.OUT_DRIVER_ID.setReadOnly(true);\
  app.S_ADRESS.setReadOnly(true);\
  app.FEI_ADDDRESS.setReadOnly(true);\
  app.CAR_TEAM.setReadOnly(true);\
  app.SHIPPER_WAY.setReadOnly(true);\
  app.SHIP_CONSIGN_COD.setReadOnly(true);\
  app.SHUN_INVERSE.setReadOnly(true);\
  app.RID1.setReadOnly(true);\
  app.btnpai.setDisabled(true);\
} else {\
  if (record.data.PHASE == 'OUT') { //转关设备交接单\
    app.IN_CAR.setReadOnly(true);\
    app.IN_CAMPI.setReadOnly(true);\
    app.IN_DRIVER_ID.setReadOnly(true);\
    app.OUT_CAR.setReadOnly(false);\
    app.OUT_CAMPI.setReadOnly(true);\
    app.OUT_DRIVER_ID.setReadOnly(false);\
    app.S_ADRESS.setReadOnly(true);\
    app.FEI_ADDDRESS.setReadOnly(true);\
    app.CAR_TEAM.setReadOnly(true);\
    app.SHIPPER_WAY.setReadOnly(true);\
    app.SHIP_CONSIGN_COD.setReadOnly(true);\
    app.SHUN_INVERSE.setReadOnly(true);\
    app.RID1.setReadOnly(true);\
    app.btnpai.setDisabled(false);\
  } else if (record.data.PHASE == 'PLN' || record.data.PHASE == 'EXE') {\
    if (record.data.CNTR_SIZE == \"20\")\
      app.RID1.setReadOnly(false);\
    else\
      app.RID1.setReadOnly(true);\
    if (record.data.WORK_TYPE == \"FITC\" || record.data.WORK_TYPE == \"EITC\") {\
      app.IN_CAR.setReadOnly(true);\
      app.IN_CAMPI.setReadOnly(true);\
      app.IN_DRIVER_ID.setReadOnly(true);\
      app.OUT_CAMPI.setReadOnly(false);\
    } else {\
      app.IN_CAR.setReadOnly(false);\
      app.IN_CAMPI.setReadOnly(false);\
      app.IN_DRIVER_ID.setReadOnly(false);\
      app.OUT_CAMPI.setReadOnly(true);\
    }\
    if (nature != \"5\" && nature != \"6\") {\
      app.CAR_TEAM.setReadOnly(false);\
      app.SHIPPER_WAY.setReadOnly(true);\
      app.SHIP_CONSIGN_COD.setReadOnly(false);\
    } else if (nature == \"5\") {\
      if (record.data.CNTR_OPERATOR_COD == customcode) {\
        app.CAR_TEAM.setReadOnly(false);\
        app.SHIPPER_WAY.setReadOnly(false);\
        app.SHIP_CONSIGN_COD.setReadOnly(false);\
      }\
    } else if (nature == \"6\") {\
      app.CAR_TEAM.setReadOnly(true);\
      app.SHIPPER_WAY.setReadOnly(true);\
      app.SHIP_CONSIGN_COD.setReadOnly(true);\
    }\
    app.OUT_CAR.setReadOnly(false);\
    app.OUT_DRIVER_ID.setReadOnly(false);\
    app.S_ADRESS.setReadOnly(false);\
    app.FEI_ADDDRESS.setReadOnly(false);\
    app.SHUN_INVERSE.setReadOnly(false);\
    app.btnpai.setDisabled(false);\
  } else {\
    app.IN_CAR.setReadOnly(true);\
    app.IN_CAMPI.setReadOnly(true);\
    app.IN_DRIVER_ID.setReadOnly(true);\
    app.OUT_CAR.setReadOnly(true);\
    app.OUT_CAMPI.setReadOnly(true);\
    app.OUT_DRIVER_ID.setReadOnly(true);\
    app.S_ADRESS.setReadOnly(true);\
    app.FEI_ADDDRESS.setReadOnly(true);\
    app.CAR_TEAM.setReadOnly(true);\
    app.SHIPPER_WAY.setReadOnly(true);\
    app.SHIP_CONSIGN_COD.setReadOnly(true);\
    app.SHUN_INVERSE.setReadOnly(true);\
    app.RID1.setReadOnly(true);\
    app.btnpai.setDisabled(true);\
  }\
}"}
     },
     {
      "configs": {
       "itemId": "moveGrid",
       "multiColumnSort": "true",
       "editable": "true",
       "disabled": "false",
       "viewConfig": "{\
  'itemcontextmenu': function(view, record, item, index, e, eOpts) {\
    //禁用浏览器的右键相应事件  \
    e.preventDefault();\
    e.stopEvent();\
  }\
}",
       "region": "south",
       "multiSelect": "true",
       "height": "150"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "sortOnLoad": "true",
         "itemId": "store",
         "pageSize": "1000",
         "url": "m?xwl=truckManager/truckReceipt/receiptTruck_xl/moveListSelect"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": false,
        "children": [
         {
          "configs": {
           "itemId": "column1",
           "renderer": "if (app.taskType == 'VOUT' || app.taskType == 'VIN') {\
  if (record.data.IV == 0)\
    metaData.style = 'background-color:red;';\
  else if (record.data.CNUM > 1)\
    metaData.style = 'background-color:yellow;';\
}\
return rowIndex + 1;",
           "xtype": "rownumberer"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "PHASE",
           "renderer": "var map = {\
  PLN: '计划',\
  SND: '发送',\
  CNL: '撤销',\
  EXE: '执行',\
  TMP: '暂存',\
  FIN: '完成'\
};\
var color = app.TASK_STATE && app.TASK_STATE[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return map[value] || value;",
           "dataIndex": "PHASE",
           "width": "40",
           "text": "状态",
           "align": "center"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR99",
           "renderer": "if (record.data.PRIORITY == 2)\
  metaData.style = 'background-color:red;';\
return value;",
           "dataIndex": "CNTR",
           "width": "90",
           "text": "箱号"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "C_CNTR_SIZ",
           "dataIndex": "CNTR_SIZE",
           "width": "40",
           "text": "尺寸"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "C_CNTR_TYP99",
           "dataIndex": "CNTR_TYPE",
           "width": "40",
           "keyName": "CNTR_TYPE",
           "text": "类型"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "FROM_POS",
           "dataIndex": "FROM_POS",
           "width": "65",
           "text": "起点"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TO_POS",
           "dataIndex": "TO_POS",
           "width": "65",
           "text": "终点"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "isUpperCase": "true"
           },
           "expanded": false,
           "children": [],
           "type": "text",
           "events": {"specialkey": "if (e.keyCode == 13) {\
  var record = app.moveGrid.findPlugin('cellediting').context.record;\
  var param = {\
    to_pos: text.value,\
    moves: [record.raw.ID],\
    ship: record.raw.ship,\
    type: app.treeTask.getSelection()[0].parentNode.data.id,\
    taskId: app.taskId\
  };\
  Wb.request({\
    url: \"m?xwl=controlManage/task/worktaskcraneedit/modifyToPos\",\
    params: param,\
    success: function() {\
      record.commit();\
    }\
  });\
}"}
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CREATED_ON99",
           "dataIndex": "CREATED_ON",
           "text": "创建时间"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "UPDATED_ON99",
           "dataIndex": "UPDATED_ON",
           "text": "修改时间"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "BILL_NO",
           "dataIndex": "BILL_NO",
           "text": "提单号码"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CMDY_CODE",
           "dataIndex": "CMDY_CODE",
           "text": "货物名称"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "RELEASE_ID",
           "renderer": "if (top.Wb.yardCfsMap) //过虑不需要显示放行信息的记录\
{\
  if (record.data.TRADE_ID != '1') //内贸\
    return '';\
  if (app.taskType == 'GIN') //入闸\
    return '';\
  if (!(record.data.FROM_POS_TYP == 'V' || record.data.TO_POS_TYP == 'V')) //不是装卸船\
  {\
    var fromCfs = top.Wb.yardCfsMap[record.data.FROM_POS.substr(0, 2)] || 'JGQ';\
    if(app.taskType == 'GOUT' && fromCfs !='JGQ')//非监管区出闸\
      return '';\
    var toCfs = top.Wb.yardCfsMap[record.data.TO_POS.substr(0, 2)] || (record.data.TO_POS_TYP == 'B' ? 'JGQ' : undefined);\
    if (fromCfs == toCfs ||  !(toCfs == 'JGQ' || fromCfs == 'JGQ') || toCfs=='JGQ')\
      return '';\
  }\
}\
var color = value == '1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";\
return value == '1' ? '已放行' : '未放行';",
           "dataIndex": "RELEASE_ID",
           "width": "50",
           "text": "海关"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CARD_WRITE_ID",
           "renderer": "/*var color = value =='1' ? 'green' : 'red';\
metaData.style = 'background-color:' + color + \";\";*/\
return value =='1' ? '已写卡' : '';",
           "dataIndex": "CARD_WRITE_ID",
           "width": "50",
           "text": "已写卡"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "E_F_ID",
           "renderer": "var color = app.E_F_ID && app.E_F_ID[value] || '#bbbbbb';\
metaData.style = 'background-color:' + color + \";\";\
return value === 'P' ? '拼柜' : value === 'F' ? '重柜' : '吉柜';",
           "dataIndex": "E_F_ID",
           "width": "40",
           "text": "吉重"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS199",
           "dataIndex": "TRCLASS1",
           "width": "40",
           "text": "机械类型1"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1995",
           "dataIndex": "TRANSPORTER1",
           "width": "40",
           "text": "机械1"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1991",
           "dataIndex": "TRCLASS2",
           "width": "40",
           "text": "机械类型2"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19911",
           "dataIndex": "TRANSPORTER2",
           "width": "40",
           "text": "机载2"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1992",
           "dataIndex": "TRCLASS3",
           "width": "40",
           "text": "机械类型3"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19921",
           "dataIndex": "TRANSPORTER3",
           "width": "40",
           "text": "机载3"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1993",
           "dataIndex": "TRCLASS4",
           "width": "40",
           "text": "机械类型4"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19931",
           "dataIndex": "TRANSPORTER4",
           "width": "40",
           "text": "机械4"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS1994",
           "dataIndex": "TRCLASS5",
           "text": "机械类型5"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRCLASS19941",
           "dataIndex": "TRANSPORTER5",
           "text": "机械5"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "FROM_YPOINT99",
           "dataIndex": "FROM_YPOINT",
           "text": "起始坐标"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TO_XPOINT99",
           "dataIndex": "TO_XPOINT",
           "text": "目标坐标"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "ORIGIN99",
           "dataIndex": "CARRIER_CODE",
           "text": "原始位置"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CARRIER_ATA99",
           "dataIndex": "CARRIER_ATA",
           "text": "来的时间"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SAFE_WT99",
           "dataIndex": "SAFE_WT",
           "text": "安全重量"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SCALE_WT99",
           "dataIndex": "SCALE_WT",
           "text": "过磅重量"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SERVICE99",
           "dataIndex": "SERVICE",
           "text": "航线"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "OPL99",
           "dataIndex": "POL",
           "width": "60",
           "text": "装货港"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "OPL991",
           "dataIndex": "POD",
           "width": "60",
           "text": "目的港"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRUCKING_CO99",
           "dataIndex": "TRUCKING_CO",
           "text": "车队"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "TRANSPORTER199",
           "dataIndex": "TRANSPORTER1",
           "text": "作业机械"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "LINE99",
           "dataIndex": "LINE",
           "width": "120",
           "text": "船公司"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CREATED_MAN99",
           "hidden": "true",
           "dataIndex": "CREATED_BY",
           "text": "创建人"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "UPDATED_MAN99",
           "hidden": "true",
           "dataIndex": "UPDATED_BY",
           "text": "修改人"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_LENGTH99",
           "hidden": "true",
           "dataIndex": "CNTR_LENGTH",
           "text": "长度"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_HIGHT99",
           "hidden": "true",
           "dataIndex": "CNTR_HIGHT",
           "text": "高度"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "OVERHEIGHT99",
           "hidden": "true",
           "dataIndex": "OVERHEIGHT",
           "text": "超重"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "POSITION_STATUS99",
           "dataIndex": "POSITION_STATUS",
           "text": "位置状态"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "notes",
           "dataIndex": "NOTES",
           "text": "备注信息"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       },
       {
        "configs": {
         "itemId": "popupMenu",
         "normalName": "menu1"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "popupComp",
           "tooltip": "查看在场箱信息",
           "text": "查看在场箱信息",
           "iconCls": "property_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "Wb.run({\
  url: 'm?xwl=controlManage/portcntr/control-module',\
  params: {\
    ID: app.moveGrid.selModel.lastFocused.data.CNTR_ID\
  },\
  success: function(appnew) {\
    var wins = new Ext.window.Window(appnew._cntrWin);\
    app.test = appnew.test;\
 // win.setPosition(\"100\",\"400\");\
\
    wins.show();\
  }\
});"}
         },
         {
          "configs": {
           "itemId": "writeCardBtn",
           "tooltip": "写卡",
           "text": "写卡",
           "iconCls": "book_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "app.card.writeCardWin.HANDLE_ID = app.moveGrid.selModel.lastFocused.data.ID;\
app.card.writeCardWin.show();"}
         },
         {
          "configs": {
           "itemId": "modifyCyBtn",
           "tooltip": "指定目标场位",
           "text": "指定目标场位",
           "iconCls": "boxs_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveGrid.getSelection();\
if (!(sels && sels.length))\
  return;\
var olds = [];\
var moves = [];\
Wb.each(sels, function(r) {\
  if ((r.data.TO_POS_TYP === 'B' || r.data.TO_POS_TYP === 'V' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN') {\
    if (olds.indexOf(r.data.TO_POS)== -1)\
      olds.push(r.data.TO_POS);\
    moves.push(r.data.ID);\
  }\
});\
Wb.setValue(app.toPosWin, {\
  old_pos: olds ? olds.join(',') : '',\
  to_pos: ''\
});\
app.toPosWin.moves = moves;\
app.toPosWin.show();"}
         },
         {
          "configs": {
           "itemId": "popupPrint",
           "tooltip": "放行条",
           "text": "放行条",
           "iconCls": "yellow-orders_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sel = app.moveGrid.getSelection()[0];\
var tenancyid = \"{#sys.TENANCY_ID#}\";\
var whereSql = encodeURI(\" and r.tenancy_id='\" + tenancyid + \"' and r.id='\" + sel.data.HANDLE_ID + \"'\");\
var AF1 = document.getElementById(opt);\
AF1.func(\"SetParas\", \"ds1 \\r\\
 para=1;whereSql=\" + whereSql);\
var cfsCod = Wb.yardCfsMap[sel.data.TO_POS.substr(0, 2)];\
\
if (cfsCod == \"NMQ\") {\
  AF1.func(\"SetCellData\", \"<data B4='出口拼柜仓' B18='出口拼柜仓' B33='出口拼柜仓' B47='出口拼柜仓'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}\
if (cfsCod == \"LN\") {\
  AF1.func(\"SetCellData\", \"<data B4='路南' B18='路南' B33='路南' B47='路南'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}\
\
if (cfsCod == \"JGQ\") {\
  AF1.func(\"SetCellData\", \"<data B4='监管区' B18='监管区' B33='监管区' B47='监管区'/>\");\
  AF1.func(\"Calc\", \"\");\
  AF1.func(\"callfunc\", \"18\");\
}"}
         },
         {
          "configs": {
           "itemId": "popupTruck",
           "tooltip": "换车",
           "text": "换车",
           "iconCls": "vans_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveGrid.getSelection();\
if (!(sels && sels.length))\
  return;\
var olds = [];\
var moves = [];\
Wb.each(sels, function(r) {\
  moves.push(r.data.ID);\
  for (var i = 1; i < 5; ++i)\
    if (r.data['TRCLASS' + i] == 'TG') {\
      var truck = r.data['TRANSPORTER' + i];\
      if (!olds.includes(truck))\
        olds.push(truck);\
      break;\
    }\
});\
Wb.setValue(app.truckWin, {\
  old_truck: olds ? olds.join(',') : '',\
  truck: ''\
});\
app.truckWin.moves = moves;\
app.truckWin.show();"}
         },
         {
          "configs": {
           "itemId": "popupCyBack",
           "tooltip": "返场",
           "text": "返场",
           "iconCls": "yellow-crane_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "app.cyBackWin.show();\
Wb.setValue(app.cyBackWin, {\
  old_pos: app.moveGrid.selModel.lastFocused.data.FROM_POS\
});"}
         },
         {
          "configs": {
           "itemId": "popupGateCnl",
           "tooltip": "取消进门",
           "text": "取消进门",
           "iconCls": "first_icon"
          },
          "expanded": false,
          "children": [],
          "type": "item",
          "events": {"click": "var sels = app.moveGrid.getSelection();\
if (sels.length < 0)\
  return;\
Wb.request({\
  url: 'm?xwl=receiptInout/gate/gatebackedit/gateTiBack',\
  params: {\
    cntr: sels[0].data.CNTR\
  },\
  success: function(resp) {\
    var ret = JSON.parse(resp.responseText);\
    if(!ret.success)\
      Wb.error(ret.errstr);\
    else\
    {\
      Wb.info('取消成功');\
      app.treeTask.store.reload();\
    }\
  }\
});"}
         }
        ],
        "type": "menu",
        "events": {"show": "var rows = app.moveGrid.getSelection();\
if (!(rows && rows[0])) {\
  menu.hide();\
  return;\
}\
\
\
\
\
// //启用按钮是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return r.data.ENABLE_ID === 0;\
//   }))\
//   menu.down(\"#enableBtn\").show();\
// else\
//   menu.down(\"#enableBtn\").hide();\
\
// //取消按钮是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return r.data.ENABLE_ID === 1;\
//   }))\
//   menu.down(\"#disableBtn\").show();\
// else\
//   menu.down(\"#disableBtn\").hide();\
\
// //写卡按钮是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return r.data.RELEASE_ID == 1 && (r.data.Y2Y_ID === 1 || r.data.TO_POS_TYP === 'G' || r.data.FROM_POS_TYP === 'G');\
//   }))\
//   menu.down(\"#writeCardBtn\").show();\
// else\
//   menu.down(\"#writeCardBtn\").hide();\
\
\
\
// //修改场位是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return (r.data.TO_POS_TYP === 'B' || r.data.TO_POS_TYP === 'V' || r.data.TRCLASS4 === 'YC') && r.data.PHASE !== 'FIN';\
//   }))\
//   menu.down(\"#modifyCyBtn\").show();\
// else\
//   menu.down(\"#modifyCyBtn\").hide();\
\
\
\
// //撤销是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return r.data.PHASE === 'PLN';\
//   }))\
//   menu.down(\"#popupRevoke\").show();\
// else\
//   menu.down(\"#popupRevoke\").hide();\
\
// //返场是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return r.data.TO_POS_TYP === 'G' && r.data.PHASE === 'EXE';\
//   }))\
//   menu.down(\"#popupCyBack\").show();\
// else\
//   menu.down(\"#popupCyBack\").hide();\
\
// //取消进门是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return r.data.TO_POS_TYP === 'G' && r.data.PHASE === 'SND';\
//   }))\
//   menu.down(\"#popupGateCnl\").show();\
// else\
//   menu.down(\"#popupGateCnl\").hide();\
\
\
\
\
\
// //打印放行条是否可见\
// if (Ext.Array.findBy(rows, function(r) {\
//     return r.data.Y2Y_ID;\
//   }))\
//   menu.down(\"#popupPrint\").show();\
// else\
//   menu.down(\"#popupPrint\").hide();"}
       }
      ],
      "type": "grid",
      "events": {"afterrender": "grid.store.sort('CREATED_ON','DESC');"}
     }
    ],
    "type": "viewport",
    "events": {"afterrender": "viewport.el.addKeyListener(Ext.EventObject.F8, function() {\
  app.btnpai.fireEvent(\"click\");\
});"}
   }
  ],
  "type": "module",
  "events": {
   "finalize": "// app.tbI_E_ID.setValue(\"I\");\
app.tbPHASE.setValue(\"PLN\");\
app.searchRBtn.fireEvent('click');\
\
app.xwl1.subscribe('/exchange/ex_receipt/#', function(d) {\
  var msg = d.body;\
  var record = app.gridReceipt.store.data.findBy(function(i, k) {\
    return i.data.ID === msg.data.ID;\
  });\
  app.searchRBtn.fireEvent('click');\
  //   switch (msg.info.action) {\
  //     case 'create':\
  //       if (!record)\
  //         Wb.add(app.gridReceipt, msg.data);\
  //       break;\
  //     case 'update':\
  //       if (record)\
  //         Wb.update(record, msg.data);\
  //       break;\
  //     case 'delete':\
  //       if (record) {\
  //         app.gridReceipt.setSelection([record]);\
  //         Wb.remove(app.gridReceipt);\
  //       }\
  //       break;\
  //     default:\
  //       console.log(msg);\
  //       break;\
  //   }\
});",
   "initialize": "Wb.apply(app, {\
  pt_type: function(cp) {\
    if (app.SHIPPER_WAY.getValue() == \"1\" && app.IN_CAR.displayTplData[0].NAME.indexOf(\"小榄港\") != -1)\
      app.PT_TYPE.setValue(\"1\");\
    if (app.SHIPPER_WAY.getValue() == \"1\" && app.IN_CAR.displayTplData[0].NAME.indexOf(\"港航集装箱\") != -1)\
      app.PT_TYPE.setValue(\"1\");\
    else if (app.SHIPPER_WAY.getValue() == \"1\" && app.IN_CAR.displayTplData[0].NAME == \"金信\")\
      app.PT_TYPE.setValue(\"1\");\
    else\
      app.PT_TYPE.setValue(\"2\");\
    //app.CAR_TEAM.setValue(app.IN_CAR.displayTplData[0].TRUCK_UNIT);\
  }\
});"
  }
 }],
 "roles": {
  "ZSGWCD": 1,
  "xlcd": 1
 },
 "title": "小榄内贸集装箱派车",
 "iconCls": "",
 "inframe": false,
 "pageLink": ""
}