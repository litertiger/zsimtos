{
 "hidden": false,
 "children": [{
  "configs": {
   "itemId": "module",
   "serverScript": "app.log(request.getParameter(\"WID\"));"
  },
  "expanded": true,
  "children": [
   {
    "configs": {
     "layout": "absolute",
     "dialog": "true",
     "itemId": "customWin",
     "resizable": "true",
     "closeAction": "hide",
     "width": "817",
     "title": "新增客户",
     "autoScroll": "true",
     "height": "560"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "itemId": "ID",
       "hidden": "true",
       "x": "416",
       "width": "240",
       "y": "400",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "CODE",
       "allowBlank": "false",
       "labelAlign": "right",
       "fieldLabel": "客户代码",
       "width": "192",
       "x": "8",
       "y": "16",
       "isUpperCase": "true",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text",
      "events": {"change": "// text.setValue(newValue.toUpperCase());\
"}
     },
     {
      "configs": {
       "itemId": "NAME",
       "allowBlank": "false",
       "labelAlign": "right",
       "fieldLabel": "中文名称",
       "width": "376",
       "x": "184",
       "y": "16",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "SHORT_NAME",
       "labelAlign": "right",
       "fieldLabel": "中文简称",
       "width": "216",
       "x": "552",
       "y": "16",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "E_SHORT_NAME",
       "labelAlign": "right",
       "fieldLabel": "英文简称",
       "width": "208",
       "x": "352",
       "y": "48",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text",
      "events": {"change": "text.setValue(newValue.toUpperCase());"}
     },
     {
      "configs": {
       "itemId": "CLIENT_TYPE",
       "allowBlank": "false",
       "fieldLabel": "客户类型",
       "x": "328",
       "width": "192",
       "keyName": "CLIENT_TYPE",
       "y": "80",
       "labelWidth": "70",
       "height": "24",
       "multiSelect": "true"
      },
      "expanded": true,
      "children": [],
      "type": "combo"
     },
     {
      "configs": {
       "itemId": "AREA_CODE",
       "allowBlank": "false",
       "fieldLabel": "所属区域",
       "x": "574",
       "width": "194",
       "keyName": "C_COUNTRY",
       "y": "80",
       "labelWidth": "70",
       "forceSelection": "true",
       "height": "23"
      },
      "expanded": true,
      "children": [],
      "type": "combo",
      "events": {
       "select": "app.AREA.setValue(combo.getRawValue());",
       "change": "if (Wb.isEmpty(newValue))\
  app.AREA.setValue(\"\");"
      }
     },
     {
      "configs": {
       "itemId": "AREA",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "所属区域",
       "width": "216",
       "x": "504",
       "y": "64",
       "labelWidth": "70",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "ADDRESS",
       "allowBlank": "false",
       "labelAlign": "right",
       "fieldLabel": "联系地址",
       "width": "360",
       "x": "8",
       "y": "112",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "ABLETIME",
       "x": "648",
       "width": "120",
       "y": "48",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "date"
     },
     {
      "configs": {
       "itemId": "label1",
       "x": "582",
       "width": "88",
       "y": "48",
       "text": "有效时间：",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "label"
     },
     {
      "configs": {
       "itemId": "ZIP",
       "labelAlign": "right",
       "fieldLabel": "邮政编码",
       "width": "192",
       "x": "360",
       "y": "112",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "BIZ_LINKMAN",
       "labelAlign": "right",
       "fieldLabel": "业务联系人",
       "width": "216",
       "x": "552",
       "y": "144",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "TEL",
       "allowBlank": "false",
       "labelAlign": "right",
       "fieldLabel": "电话",
       "width": "192",
       "x": "8",
       "y": "144",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "TELEX",
       "labelAlign": "right",
       "fieldLabel": "电传",
       "width": "200",
       "x": "168",
       "y": "144",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "FAX",
       "labelAlign": "right",
       "fieldLabel": "传真",
       "width": "208",
       "x": "344",
       "y": "144",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "FINANCE_LINKMAN",
       "labelAlign": "right",
       "fieldLabel": "财务联系人",
       "width": "216",
       "x": "552",
       "y": "112",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "EMAIL",
       "labelAlign": "right",
       "fieldLabel": "email地址",
       "width": "328",
       "x": "8",
       "y": "176",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "EMAIL_FILE",
       "labelAlign": "right",
       "fieldLabel": "邮箱文件",
       "width": "208",
       "x": "344",
       "y": "176",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "WEBSITE",
       "labelAlign": "right",
       "fieldLabel": "网站地址",
       "width": "328",
       "x": "8",
       "y": "208",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "REMARK",
       "labelAlign": "right",
       "fieldLabel": "备注",
       "width": "760",
       "x": "8",
       "y": "240",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "FILE_FORMAT",
       "labelAlign": "right",
       "fieldLabel": "文件格式",
       "width": "216",
       "x": "552",
       "y": "176",
       "labelWidth": "90",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "PROTOCOL_ABLETIME",
       "hidden": "true",
       "fieldLabel": "协议有效期",
       "x": "320",
       "width": "200",
       "y": "528",
       "labelWidth": "70",
       "height": "32"
      },
      "expanded": false,
      "children": [],
      "type": "date"
     },
     {
      "configs": {
       "itemId": "PAY_TYPE",
       "hidden": "true",
       "pickList": "[[1,'支票'], [2,'现金'], [3,'预售'], [4,'转账']]",
       "x": "120",
       "width": "136",
       "y": "536",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "combo"
     },
     {
      "configs": {
       "itemId": "ACCOUNT_TYPE",
       "allowBlank": "false",
       "hidden": "true",
       "pickList": "[[1,'即结'], [2,'月结']]",
       "x": "344",
       "width": "128",
       "y": "560",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "combo"
     },
     {
      "configs": {
       "itemId": "label21",
       "hidden": "true",
       "x": "56",
       "width": "64",
       "y": "536",
       "text": "付款方式：",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "label"
     },
     {
      "configs": {
       "itemId": "label211",
       "hidden": "true",
       "x": "280",
       "width": "64",
       "y": "560",
       "text": "结算方式：",
       "height": "23"
      },
      "expanded": false,
      "children": [],
      "type": "label"
     },
     {
      "configs": {
       "itemId": "CREATEUSER",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "录入人员",
       "width": "224",
       "x": "8",
       "y": "336",
       "labelWidth": "90",
       "disabled": "true",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "UPDATEUSER",
       "hidden": "true",
       "labelAlign": "right",
       "fieldLabel": "最近修改人",
       "width": "216",
       "x": "552",
       "y": "336",
       "labelWidth": "90",
       "disabled": "true",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "EMPTY_PRICE_TYPE",
       "hidden": "true",
       "pickList": "[[1,'免天方式'], [2,'按保有量'], [3,'箱管理费']]",
       "x": "408",
       "width": "112",
       "y": "496",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "combo"
     },
     {
      "configs": {
       "itemId": "label22",
       "hidden": "true",
       "x": "320",
       "width": "88",
       "y": "496",
       "text": "空箱计费方式：",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "label"
     },
     {
      "configs": {
       "itemId": "MIN_CONTAINER",
       "minValue": "0",
       "hidden": "true",
       "fieldLabel": "保有量",
       "x": "560",
       "width": "176",
       "y": "496",
       "labelWidth": "50",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "number"
     },
     {
      "configs": {
       "itemId": "CREATETIME",
       "hidden": "true",
       "fieldLabel": "录入时间",
       "x": "256",
       "width": "272",
       "y": "336",
       "labelWidth": "60",
       "disabled": "true",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "datetime"
     },
     {
      "configs": {
       "itemId": "UPDATETIME",
       "hidden": "true",
       "fieldLabel": "最近修改时间",
       "x": "16",
       "width": "312",
       "y": "368",
       "labelWidth": "85",
       "disabled": "true",
       "height": "24"
      },
      "expanded": false,
      "children": [],
      "type": "datetime"
     },
     {
      "configs": {
       "itemId": "CREDIT_LIMIT",
       "hidden": "true",
       "fieldLabel": "信用额度",
       "x": "552",
       "width": "184",
       "y": "528",
       "labelWidth": "70",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "number"
     },
     {
      "configs": {
       "itemId": "RESERVE_PRICE",
       "hidden": "true",
       "fieldLabel": "备用金额",
       "x": "544",
       "width": "192",
       "y": "560",
       "labelWidth": "70",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "number"
     },
     {
      "configs": {
       "itemId": "GOV_CODE",
       "allowBlank": "false",
       "labelAlign": "right",
       "fieldLabel": "统一社会信用代码",
       "width": "288",
       "x": "8",
       "y": "80",
       "labelWidth": "90",
       "height": "32"
      },
      "expanded": false,
      "children": [],
      "type": "text",
      "events": {"change": "text.setValue(newValue.toUpperCase());"}
     },
     {
      "configs": {
       "itemId": "STATE_FLAG",
       "hidden": "true",
       "x": "368",
       "width": "240",
       "y": "368",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "tagConfigs": " matchFieldWidth:false",
       "queryMode": "remote",
       "labelWidth": "60",
       "listConfig": "{width:450}",
       "valueField": "ID",
       "queryDelay": "1",
       "itemId": "SUBCOMPANY",
       "tpl": "<table cellspacing='0' width='100%'>\
   <tr  >\
      <td width='105px'>\
       代码\
      <\/td>\
      <td>\
       中文名\
      <\/td>\
    <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td >\
        {ID}\
      <\/td>\
      <td>\
       {CNAME}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
       "labelAlign": "right",
       "fieldLabel": "所属公司",
       "x": "344",
       "width": "200",
       "y": "208",
       "displayField": "CNAME",
       "anyMatch": "true",
       "forceSelection": "true",
       "height": "22"
      },
      "expanded": false,
      "children": [{
       "configs": {
        "itemId": "store",
        "autoLoad": "true",
        "pageSize": "-1",
        "params": "{fldId:\"CM\"}",
        "url": "m?xwl=system/customer/customer/clientSelect"
       },
       "expanded": false,
       "children": [],
       "type": "store"
      }],
      "type": "combo"
     },
     {
      "configs": {
       "layout": "fit",
       "itemId": "customer",
       "hidden": "true",
       "x": "16",
       "width": "754",
       "y": "272",
       "title": "顾客代码维护",
       "height": "240"
      },
      "expanded": false,
      "children": [{
       "configs": {
        "itemId": "customerGrid",
        "submitSelect": "true",
        "selType": "checkboxmodel",
        "sortableColumns": "false",
        "simpleSelect": "true",
        "pagingBar": "false",
        "iconCls": "cube_icon",
        "multiSelect": "true"
       },
       "expanded": true,
       "children": [
        {
         "configs": {
          "itemId": "store",
          "remoteSort": "true",
          "autoLoad": "true",
          "pageSize": "-1",
          "url": "m?xwl=system/customer/customer/selectCus"
         },
         "expanded": false,
         "children": [],
         "type": "store"
        },
        {
         "configs": {"itemId": "columns"},
         "expanded": true,
         "children": [
          {
           "configs": {
            "itemId": "id",
            "hidden": "true",
            "dataIndex": "ID",
            "flex": "1",
            "text": "编号"
           },
           "expanded": false,
           "children": [],
           "type": "column"
          },
          {
           "configs": {
            "itemId": "id1",
            "dataIndex": "ORG_NAME",
            "flex": "1",
            "text": "驳船名"
           },
           "expanded": false,
           "children": [],
           "type": "column"
          },
          {
           "configs": {
            "itemId": "tenancyId",
            "dataIndex": "TENANCY_ID",
            "text": "租户"
           },
           "expanded": false,
           "children": [],
           "type": "column"
          },
          {
           "configs": {
            "itemId": "orgType",
            "renderer": "return  '驳船';",
            "dataIndex": "ORG_TYPE",
            "text": "组织类型"
           },
           "expanded": false,
           "children": [],
           "type": "column"
          },
          {
           "configs": {
            "itemId": "orgCode",
            "dataIndex": "ORG_CODE",
            "text": "代码"
           },
           "expanded": false,
           "children": [],
           "type": "column"
          },
          {
           "configs": {
            "itemId": "shortCod",
            "hidden": "true",
            "dataIndex": "SHORT_COD",
            "text": "驳船编号"
           },
           "expanded": false,
           "children": [],
           "type": "column"
          }
         ],
         "type": "array"
        }
       ],
       "type": "grid",
       "events": {"tagEvents": "select:function(RowModel,record,index,eOpts){\
\
/*if(typeof(record)!='number'){\
            \tWb.request({\
    \t\t\turl: 'm?xwl=customer-link/insertCod',\
    \t\t\tparams:{ TENANCY_ID:record.data.TENANCY_ID,\
                ID:record.data.ID,\
                ORG_NAME:record.data.ORG_NAME,\
                TENANCY_ID:record.data.TENANCY_ID,\
                C_ID:record.data.ID},\
    \t\t\tsuccess: function() {}\
 \t\t\t  });\
            }\
       */     \
  \
  \
},\
deselect:function(RowModel,record,index,eOpts){\
  \tvar ID=record.data.ID;\
\tWb.request({\
      url: 'm?xwl=system/customer/customer/deleteCCC',\
      params:{ORG_ID:ID},\
      success: function(){}\
    });\
}\t"}
      }],
      "type": "fieldset"
     },
     {
      "configs": {
       "itemId": "C_TYPE122",
       "hidden": "true",
       "x": "432",
       "width": "240",
       "y": "304",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     },
     {
      "configs": {
       "itemId": "DEFAULT_PROTOCOL",
       "hidden": "true",
       "fieldLabel": "<font color='red'>*<\/font>默认协议",
       "x": "40",
       "width": "312",
       "y": "504",
       "displayField": "DESCRIPTION",
       "labelWidth": "75",
       "valueField": "ID",
       "height": "22"
      },
      "expanded": false,
      "children": [{
       "configs": {
        "itemId": "store",
        "autoLoad": "true"
       },
       "expanded": false,
       "children": [],
       "type": "store"
      }],
      "type": "combo"
     },
     {
      "configs": {
       "itemId": "REGEDIT_STATUS",
       "labelAlign": "right",
       "pickList": "[\
  ['0', '一般企业'],\
  ['1', '贸易公司']\
]",
       "fieldLabel": "贸易性质",
       "x": "568",
       "width": "201",
       "y": "208",
       "labelWidth": "60",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "combo"
     },
     {
      "configs": {
       "itemId": "E_CODE",
       "allowBlank": "false",
       "fieldLabel": "代码类型",
       "x": "28",
       "width": "268",
       "keyName": "ORG_CODE",
       "y": "48",
       "labelWidth": "70",
       "forceSelection": "true",
       "height": "23"
      },
      "expanded": true,
      "children": [],
      "type": "combo"
     }
    ],
    "type": "window",
    "events": {"ok": "app.GOV_CODE.setValue(app.GOV_CODE.getValue().replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, ''));\
\
var values = Wb.getValue(app.customWin);\
if (app.isEdit) {\
  if(app.stateCol.getValue()==1){\
    var ids=new Array();\
    var names=new Array();\
     var sels = app.grid1.getSelection();\
     var sels2 = app.customerGrid.getSelection();\
    Wb.each(sels2,function (sel){\
\tids.push(sel.data.ID);\
      names.push(sel.data.ORG_NAME);\
\t});\
    //权限按钮操作\
    Wb.request({\
      url: 'm?xwl=system/customer/customer/insertContact',\
      params: {ids:ids,ID:sels[0].data.ID,names:names}, //合并窗口和记录数据作为参数，后者为默认值\
      success: function() {\
        //把窗口数据更新到选择记录中\
        Wb.update(app.selRec, values);\
        //隐藏对话框，在模块关闭时自动销毁对话框\
        app.customWin.close();\
      }\
    });\
    }\
  //调用后台java方法写的 \
  var s1 = app.grid1.getSelection();\
  //点击修改按钮的处理过程\
  var val = Wb.applyIf(values,Wb.getData(app.selRec, true)); //合并窗口和记录数据作为参数，后者为默认值\
  Wb.request({\
    url: 'm?xwl=system/customer/customer/update1',\
//     params: val,//合并窗口和记录数据作为参数，后者为默认值\
    params:Wb.applyIf({code:s1[0].data.CODE},values, Wb.getData(app.selRec, true)),\
    success: function() {\
      //把窗口数据更新到选择记录中\
      Wb.update(app.selRec, values);\
      //隐藏对话框，在模块关闭时自动销毁对话框\
      app.customWin.close();\
      app.queryBtn.fireEvent('click');\
      app.xwl1.send(\"/exchange/ex_customer/#\",{\
        info:{\
          type:\"custom\",\
          action:\"update\",\
          senduser:'{#sys.username#}',\
          sendtime:(new Date()).getTime(),\
          ttl:5000,\
          sendmoudle:\"customer\"\
        },\
        data:val\
      });\
    }\
  });\
 \
} else {\
//   var s = app.grid1.getSelection();\
  //点击添加按钮的处理过程\
  Wb.request({\
//     url: 'm?xwl=system/customer/customer/insert1',\
    url: 'm?xwl=system/customer/customer/insert2',\
    out: app.customWin,\
//     params:{code:s[0].data.CODE},\
    params:{code:app.CODE.getValue()},\
    success: function(resp) {\
      //把服务器返回的数据合并窗口数据（公司名称等数据）添加到表格中\
//       var val = Wb.apply( values,Wb.decode(resp.responseText));\
//       Wb.add(app.grid1, val);\
      Wb.add(app.grid1,values);\
      //隐藏对话框，在模块关闭时自动销毁对话框\
      app.customWin.close();\
      app.queryBtn.fireEvent('click');\
       app.xwl1.send(\"/exchange/ex_customer/#\",{\
        info:{\
          type:\"custom\",\
          action:\"create\",\
          senduser:'{#sys.username#}',\
          sendtime:(new Date()).getTime(),\
          ttl:5000,\
          sendmoudle:\"customer\"\
        },\
        data:val\
      });\
    }\
  });\
  \
}"}
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "customerlinkwin",
     "dialog": "true",
     "closeAction": "hide",
     "width": "1000",
     "title": "客户-联系人",
     "height": "600"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "layout": "absolute",
       "itemId": "panel1",
       "split": "true",
       "width": "720",
       "region": "north",
       "height": "72",
       "frame": "true"
      },
      "expanded": false,
      "children": [
       {
        "configs": {
         "itemId": "LINK_NAME",
         "labelAlign": "right",
         "fieldLabel": "联系人",
         "width": "216",
         "x": "0",
         "y": "8",
         "labelWidth": "90",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "GOV_CODE",
         "labelAlign": "right",
         "normalName": "GOV_CODE_LINK",
         "fieldLabel": "工商注册号",
         "width": "216",
         "x": "448",
         "y": "8",
         "labelWidth": "90",
         "disabled": "true",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "CUS_NAME",
         "labelAlign": "right",
         "normalName": "CUS_NAME_LINK",
         "fieldLabel": "客户",
         "width": "216",
         "x": "224",
         "y": "8",
         "labelWidth": "90",
         "disabled": "true",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "TEL",
         "labelAlign": "right",
         "fieldLabel": "电话",
         "width": "216",
         "x": "0",
         "y": "40",
         "labelWidth": "90",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "EMAIL",
         "labelAlign": "right",
         "vtype": "email",
         "fieldLabel": "邮件",
         "width": "216",
         "x": "224",
         "y": "40",
         "labelWidth": "90",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "WECHATMSG_TYPE",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "消息类型",
         "width": "216",
         "x": "232",
         "y": "88",
         "labelWidth": "90",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "ORG_ID",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "组织机构代码",
         "width": "216",
         "x": "0",
         "y": "136",
         "labelWidth": "90",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "C_ID",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "客户ID",
         "width": "216",
         "x": "224",
         "y": "104",
         "labelWidth": "90",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "TENANCY_ID",
         "hidden": "true",
         "labelAlign": "right",
         "fieldLabel": "租户",
         "width": "216",
         "x": "0",
         "y": "104",
         "labelWidth": "90",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       },
       {
        "configs": {
         "itemId": "ID",
         "hidden": "true",
         "x": "120",
         "width": "240",
         "y": "176",
         "height": "22"
        },
        "expanded": false,
        "children": [],
        "type": "text"
       }
      ],
      "type": "panel"
     },
     {
      "configs": {
       "layout": "fit",
       "itemId": "panel2",
       "region": "center",
       "height": "400"
      },
      "expanded": true,
      "children": [{
       "configs": {
        "itemId": "xwl2",
        "file": "m?xwl=system/customer/wechatmsg"
       },
       "expanded": false,
       "children": [],
       "type": "xwl"
      }],
      "type": "panel"
     }
    ],
    "type": "window",
    "events": {
     "show": "app.customerlinkwin.down('[iconCls=ok_icon]').hide();\
app.customerlinkwin.down('[iconCls=cancel_icon]').setText('关闭');",
     "ok": "var values = Wb.getValue(app.customerlinkwin);\
\
if (app.isEdit) {\
//   var myreg = /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/;\
//   if(!myreg.test(app.EMAIL.getValue()))\
//   {\
//      alert('提示\\
\\
请输入有效的E_mail！');\
//      return false;\
//   }\
//   var phone =/^\\d{7,8}$/;\
//   if(!phone.test(app.TEL.getValue())){\
//   \talert('提示\\
\\
请输入有效的电话！');\
//                 return false;\
//   }\
  //点击修改按钮的处理过程\
  Wb.request({\
    url: 'm?xwl=system/customer/customer/customerLinkEdit/updateCustomerLink',\
    params: Wb.applyIf(values, Wb.getData(app.selRec, true)), //合并窗口和记录数据作为参数，后者为默认值\
    success: function() {\
      //把窗口数据更新到选择记录中\
      Wb.update(app.selRec, values);\
      //隐藏对话框，在模块关闭时自动销毁对话框\
      app.customerlinkwin.close();\
    }\
  });\
//   var s = app.grid11.getSelection();\
//   var sels = app.xwl2.grid1.getSelection();\
//   if(sels.length != 1){\
// //   if(app.xwl2.tttt.getValue()==\"\"){\
//   \tWb.request({\
//     url: 'm?xwl=system/customer/customer/customerLinkEdit/updateCustomerLink',\
//     params: Wb.applyIf(values, Wb.getData(app.selRec, true)), //合并窗口和记录数据作为参数，后者为默认值\
//     success: function() {\
//       //把窗口数据更新到选择记录中\
//       Wb.update(app.selRec, values);\
//       //隐藏对话框，在模块关闭时自动销毁对话框\
//       app.customerlinkwin.close();\
//     }\
//   });\
//   }else{\
//     app.xwl2.savebtn.fireEvent('click');\
//   Wb.request({\
//     url: 'm?xwl=system/customer/customer/linkedit/update',\
//     out: app.customerlinkwin, //合并窗口和记录数据作为参数，后者为默认值\
// //     params:{MSGID: sels[0].data.ID,ID:s[0].data.ID},\
//     params:{MSGID:app.xwl2.tttt.getValue(),ID:s[0].data.ID,ENABLED:'1'},\
//     success: function() {\
//       //把窗口数据更新到选择记录中\
//       Wb.update(app.selRec, values);\
//       //隐藏对话框，在模块关闭时自动销毁对话框\
//       app.customerlinkwin.close();\
// //       app.xwl2.savebtn.fireEvent('click');\
//     }\
//   });\
    \
//   }\
  \
} else {\
//   var sels = app.xwl2.grid1.getSelection();\
// if (sels.length != 1) {\
//  \t\tWb.request({\
//       \t\turl: 'm?xwl=system/customer/customer/customerLinkEdit/insertCustomerLink',\
//       \t\tout: app.customerlinkwin,\
//       \t\tsuccess: function(resp) {\
//         \t//把服务器返回的数据合并窗口数据（公司名称等数据）添加到表格中\
//        \t\t Wb.add(app.grid11, Wb.apply(Wb.decode(resp.responseText), values));\
//         \t//隐藏对话框，在模块关闭时自动销毁对话框\
//        \t\t app.customerlinkwin.close();\
//       }\
//     });\
// }else{\
//   app.xwl2.savebtn.fireEvent('click');\
//   Wb.request({\
//     url: 'm?xwl=system/customer/customer/linkedit/insert',\
//     out: app.customerlinkwin,\
//     params: {\
//       MSGID: sels[0].data.ID\
//     },\
//     success: function(resp) {\
//       app.customerlinkwin.close();\
//     }\
//   });\
// }\
//   var myreg = /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/;\
//   if(!myreg.test(app.EMAIL.getValue()))\
//   {\
//      alert('提示\\
\\
请输入有效的E_mail！');\
//      return false;\
//   }\
//   var phone =/^\\d{7,8}$/;\
//   if(!phone.test(app.TEL.getValue())){\
//   \talert('提示\\
\\
请输入有效的电话！');\
//                 return false;\
//   }\
  Wb.request({\
     url: 'm?xwl=system/customer/customer/customerLinkEdit/insertCustomerLink',\
     out: app.customerlinkwin,\
     success: function(resp) {\
       Wb.add(app.grid11,values);\
     //把服务器返回的数据合并窗口数据（公司名称等数据）添加到表格中\
//      Wb.add(app.grid11, Wb.apply(Wb.decode(resp.responseText), values));\
     //隐藏对话框，在模块关闭时自动销毁对话框\
     app.customerlinkwin.close();\
       app.grid11.store.load({\
       \tparams:{c:app.recordGovcode.getValue()}\
       });\
     }\
   });\
}",
     "close": "app.grid11.store.load({\
       \tparams:{c:app.recordGovcode.getValue()}\
       });"
    }
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "viewport1"
    },
    "expanded": true,
    "children": [
     {
      "configs": {
       "itemId": "xwl1",
       "file": "m?xwl=system/common/rabbitMq"
      },
      "expanded": false,
      "children": [],
      "type": "xwl"
     },
     {
      "configs": {
       "layout": "border",
       "itemId": "panel1",
       "region": "center"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "layout": "border",
         "itemId": "north_panel",
         "split": "true",
         "region": "north",
         "height": "333"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "toolbarSel",
           "hidden": "false",
           "region": "north",
           "height": "35"
          },
          "expanded": false,
          "children": [
           {
            "configs": {
             "itemId": "name1",
             "emptyText": "名称、代码、工商号",
             "fieldLabel": "查询条件",
             "width": "250",
             "labelWidth": "70"
            },
            "expanded": true,
            "children": [],
            "type": "text"
           },
           {
            "configs": {
             "itemId": "type",
             "emptyText": "客户类型",
             "keyName": "CLIENT_TYPE",
             "width": "150"
            },
            "expanded": false,
            "children": [],
            "type": "combo"
           },
           {
            "configs": {
             "itemId": "createtime1",
             "fieldLabel": "创建时间起始",
             "width": "230",
             "labelWidth": "95"
            },
            "expanded": false,
            "children": [],
            "type": "date"
           },
           {
            "configs": {
             "itemId": "createtime2",
             "fieldLabel": "截止",
             "width": "190",
             "labelWidth": "40"
            },
            "expanded": false,
            "children": [],
            "type": "date"
           },
           {
            "configs": {
             "itemId": "IDS",
             "hidden": "true"
            },
            "expanded": false,
            "children": [],
            "type": "text"
           },
           {
            "configs": {
             "itemId": "stateCol",
             "hidden": "true",
             "fieldLabel": "区分权限和修改按钮的标志位"
            },
            "expanded": false,
            "children": [],
            "type": "text"
           },
           {
            "configs": {
             "itemId": "recordcode",
             "hidden": "true"
            },
            "expanded": false,
            "children": [],
            "type": "text"
           },
           {
            "configs": {
             "itemId": "ORG_NAME",
             "labelAlign": "right",
             "fieldLabel": "组织",
             "labelWidth": "40",
             "height": "22"
            },
            "expanded": false,
            "children": [{
             "configs": {
              "itemId": "pickComp",
              "rootVisible": "false",
              "height": "250"
             },
             "expanded": true,
             "children": [{
              "configs": {
               "itemId": "store",
               "fields": "['text','level']",
               "url": "m?xwl=system/customer/customer/tree-select"
              },
              "expanded": false,
              "children": [],
              "type": "treestore",
              "events": {"beforeload": "operation.params.level = operation.node.data.ID;"}
             }],
             "type": "tree",
             "events": {"itemclick": "var picker = this.ownerCmp;\
picker.setValue(record.data.text);\
\
app.orgId.setValue(record.data.ID);\
app.ORG_NAME.setValue(record.data.text);\
app.ORG_CODE.setValue(record.data.ORG_CODE);\
app.parentId.setValue(record.data.PARENT_ID);\
\
picker.collapse();"}
            }],
            "type": "picker"
           },
           {
            "configs": {
             "itemId": "orgId",
             "hidden": "true"
            },
            "expanded": false,
            "children": [],
            "type": "text"
           },
           {
            "configs": {
             "itemId": "ORG_CODE",
             "hidden": "true"
            },
            "expanded": false,
            "children": [],
            "type": "text"
           },
           {
            "configs": {
             "itemId": "parentId",
             "hidden": "true"
            },
            "expanded": false,
            "children": [],
            "type": "text"
           }
          ],
          "type": "toolbar"
         },
         {
          "configs": {
           "itemId": "toolbarBtn",
           "hidden": "false",
           "region": "north",
           "height": "30"
          },
          "expanded": true,
          "children": [
           {
            "configs": {
             "itemId": "queryBtn",
             "text": "查询",
             "iconCls": "seek_icon",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "\
app.grid1.store.load({\
  out: app.toolbarSel\
});"}
           },
           {
            "configs": {
             "itemId": "addBtn",
             "text": "新增",
             "iconCls": "record_add_icon",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "// app.customWin.setHeight(460);\
app.customWin.setHeight(330);\
Wb.reset(app.customWin);\
app.CLIENT_TYPE.setValue('CE');\
//app.check1.setValue(true);\
app.PAY_TYPE.setValue(2);\
app.STATE_FLAG.setValue('0');\
//app.REGEDIT_STATUS.setValue(0);\
app.customWin.setTitle('添加 - 客户');\
app.customWin.setIconCls('record_add_icon');\
app.customWin.show();\
app.isEdit = false; //标识是否为添加或修改状态，在editWin的ok事件中用到此属性\
\
"}
           },
           {
            "configs": {
             "itemId": "editBtn",
             "text": "编辑",
             "iconCls": "record_edit_icon",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "var sels = app.grid1.getSelection();\
if (sels.length != 1) {\
  Wb.warn('请选择 1 条需要修改的记录。');\
  return;\
}\
\
var result=sels[0].data.CLIENT_TYPE;\
var s1=result.replace(\"[\",\"\");\
var s2=s1.replace(\"]\",\"\");\
\
var s6=\"\";\
for(var j=0;j<s2.length;j++){\
//   alert(s2.indexOf(\"\\\"\"));\
\tif(s2.indexOf(\"\\\"\")!=-1){\
\t\ts6=s2.replace(\"\\\"\",\"\");\
      \ts2=s6;\
    }\
}\
var s= s6.split(\",\");\
console.log(s);\
Wb.reset(app.customWin);\
app.stateCol.setValue(0);//设置修改的state为0\
app.customWin.setHeight(330);\
app.selRec = sels[0];\
app.customWin.setTitle('修改 - ' + app.selRec.data.NAME);\
app.customWin.setIconCls('record_edit_icon');\
Wb.setValue(app.customWin, app.selRec.data);\
app.CODE.setDisabled(true);\
//在给别的类型设置值的时候，需要在这后面改才行---Wb.setValue(app.customWin, app.selRec.data);\
// app.CLIENT_TYPE.setValue('CE');\
app.CLIENT_TYPE.setValue(s);\
console.log(sels[0]);\
app.customWin.show();\
app.isEdit = true; //标识是否为添加或修改状态，在editWin的ok事件中用到此属性\
\
\
\
"}
           },
           {
            "configs": {
             "itemId": "delBtn",
             "hidden": "'{#sys.username#}'!='admin'",
             "text": "删除",
             "iconCls": "record_delete_icon",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "var data = app.grid1.getSelection()[0].data;\
Wb.del(app.grid1, {\
  url: 'm?xwl=system/customer/customer/delete',\
  //params: {company_id : app.company_id},\
  params:{code:data.CODE,C_ID:data.ID},\
  titleField: 'NAME',\
  success:function(){\
    app.xwl1.send(\"/exchange/ex_customer/#\",{\
        info:{\
          type:\"custom\",\
          action:\"delete\",\
          senduser:'{#sys.username#}',\
          sendtime:(new Date()).getTime(),\
          ttl:5000,\
          sendmoudle:\"customer\"\
        },\
        data:data\
      });\
  }\
});\
"}
           },
           {
            "configs": {
             "itemId": "resetBtn",
             "text": "重置",
             "iconCls": "record_add_icon",
             "height": "22"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "\
Wb.reset(app.toolbar1);\
app.grid1.store.load({\
  out: app.panel1\
});"}
           },
           {
            "configs": {
             "itemId": "limitBtn",
             "text": "设置权限",
             "iconCls": "book_icon"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "var sels = app.grid1.getSelection();\
if (sels.length != 1) {\
  Wb.warn('请选择 1 条需要修改的记录。');\
  return;\
}\
\
var result=sels[0].data.CLIENT_TYPE;\
var s1=result.replace(\"[\",\"\");\
var s2=s1.replace(\"]\",\"\");\
\
var s6=\"\";\
for(var j=0;j<s2.length;j++){\
//   alert(s2.indexOf(\"\\\"\"));\
\tif(s2.indexOf(\"\\\"\")!=-1){\
\t\ts6=s2.replace(\"\\\"\",\"\");\
      \ts2=s6;\
    }\
}\
var s= s6.split(\",\");\
//当名称重复的时候就会出现，设置的方法不起作用\
app.customer.setVisible(true);\
app.stateCol.setValue(1);//设置修改的state为1\
Wb.request({\
    url: 'm?xwl=system/customer/customer/selectOrgId',\
    success: function(resp) {\
      \
            var roleRec, selRecs = [],\
        roles = Wb.decode(resp.responseText);\
      Wb.each(roles.rows, function(rec) {\
        roleRec = Wb.find(app.customerGrid.store, 'ID', rec.ORG_ID);\
        if (roleRec)\
          selRecs.push(roleRec);\
      });\
      app.customerGrid.setSelection(selRecs);\
      \
     /* \
      var ids = Wb.decode(resp.responseText);\
      var store = app.customerGrid.getStore();\
      \
      \
       Wb.each(ids.rows, function(rec){\
\t\tfor(var i =0;i<store.getCount();i++){\
            var record=store.getAt(i);\
     \t\tif(rec.ORG_ID===record.data.ID){\
              alert(i);\
         \t\t\tselRecs[i]=record.data;\
            }\
\t\t} \
      }); \
      app.customerGrid.setSelection(selRecs);*/\
    }\
});\
\
\
app.selRec = sels[0];\
app.customWin.setTitle('修改权限 - ' + app.selRec.data.SERVICE_NAME);\
app.customWin.setIconCls('record_edit_icon');\
Wb.setValue(app.customWin, app.selRec.data);\
app.CLIENT_TYPE.setValue(s);\
app.customWin.show();\
app.isEdit = true; //标识是否为添加或修改状态，在editWin的ok事件中用到此属性\
\
"}
           },
           {
            "configs": {
             "itemId": "editBillBtn",
             "text": "修改舱单货主",
             "iconCls": "record_edit_icon"
            },
            "expanded": false,
            "children": [],
            "type": "button",
            "events": {"click": "var sel = app.grid1.getSelection();\
if (sel.length < 1) {\
  Wb.warn(\"请选择一条数据！\");\
  return;\
}\
var row=app.cusNamGrid.getSelection();\
var names=\"\";\
for(var i=0;i<row.length;i++){\
\tnames+=\"'\"+row[i].data.CUS_NAME+\"',\";\
}\
names+=\"'\"+sel[0].data.NAME+\"'\";\
// names=names,substring(0,names.length-1);\
Wb.request({\
  url: 'm?xwl=system/customer/customer/updateVbillHead',\
  params: {\
    CODE: sel[0].data.CODE,\
    govCode:sel[0].data.GOV_CODE,\
    names:names\
  },\
  success: function(resp) {\
\tWb.info(\"成功\");\
  }\
});"}
           }
          ],
          "type": "toolbar"
         },
         {
          "configs": {
           "itemId": "grid1",
           "region": "center",
           "height": "300"
          },
          "expanded": true,
          "children": [
           {
            "configs": {
             "itemId": "store",
             "autoLoad": "true",
             "url": "m?xwl=system/customer/customer/selectZHU"
            },
            "expanded": true,
            "children": [],
            "type": "store"
           },
           {
            "configs": {"itemId": "columns"},
            "expanded": true,
            "children": [
             {
              "configs": {
               "itemId": "stateFlagCol",
               "renderer": "if(value==0){\
\treturn '初始状态';\
}\
if(value==1){\
\treturn '待审核';\
}\
if(value==2){\
\treturn '已审核';\
}",
               "hidden": "true",
               "dataIndex": "STATE_FLAG",
               "text": "状态"
              },
              "expanded": false,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "id",
               "hidden": "true",
               "dataIndex": "ID",
               "text": "系统ID"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "code",
               "dataIndex": "CODE",
               "text": "客户代码"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "name",
               "dataIndex": "NAME",
               "width": "220",
               "text": "中文名称"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "short_name",
               "dataIndex": "SHORT_NAME",
               "text": "中文简称"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "gov_code",
               "dataIndex": "GOV_CODE",
               "width": "150",
               "text": "工商注册码"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "e_code",
               "dataIndex": "E_CODE",
               "text": "社会编码"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "e_short_name",
               "dataIndex": "E_SHORT_NAME",
               "text": "英文简称"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "abletime",
               "dataIndex": "ABLETIME",
               "text": "有效时间"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "c_type",
               "renderer": "// console.log(value);\
var s1=value.replace(\"[\",\"\");\
var s2=s1.replace(\"]\",\"\");\
// var s3=s2.replace(\"\\\"\",\"\");\
// var s4=s3.replace(\"\\\"\",\"\");\
// var s5=s4.replace(\"\\\"\",\"\");\
// var s6=s5.replace(\"\\\"\",\"\");\
var s10=\"\";\
for(var j=0;j<s2.length;j++){\
\tif(s2.indexOf(\"\\\"\")!=-1){\
\t\ts10=s2.replace(\"\\\"\",\"\");\
      \ts2=s10;\
    }\
}\
var s=s10.split(\",\");\
\
// var s= s6.split(\",\");\
\
var st=\"\";\
for(var i=0;i<s.length;i++){\
  if(s.length==1 || i==s.length-1){\
  \tst+=Wb.kv(s[i],metaData.column.keyItems);\
  }else\
\tst+=Wb.kv(s[i],metaData.column.keyItems)+\",\"; \
}\
return st;\
\
\
",
               "dataIndex": "CLIENT_TYPE",
               "keyName": "CLIENT_TYPE",
               "text": "客户类型"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "area_code",
               "dataIndex": "AREA_CODE",
               "text": "区域代码"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "area",
               "dataIndex": "AREA",
               "text": "所属区域"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "address",
               "dataIndex": "ADDRESS",
               "text": "联系地址"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "zip",
               "dataIndex": "ZIP",
               "text": "邮政编码"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "biz_linkman",
               "dataIndex": "BIZ_LINKMAN",
               "text": "业务联系人"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "tel",
               "dataIndex": "TEL",
               "text": "电话"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "telex",
               "dataIndex": "TELEX",
               "text": "电传"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "fax",
               "dataIndex": "FAX",
               "text": "传真"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "finance_linkman",
               "dataIndex": "FINANCE_LINKMAN",
               "text": "财务联系人"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "email",
               "dataIndex": "EMAIL",
               "text": "email地址"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "email_file",
               "dataIndex": "EMAIL_FILE",
               "text": "邮箱文件"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "file_format",
               "dataIndex": "FILE_FORMAT",
               "text": "文件格式"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "website",
               "dataIndex": "WEBSITE",
               "text": "网站地址"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "empty_price_type",
               "renderer": "if(value == 1){\
    return \"免天方式\";\
}else if(value == 2){\
    return \"按保有量\";\
}else if(value == 3){\
    return \"箱管理费\";\
}",
               "dataIndex": "EMPTY_PRICE_TYPE",
               "text": "空箱计费方式"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "min_container",
               "dataIndex": "MIN_CONTAINER",
               "text": "保有量"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "default_protocol",
               "dataIndex": "DEFAULT_PROTOCOL",
               "keyName": "C_CONTRACT",
               "text": "默认协议"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "credit_limit",
               "dataIndex": "CREDIT_LIMIT",
               "text": "信用额度"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "protocol_abletime",
               "dataIndex": "PROTOCOL_ABLETIME",
               "text": "协议有效期"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "pay_type",
               "renderer": "\
if(value == 1){\
    return \"支票\";\
}else if(value == 2){\
    return \"现金\";\
}else if(value == 3){\
    return \"预售\";\
}else if(value == 4){\
    return \"转账\";\
}",
               "dataIndex": "PAY_TYPE",
               "text": "付款方式"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "account_type",
               "renderer": "if(value == 1){\
    return \"即结\";\
}else if(value == 2){\
    return \"月结\";\
}",
               "dataIndex": "ACCOUNT_TYPE",
               "text": "结算方式"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "reserve_price",
               "dataIndex": "RESERVE_PRICE",
               "text": "备用金额"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "remark",
               "dataIndex": "REMARK",
               "text": "备注"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "state_flagb",
               "dataIndex": "STATE_FLAGB",
               "text": "备注"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "createuser",
               "dataIndex": "CREATEUSER",
               "keyName": "WB_USER",
               "text": "录入员"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "createtime",
               "dataIndex": "CREATETIME",
               "width": "120",
               "text": "录入时间"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "updateuser",
               "dataIndex": "UPDATEUSER",
               "keyName": "WB_USER",
               "text": "最近修改人"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "updatetime",
               "dataIndex": "UPDATETIME",
               "width": "120",
               "text": "最近修改时间"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "regedit_status",
               "hidden": "true",
               "dataIndex": "REGEDIT_STATUS",
               "text": "申请状态"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "bcode",
               "hidden": "true",
               "dataIndex": "BCODE"
              },
              "expanded": false,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "tenancyId",
               "dataIndex": "TENANCY_ID",
               "text": "租户"
              },
              "expanded": true,
              "children": [],
              "type": "column"
             },
             {
              "configs": {
               "itemId": "colSUBCOMPANY",
               "dataIndex": "SUBCOMPANY",
               "text": "所属公司",
               "titleAlign": "center"
              },
              "expanded": false,
              "children": [],
              "type": "column"
             }
            ],
            "type": "array"
           }
          ],
          "type": "grid",
          "events": {
           "itemclick": "app.recordGovcode.setValue(record.data.GOV_CODE);\
app.recordcode.setValue(record.data.CODE);\
app.grid11.store.load({\
   params:{c:record.data.GOV_CODE}\
});\
app.contract_grid.store.load({\
   params:{ID : record.data.ID}\
});\
app.cusNamGrid.store.load({\
params:{c:record.data.GOV_CODE}\
});\
\
app.addressGrid.store.load({\
 params:{CODE:record.data.CODE} \
});",
           "itemdblclick": "app.editBtn.fireEvent('click');"
          }
         }
        ],
        "type": "panel"
       },
       {
        "configs": {
         "layout": "border",
         "itemId": "south_panel",
         "region": "center",
         "height": "320"
        },
        "expanded": true,
        "children": [
         {
          "configs": {
           "layout": "fit",
           "itemId": "left_panel",
           "split": "true",
           "width": "500",
           "region": "center"
          },
          "expanded": true,
          "children": [{
           "configs": {"itemId": "tab1"},
           "expanded": true,
           "children": [
            {
             "configs": {
              "layout": "border",
              "itemId": "panel1",
              "title": "客户联系人"
             },
             "expanded": false,
             "children": [
              {
               "configs": {
                "itemId": "toolbar11",
                "region": "north",
                "height": "30"
               },
               "expanded": true,
               "children": [
                {
                 "configs": {
                  "itemId": "add",
                  "tooltip": "增加记录",
                  "text": "增加",
                  "iconCls": "record_add_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "// var rec = app.grid1.getSelection()[0];\
// if (!rec) {\
//   Wb.warn('请选择一条记录。');\
//   return;\
// } \
// Wb.addEdit(app.grid11,{C_ID:rec.data.ID,GOV_CODE:rec.data.GOV_CODE,ORG_ID:'{#sys.ORG_ID#}',CREATED_MAN:'{#sys.username#}',UPDATED_MAN:'{#sys.username#}',CREATED_ON:new Date(),UPDATED_ON:new Date()});  \
\
app.state=\"insert\";\
\
\
var sels = app.grid1.getSelection();\
if (sels.length != 1) {\
  Wb.warn('请选择 1 条需要修改的记录。');\
  return;\
}\
Wb.reset(app.customerlinkwin);\
\
\
app.xwl2.grid1.store.load({out:app.xwl2.panelWest});\
app.xwl2.grid11.store.load({out:app.xwl2.panelCenter});\
\
//虚拟Id\
app.ID.setValue(Wb.guid());\
app.xwl2.ID.setValue(app.ID.getValue());\
// alert(app.ID.getValue()+\"---------\"+app.xwl2.ID.getValue());\
app.customerlinkwin.setTitle('添加');\
app.customerlinkwin.setIconCls('record_add_icon');\
app.C_ID.setValue(sels[0].data.ID);\
app.GOV_CODE_LINK.setValue(sels[0].data.GOV_CODE);\
app.CUS_NAME_LINK.setValue(sels[0].data.NAME);\
app.ORG_ID.setValue(sels[0].data.ORG_ID);\
app.TENANCY_ID.setValue(sels[0].data.TENANCY_ID);\
app.customerlinkwin.show();\
app.isEdit = false; "}
                },
                {
                 "configs": {
                  "itemId": "edit",
                  "tooltip": "修改记录",
                  "text": "修改",
                  "iconCls": "record_edit_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "var sels = app.grid11.getSelection();\
if (sels.length != 1) {\
  Wb.warn('请选择 1 条需要修改的记录。');\
  return;\
}\
// var record;\
app.state=\"update\";\
\
// app.xwl2.grid1.store.load({out:app.xwl2.panelWest});\
// app.xwl2.grid11.store.load({out:app.xwl2.panelCenter});\
// Wb.request({\
//   url: 'm?xwl=system/customer/wechatmsg/subscrib/selectQuery',\
// //   \tparams:{SUBSCRIB:app.xwl2.aaa.getValue()},\
//   params:{WECHATID:sels[0].data.ID},\
//     success: function(resp) {\
//       var roleRec, selRecs = [],\
//       roles = Wb.decode(resp.responseText);\
//       Wb.each(roles.rows, function(rec) {\
//         console.log(parseInt(rec.MSGID));//数据库这两个表的字段不都是number的\
//         roleRec = Wb.find(app.xwl2.grid1.store, 'ID', parseInt(rec.MSGID));\
// //         alert(roleRec);\
//         if (roleRec)\
//           selRecs.push(roleRec);\
//       });\
//       app.xwl2.grid1.setSelection(selRecs);\
// //       console.log(selRecs[0].data.ID+\"000===\");\
//       console.log(selRecs);\
//    if(selRecs.length!=0){\
//       Wb.request({\
//         url: 'm?xwl=system/customer/customer/type-content/selection',\
// //         params: {WECHATID:sels[0].data.ID,MSGID:selRecs[selRecs.length-1].data.ID},\
//         params: {WECHATID:sels[0].data.ID,MSGID:selRecs[0].data.ID},\
//         success: function(resp) {\
//           var result=Wb.decode(resp.responseText);\
//           Wb.each(result.rows,function(rec){ \
//             console.log(record);\
//             if(record===undefined){\
//             \trecord=rec.ID;\
//               console.log(record);\
//             }\
// //             record=rec.ID;\
//           });\
    \
//           app.xwl2.grid11.store.load({\
// \t\t\t\tparams:{\
//     \t  \t\t\tsubscribe:record\
//        \t\t\t}\
// \t  \t\t});\
 \
\
//         }\
//       });\
     \
//    }\
      \
//     }\
// });\
app.xwl2.store.load({\
\tout:app.xwl2.panelWest\
});\
\
\
app.selRec = sels[0];\
app.customerlinkwin.setTitle('修改');\
app.customerlinkwin.setIconCls('record_edit_icon');\
Wb.setValue(app.customerlinkwin, app.selRec.data);\
app.customerlinkwin.show();\
app.xwl2.grid1.store.load({\
params:{WECHATID:sels[0].data.ID}\
}\
);\
app.isEdit = true;\
"}
                },
                {
                 "configs": {
                  "itemId": "delete",
                  "tooltip": "删除记录",
                  "text": "删除",
                  "iconCls": "record_delete_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "Wb.del(app.grid11, {\
  url: 'm?xwl=system/customer/customer/customerLinkEdit/deleteCustomerLink',\
  titleField: 'CUS_NAME'\
});"}
                },
                {
                 "configs": {
                  "itemId": "delete1",
                  "hidden": "true",
                  "tooltip": "删除记录",
                  "text": "删除1",
                  "iconCls": "record_delete_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "Wb.remove(app.grid11);"}
                },
                {
                 "configs": {
                  "itemId": "save",
                  "hidden": "true",
                  "tooltip": "保存记录",
                  "text": "保存",
                  "iconCls": "save_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "if (!Wb.verifyGrid(app.grid11)) //验证数据是否合法\
  return;\
Wb.sync({\
  grid: app.grid11,\
  url: 'm?xwl=system/customer/customer-link/save',\
  message: '正在保存中...',\
  success: function(resp) {\
    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\
    Wb.syncCreate(app.grid11, Wb.decode(resp.responseText));\
  }\
});"}
                },
                {
                 "configs": {
                  "itemId": "recordGovcode",
                  "hidden": "true"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "text"
                }
               ],
               "type": "toolbar"
              },
              {
               "configs": {
                "itemId": "grid11",
                "editable": "true",
                "region": "center"
               },
               "expanded": false,
               "children": [
                {
                 "configs": {
                  "itemId": "store",
                  "autoLoad": "false",
                  "url": "m?xwl=system/customer/customer/selectLink"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "store"
                },
                {
                 "configs": {"itemId": "columns"},
                 "expanded": true,
                 "children": [
                  {
                   "configs": {
                    "itemId": "id1",
                    "hidden": "true",
                    "dataIndex": "ID"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "cId",
                    "hidden": "true",
                    "dataIndex": "C_ID"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "govCode",
                    "dataIndex": "GOV_CODE",
                    "text": "工商注册号"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "cusName",
                    "dataIndex": "CUS_NAME",
                    "text": "客户"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "tel",
                    "dataIndex": "TEL",
                    "text": "电话名"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "email1",
                    "dataIndex": "EMAIL",
                    "text": "邮件"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "linkName",
                    "dataIndex": "LINK_NAME",
                    "text": "联系人"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "tenancyId",
                    "hidden": "true",
                    "dataIndex": "TENANCY_ID"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "wechatMsgType",
                    "dataIndex": "WECHATMSG_TYPE",
                    "text": "消息类型"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "orgId1",
                    "hidden": "true",
                    "dataIndex": "ORG_ID",
                    "text": "组织机构代码"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "createdMan",
                    "dataIndex": "CREATED_MAN",
                    "text": "创建人"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "createdOn",
                    "dataIndex": "CREATED_ON",
                    "text": "创建时间"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "updatedMan",
                    "dataIndex": "UPDATED_MAN",
                    "text": "修改人"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "updatedOn",
                    "dataIndex": "UPDATED_ON",
                    "text": "修改时间"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  }
                 ],
                 "type": "array"
                }
               ],
               "type": "grid",
               "events": {"itemdblclick": "app.edit.fireEvent('click');"}
              }
             ],
             "type": "panel"
            },
            {
             "configs": {
              "layout": "border",
              "itemId": "panel2",
              "title": "客户名称"
             },
             "expanded": false,
             "children": [
              {
               "configs": {
                "itemId": "toolbar11",
                "region": "north",
                "height": "30"
               },
               "expanded": true,
               "children": [
                {
                 "configs": {
                  "itemId": "add",
                  "tooltip": "增加记录",
                  "text": "增加",
                  "iconCls": "record_add_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "var rec = app.grid1.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择一条记录。');\
  return;\
} \
Wb.addEdit(app.cusNamGrid,{C_ID:rec.data.CODE,GOV_CODE:rec.data.GOV_CODE,\
                      CREATED_MAN:'{#sys.username#}',UPDATED_MAN:'{#sys.username#}',\
                      CREATED_ON:new Date(),UPDATED_ON:new Date()});  "}
                },
                {
                 "configs": {
                  "itemId": "delete",
                  "tooltip": "删除记录",
                  "text": "删除",
                  "iconCls": "record_delete_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "Wb.remove(app.cusNamGrid);"}
                },
                {
                 "configs": {
                  "itemId": "save",
                  "tooltip": "保存记录",
                  "text": "保存",
                  "iconCls": "save_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "item",
                 "events": {"click": "if (!Wb.verifyGrid(app.cusNamGrid)) //验证数据是否合法\
  return;\
Wb.sync({\
  grid: app.cusNamGrid,\
  url: 'm?xwl=system/customer/customer/saveCusName',\
  message: '正在保存中...',\
  success: function(resp) {\
    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\
    Wb.syncCreate(app.cusNamGrid, Wb.decode(resp.responseText));\
  }\
});"}
                }
               ],
               "type": "toolbar"
              },
              {
               "configs": {
                "itemId": "cusNamGrid",
                "editable": "true",
                "region": "center"
               },
               "expanded": true,
               "children": [
                {
                 "configs": {
                  "itemId": "store",
                  "autoLoad": "false",
                  "url": "m?xwl=system/customer/customer/selectName"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "store"
                },
                {
                 "configs": {"itemId": "columns"},
                 "expanded": true,
                 "children": [
                  {
                   "configs": {
                    "itemId": "id1",
                    "hidden": "true",
                    "dataIndex": "ID"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "cId",
                    "hidden": "true",
                    "dataIndex": "C_ID"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "govCode",
                    "dataIndex": "GOV_CODE",
                    "text": "工商注册号"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "cusName",
                    "dataIndex": "CUS_NAME",
                    "text": "客户"
                   },
                   "expanded": true,
                   "children": [{
                    "configs": {"itemId": "editor"},
                    "expanded": false,
                    "children": [],
                    "type": "text"
                   }],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "tenancyId",
                    "hidden": "true",
                    "dataIndex": "TENANCY_ID"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "createdMan",
                    "dataIndex": "CREATED_MAN",
                    "text": "创建人"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "createdOn",
                    "dataIndex": "CREATED_ON",
                    "text": "创建时间"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "updatedMan",
                    "dataIndex": "UPDATED_MAN",
                    "text": "修改人"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "updatedOn",
                    "dataIndex": "UPDATED_ON",
                    "text": "修改时间"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  }
                 ],
                 "type": "array"
                }
               ],
               "type": "grid"
              }
             ],
             "type": "panel"
            },
            {
             "configs": {
              "layout": "border",
              "itemId": "panel3",
              "title": "客户地址"
             },
             "expanded": false,
             "children": [
              {
               "configs": {
                "itemId": "toolbar1",
                "region": "north",
                "height": "30"
               },
               "expanded": true,
               "children": [
                {
                 "configs": {
                  "itemId": "addadd",
                  "tooltip": "增加新地址",
                  "text": "增加",
                  "iconCls": "record_add_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "button",
                 "events": {"click": "Wb.addEdit(app.addressGrid,{CODE:app.recordcode.getValue()});  "}
                },
                {
                 "configs": {
                  "itemId": "deleteadd",
                  "text": "删除",
                  "iconCls": "record_delete_icon"
                 },
                 "expanded": true,
                 "children": [],
                 "type": "button",
                 "events": {"click": "Wb.remove(app.addressGrid);"}
                },
                {
                 "configs": {
                  "itemId": "saveadd",
                  "text": "保存",
                  "iconCls": "save_icon"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "button",
                 "events": {"click": "if (!Wb.verifyGrid(app.addressGrid)) //验证数据是否合法\
  return;\
Wb.sync({\
  grid: app.addressGrid,\
  url: 'm?xwl=system/customer/customer/address/saveaddress',\
  message: '正在保存中...',\
  success: function(resp) {\
    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\
    Wb.syncCreate(app.addressGrid, Wb.decode(resp.responseText));\
  }\
});"}
                }
               ],
               "type": "toolbar"
              },
              {
               "configs": {
                "itemId": "addressGrid",
                "editable": "true",
                "region": "center"
               },
               "expanded": true,
               "children": [
                {
                 "configs": {
                  "itemId": "store",
                  "autoLoad": "false",
                  "url": "m?xwl=system/customer/customer/address/select"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "store"
                },
                {
                 "configs": {"itemId": "columns"},
                 "expanded": true,
                 "children": [
                  {
                   "configs": {
                    "itemId": "id1",
                    "hidden": "true",
                    "dataIndex": "ID"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "CODE122",
                    "hidden": "true",
                    "dataIndex": "CODE",
                    "text": "工厂代码"
                   },
                   "expanded": false,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "ADDRESS_ID12",
                    "hidden": "false",
                    "dataIndex": "ADDRESS_ID",
                    "keyName": "C_ADDRESS",
                    "text": "计费地址"
                   },
                   "expanded": true,
                   "children": [{
                    "configs": {
                     "tagConfigs": "matchFieldWidth: false",
                     "itemId": "editor",
                     "allowBlank": "false",
                     "tpl": "<table cellspacing='0' width='100%'>\
  <tr>\
    <td>\
      地址\
    <\/td>\
    <td>\
      距离\
    <\/td>\
    <td>\
      区域\
    <\/td>\
  <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td >\
        {NAME}\
      <\/td>\
      <td>\
        {DISTANCE}\
      <\/td>\
      <td>\
        {AREANAME}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
                     "queryMode": "remote",
                     "labelAlign": "right",
                     "displayField": "NAME",
                     "listConfig": "{\
  width: 300\
}",
                     "valueField": "ID",
                     "forceSelection": "true",
                     "minChars": "2"
                    },
                    "expanded": true,
                    "children": [{
                     "configs": {
                      "itemId": "store",
                      "autoLoad": "true",
                      "pageSize": "-1",
                      "url": "m?xwl=receiptInout/receipt/receiptedit/selectADRESS"
                     },
                     "expanded": false,
                     "children": [],
                     "type": "store"
                    }],
                    "type": "combo"
                   }],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "ADDRESS12",
                    "dataIndex": "ADDRESS",
                    "width": "150",
                    "text": "工厂地址"
                   },
                   "expanded": true,
                   "children": [{
                    "configs": {"itemId": "editor"},
                    "expanded": false,
                    "children": [],
                    "type": "text"
                   }],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "LATITUDE12",
                    "dataIndex": "LATITUDE",
                    "text": "维度"
                   },
                   "expanded": true,
                   "children": [{
                    "configs": {"itemId": "editor"},
                    "expanded": false,
                    "children": [],
                    "type": "text"
                   }],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "LONGITUDE12",
                    "dataIndex": "LONGITUDE",
                    "text": "经度"
                   },
                   "expanded": true,
                   "children": [{
                    "configs": {"itemId": "editor"},
                    "expanded": false,
                    "children": [],
                    "type": "text"
                   }],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "LOCK_ID12",
                    "xtype": "checkcolumn",
                    "dataIndex": "LOCK_ID",
                    "text": "锁定标志"
                   },
                   "expanded": true,
                   "children": [],
                   "type": "column"
                  },
                  {
                   "configs": {
                    "itemId": "SAME_COUNT12",
                    "dataIndex": "SAME_COUNT",
                    "text": "连续相同次数"
                   },
                   "expanded": true,
                   "children": [{
                    "configs": {"itemId": "editor"},
                    "expanded": false,
                    "children": [],
                    "type": "number"
                   }],
                   "type": "column"
                  }
                 ],
                 "type": "array"
                }
               ],
               "type": "grid"
              }
             ],
             "type": "panel"
            }
           ],
           "type": "tab"
          }],
          "type": "panel"
         },
         {
          "configs": {
           "layout": "border",
           "itemId": "center_panel",
           "hidden": "true",
           "title": "客户特殊费类"
          },
          "expanded": false,
          "children": [
           {
            "configs": {
             "itemId": "contract_toolbar",
             "region": "north",
             "height": "30"
            },
            "expanded": true,
            "children": [
             {
              "configs": {
               "itemId": "add",
               "tooltip": "增加记录",
               "text": "增加",
               "iconCls": "record_add_icon"
              },
              "expanded": false,
              "children": [],
              "type": "item",
              "events": {"click": "var rec = app.grid1.getSelection()[0];\
if (!rec) {\
  Wb.warn('请选择一条记录。');\
  return;\
} \
Wb.addEdit(app.contract_grid,{CATEGORY_ID:''});  "}
             },
             {
              "configs": {
               "itemId": "delete",
               "tooltip": "删除记录",
               "text": "删除",
               "iconCls": "record_delete_icon"
              },
              "expanded": false,
              "children": [],
              "type": "item",
              "events": {"click": "Wb.remove(app.contract_grid);"}
             },
             {
              "configs": {
               "itemId": "save",
               "tooltip": "保存记录",
               "text": "保存",
               "iconCls": "save_icon"
              },
              "expanded": false,
              "children": [],
              "type": "item",
              "events": {"click": "if (!Wb.verifyGrid(app.contract_grid)) //验证数据是否合法\
  return;\
var rec = app.grid1.getSelection()[0];\
var param = Wb.getValue(app.contract_grid);\
param = Wb.applyIf(param, Wb.getModified(app.contract_grid));//获取增删改json串\
param = Wb.applyIf(param,{customId:rec.data.ID});//客户编号\
\
Wb.request({\
//Wb.sync({\
  //grid: app.contract_grid,\
  url: 'm?xwl=system/customer/customer/sql/saveCategory',\
  params: param,\
  //message: '正在保存中...',\
  success: function(resp) {\
    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\
    //Wb.syncCreate(app.grid11, Wb.decode(resp.responseText));\
    app.contract_grid.store.load({params:{ID:rec.data.ID}});\
  }\
});"}
             }
            ],
            "type": "toolbar"
           },
           {
            "configs": {
             "itemId": "contract_grid",
             "editable": "true",
             "region": "center"
            },
            "expanded": true,
            "children": [
             {
              "configs": {
               "itemId": "store",
               "autoLoad": "false",
               "url": "m?xwl=system/customer/customer/sql/queryByCustom"
              },
              "expanded": false,
              "children": [],
              "type": "store"
             },
             {
              "configs": {"itemId": "columns"},
              "expanded": false,
              "children": [
               {
                "configs": {
                 "itemId": "id1",
                 "hidden": "true",
                 "dataIndex": "ID"
                },
                "expanded": false,
                "children": [],
                "type": "column"
               },
               {
                "configs": {
                 "itemId": "col_CATEGORY_ID",
                 "dataIndex": "CATEGORY_ID",
                 "width": "120",
                 "keyName": "C_BASE_CATEGORY",
                 "text": "费类"
                },
                "expanded": false,
                "children": [{
                 "configs": {
                  "itemId": "editor",
                  "displayField": "CNAME",
                  "valueField": "ID"
                 },
                 "expanded": false,
                 "children": [{
                  "configs": {
                   "itemId": "store",
                   "autoLoad": "true",
                   "params": "{fldId:'C_BASE_CATEGORY'}",
                   "url": "m?xwl=system/common/codeSelect"
                  },
                  "expanded": false,
                  "children": [],
                  "type": "store"
                 }],
                 "type": "combo"
                }],
                "type": "column"
               },
               {
                "configs": {
                 "itemId": "col_CONTRACT_ID",
                 "dataIndex": "CONTRACT_ID",
                 "width": "200",
                 "keyName": "C_CONTRACT",
                 "text": "合同名称"
                },
                "expanded": false,
                "children": [{
                 "configs": {
                  "itemId": "editor",
                  "bindField": "CONTRACT_ID",
                  "keyName": "C_CONTRACT",
                  "displayField": "DESCRIPTION",
                  "valueField": "ID"
                 },
                 "expanded": true,
                 "children": [{
                  "configs": {
                   "itemId": "store",
                   "autoLoad": "true",
                   "url": "m?xwl=system/customer/customer/sql/queryContractByCategory"
                  },
                  "expanded": false,
                  "children": [],
                  "type": "store",
                  "events": {"beforeload": "\
\
var rec = app.contract_grid.getSelection();\
var CATEGORY_ID = rec[0].data.CATEGORY_ID;\
operation.params={categoryId:CATEGORY_ID};"}
                 }],
                 "type": "combo"
                }],
                "type": "column"
               },
               {
                "configs": {
                 "itemId": "col_DISCOUNT",
                 "dataIndex": "DISCOUNT",
                 "text": "折扣"
                },
                "expanded": false,
                "children": [{
                 "configs": {
                  "itemId": "editor",
                  "minValue": "0"
                 },
                 "expanded": false,
                 "children": [],
                 "type": "number"
                }],
                "type": "column"
               },
               {
                "configs": {
                 "itemId": "col_ABLETIME",
                 "dataIndex": "ABLETIME",
                 "text": "有效期"
                },
                "expanded": true,
                "children": [{
                 "configs": {"itemId": "editor"},
                 "expanded": false,
                 "children": [],
                 "type": "date"
                }],
                "type": "column"
               }
              ],
              "type": "array"
             }
            ],
            "type": "grid"
           }
          ],
          "type": "panel"
         }
        ],
        "type": "panel"
       }
      ],
      "type": "panel"
     }
    ],
    "type": "viewport"
   }
  ],
  "type": "module",
  "events": {
   "finalize": "// alert('{#WID#}');\
var WID = '{#WID#}';\
app.xwl1.subscribe('/exchange/ex_customer/#', function(d) {\
  var msg = d.body;\
//   console.log(msg);\
  var record = app.grid1.store.data.findBy(function(i, k) {\
    return i.data.ID === msg.data.ID;\
  });\
  switch (msg.info.action) {\
    case 'create':\
      if (!record)\
        Wb.add(app.grid1, msg.data);\
      break;\
    case 'update':\
      if (record)\
        Wb.update(record, msg.data);\
      break;\
    case 'delete':\
      if (record) {\
        app.grid1.setSelection([record]);\
        Wb.remove(app.grid1);\
      }\
      break;\
    default:\
      console.log(msg);\
      break;\
  }\
});\
\
\
app.name1.addListener(\"specialkey\", function(field, e) {\
  if (e.getKey() == e.ENTER) {\
   \tapp.queryBtn.fireEvent('click');\
   \
  }\
});\
\
app.type.addListener(\"specialkey\", function(field, e) {\
  if (e.getKey() == e.ENTER) {\
   \tapp.queryBtn.fireEvent('click');\
   \
  }\
});",
   "initialize": "\
// var WID = '{#WID#}';\
"
  }
 }],
 "roles": {
  "CD": 1,
  "xlcxjb": 1,
  "SWB": 1
 },
 "title": "客户基本代码维护",
 "iconCls": "",
 "inframe": false,
 "pageLink": ""
}