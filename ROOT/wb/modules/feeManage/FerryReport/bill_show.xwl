{
 "hidden": false,
 "children": [{
  "configs": {"itemId": "module"},
  "expanded": true,
  "children": [
   {
    "configs": {
     "itemId": "xwl2",
     "file": "m?xwl=system/common/CustomerSelect"
    },
    "expanded": false,
    "children": [],
    "type": "xwl"
   },
   {
    "configs": {
     "layout": "border",
     "itemId": "fenSelWin",
     "closeAction": "hide",
     "width": "792",
     "title": "分单查看",
     "modal": "true",
     "height": "320"
    },
    "expanded": false,
    "children": [
     {
      "configs": {
       "itemId": "billSelGrid",
       "editable": "true",
       "width": "448",
       "text": "提单",
       "gridLine": "true",
       "region": "west"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "store",
         "autoLoad": "false",
         "url": "m?xwl=shipBIlla/supcanVbill/billEdit/billStateEdit/fenBillSelect"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": false,
        "children": [
         {
          "configs": {
           "itemId": "RELEASE_ID991",
           "renderer": "if( value==1 )\
  return \"<font color='red'>放行<\/font>\";\
else\
    return \"未放行\";",
           "dataIndex": "RELEASE_ID",
           "width": "40",
           "text": "放行"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "BILL_NO9911",
           "dataIndex": "BILL_NO",
           "width": "130",
           "text": "二程提单"
          },
          "expanded": false,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "BILL_TYPEE99",
           "dataIndex": "GOODS_NOTES",
           "width": "150",
           "text": "货名"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "readOnly": "true"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "WEIGHTmn16",
           "dataIndex": "WEIGHT",
           "width": "70",
           "text": "重量"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "readOnly": "true"
           },
           "expanded": false,
           "children": [],
           "type": "number"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "PIECESmn14",
           "dataIndex": "PIECES",
           "width": "40",
           "text": "件数"
          },
          "expanded": true,
          "children": [{
           "configs": {
            "itemId": "editor",
            "readOnly": "true"
           },
           "expanded": false,
           "children": [],
           "type": "number"
          }],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "actionColumns",
           "xtype": "actioncolumn",
           "hidden": "true",
           "width": "60",
           "align": "center"
          },
          "expanded": true,
          "children": [{
           "configs": {"itemId": "items"},
           "expanded": true,
           "children": [{
            "configs": {
             "itemId": "delAction",
             "handler": "Wb.request({\
  url: 'm?xwl=shipBIlla/supcanVbill/billEdit/billStateEdit/deleteFenBill',\
  params: {billId:record.get(\"ID\"),vId:app.vId.getValue(),pBillNo:app.pBillNo.getValue()},\
  success: function(resp) {}\
});\
 ",
             "tooltip": "删除",
             "iconCls": "cancel_icon"
            },
            "expanded": false,
            "children": [],
            "type": "column"
           }],
           "type": "array"
          }],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid",
      "events": {"itemclick": "app.cntrSelGrid.store.load({params:{billId:record.get(\"ID\")}});"}
     },
     {
      "configs": {
       "itemId": "cntrSelGrid",
       "selType": "rowmodel",
       "editable": "true",
       "disabled": "false",
       "region": "center",
       "title": "箱信息"
      },
      "expanded": true,
      "children": [
       {
        "configs": {
         "itemId": "store",
         "autoLoad": "false",
         "url": "m?xwl=shipBIlla/supcanVbill/billEdit/billStateEdit/fenCntrSelect"
        },
        "expanded": false,
        "children": [],
        "type": "store"
       },
       {
        "configs": {"itemId": "columns"},
        "expanded": true,
        "children": [
         {
          "configs": {
           "itemId": "CNTRumn19",
           "dataIndex": "CNTR",
           "width": "100",
           "text": "箱号"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_TYPEmn111",
           "dataIndex": "CNTR_SIZE",
           "width": "60",
           "text": "尺寸"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "CNTR_TYPEmn11",
           "dataIndex": "CNTR_TYPE",
           "width": "60",
           "text": "箱型"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "E_F_IDmn12",
           "dataIndex": "E_F_ID",
           "width": "40",
           "text": "空重"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         },
         {
          "configs": {
           "itemId": "SEAL_NOmn13",
           "dataIndex": "SEAL_NO",
           "width": "70",
           "text": "铅封"
          },
          "expanded": true,
          "children": [],
          "type": "column"
         }
        ],
        "type": "array"
       }
      ],
      "type": "grid"
     },
     {
      "configs": {
       "itemId": "pBillNo",
       "hidden": "true",
       "x": "8",
       "width": "240",
       "y": "8",
       "height": "22"
      },
      "expanded": false,
      "children": [],
      "type": "text"
     }
    ],
    "type": "window"
   },
   {
    "configs": {
     "layout": "fit",
     "itemId": "viewport1"
    },
    "expanded": true,
    "children": [{
     "configs": {
      "layout": "border",
      "border": "false",
      "itemId": "panelall"
     },
     "expanded": true,
     "children": [
      {
       "configs": {"itemId": "dockedItems"},
       "expanded": true,
       "children": [
        {
         "configs": {
          "border": "false",
          "itemId": "tbar",
          "dock": "top"
         },
         "expanded": false,
         "children": [
          {
           "configs": {
            "itemId": "sdate",
            "allowBlank": "true",
            "labelAlign": "right",
            "fieldLabel": "开始时间",
            "width": "170",
            "labelWidth": "70"
           },
           "expanded": false,
           "children": [],
           "type": "date"
          },
          {
           "configs": {
            "itemId": "edate",
            "allowBlank": "true",
            "labelAlign": "right",
            "fieldLabel": "结束时间",
            "width": "170",
            "labelWidth": "70"
           },
           "expanded": false,
           "children": [],
           "type": "date"
          },
          {
           "configs": {
            "itemId": "billNo",
            "labelAlign": "right",
            "emptyText": "提单号"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          },
          {
           "configs": {
            "itemId": "cntr",
            "labelAlign": "right",
            "emptyText": "箱号"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          },
          {
           "configs": {
            "itemId": "ieId",
            "labelAlign": "right",
            "emptyText": "进出口",
            "keyName": "I_E_ID",
            "width": "70",
            "forceSelection": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "tradeId",
            "labelAlign": "right",
            "emptyText": "内外贸",
            "keyName": "TRADE_ID",
            "width": "70",
            "forceSelection": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "billType",
            "labelAlign": "right",
            "emptyText": "提单属性",
            "keyName": "BILL_TYPE",
            "width": "80",
            "multiSelect": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "cargoType",
            "labelAlign": "right",
            "emptyText": "货物属性",
            "keyName": "CARGO_TYPE",
            "width": "80"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "cntrSizeType",
            "labelAlign": "right",
            "emptyText": "尺寸",
            "keyName": "CNTR_SIZE",
            "width": "80"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "checkJ",
            "boxLabel": "夹柜"
           },
           "expanded": false,
           "children": [],
           "type": "check"
          }
         ],
         "type": "toolbar"
        },
        {
         "configs": {
          "border": "false",
          "itemId": "tbar1",
          "dock": "top"
         },
         "expanded": true,
         "children": [
          {
           "configs": {
            "tagConfigs": "matchFieldWidth: false",
            "hideTrigger": "false",
            "itemId": "CNTR_OPERATOR_COD",
            "labelAlign": "right",
            "emptyText": "船公司",
            "displayField": "CNAME",
            "enterKeyTriggerClick": "true",
            "listConfig": "{\
  width: 250\
}",
            "valueField": "ID",
            "queryDelay": "500",
            "forceSelection": "true",
            "multiSelect": "true"
           },
           "expanded": false,
           "children": [{
            "configs": {
             "itemId": "store",
             "autoLoad": "true",
             "pageSize": "-1",
             "params": "{fldId:'AG'}",
             "url": "m?xwl=system/common/client/clientSelect"
            },
            "expanded": false,
            "children": [],
            "type": "store"
           }],
           "type": "combo"
          },
          {
           "configs": {
            "tagConfigs": "matchFieldWidth: false",
            "hidden": "false",
            "emptyText": "货主",
            "pageSize": "50",
            "enterKeyTriggerClick": "true",
            "listConfig": "{width:250}",
            "valueField": "ID",
            "queryDelay": "500",
            "hideTrigger": "true",
            "itemId": "SHIP_CONSIGN_COD",
            "labelAlign": "right",
            "displayField": "CNAME",
            "forceSelection": "false",
            "multiSelect": "true"
           },
           "expanded": false,
           "children": [{
            "configs": {
             "itemId": "store",
             "autoLoad": "true",
             "url": "m?xwl=system/common/client/clientSelect"
            },
            "expanded": false,
            "children": [],
            "type": "store"
           }],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "SHIP_CONSIGN_COD12",
            "hidden": "true",
            "emptyText": "货主"
           },
           "expanded": false,
           "children": [],
           "type": "text",
           "events": {"change": "// if (!Wb.isEmpty(app.hz.getValue()) && !Wb.isEmpty(app.SHIP_CONSIGN_COD.getValue())) {\
//   app.item21.fireEvent(\"click\");\
// }\
\
if (!Wb.isEmpty(app.SHIP_CONSIGN_COD.getValue())) {\
  app.item21.fireEvent(\"click\");\
}"}
          },
          {
           "configs": {
            "itemId": "item111",
            "text": "更多"
           },
           "expanded": false,
           "children": [],
           "type": "item",
           "events": {"click": "console.log(app.xwl2.ieId);\
app.xwl2.window1.show();\
app.xwl2.window1.mon(app.xwl2.window1, 'ok', function() {\
  app.hz.setValue(app.xwl2.hzs.getValue());\
  app.xwl2.C_CUSTOMER.setValue(\"\");\
  var records = app.xwl2.grid1.store.getCount(),\
    s = \"\";\
  for (var i = 0; i < records; i++) {\
    var rs = app.xwl2.grid1.getStore().getAt(i);\
    s += rs.data.NAME + \",\";\
  }\
  s = s.substring(0, s.length - 1);\
  app.SHIP_CONSIGN_COD.setValue(s);\
  app.xwl2.window1.close();\
});"}
          },
          {
           "configs": {
            "itemId": "item21",
            "iconCls": "cancel_icon"
           },
           "expanded": false,
           "children": [],
           "type": "item",
           "events": {"click": "app.hz.setValue(\"\");\
app.xwl2.sid.setValue(\"\");\
app.SHIP_CONSIGN_COD.setValue(null);\
app.xwl2.gridAll.store.load({\
  params: {\
\tsid:\"\"\
  }\
});\
app.xwl2.grid1.store.load({\
  params: {\
\tids:\"\"\
  }\
});"}
          },
          {
           "configs": {
            "tagConfigs": " matchFieldWidth:false",
            "queryMode": "remote",
            "emptyText": "航次",
            "listConfig": "{width:450}",
            "valueField": "ID",
            "queryDelay": "1",
            "itemId": "voyageNo",
            "tpl": "<table cellspacing='0' width='100%'>\
   <tr  >\
      <td width='105px'>\
       船名\
      <\/td>\
      <td>\
       进口航次号\
      <\/td>\
       <td>\
       出口航次号\
      <\/td>\
    <\/tr>\
  <tpl for='.'>\
    <tr class='x-boundlist-item' >\
      <td >\
        {VESSEL_NAME}\
      <\/td>\
      <td>\
       {LIB_VYG}\
      <\/td>\
       <td>\
       {LOB_VYG}\
      <\/td>\
    <\/tr>\
  <\/tpl>\
<\/table>",
            "labelAlign": "right",
            "width": "140",
            "displayField": "VESSEL_NAME",
            "anyMatch": "true",
            "forceSelection": "true"
           },
           "expanded": false,
           "children": [{
            "configs": {
             "itemId": "store",
             "autoLoad": "true",
             "url": "m?xwl=shipBIlla/ShipBillReport/billSelectEdit/selectVoyage"
            },
            "expanded": false,
            "children": [],
            "type": "store",
            "events": {"beforeload": "operation.params = {\
  sdate: app.sdate.getRawValue() + \" 00:00:00\",\
  edate: app.edate.getRawValue() + \" 23:59:59\",\
  ieId: app.ieId.getValue(),\
  query: app.voyageNo.getValue()\
};"}
           }],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "loadport",
            "emptyText": "装货港",
            "width": "120",
            "keyName": "C_PORT",
            "anyMatch": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "unloadport",
            "emptyText": "卸货港",
            "width": "120",
            "keyName": "C_PORT",
            "anyMatch": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "transittype",
            "labelAlign": "right",
            "emptyText": "贸易方式",
            "keyName": "TRANSIT",
            "width": "90",
            "labelWidth": "60",
            "forceSelection": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "C_CARGO_KIND",
            "labelAlign": "right",
            "emptyText": "货类",
            "keyName": "C_CARGO_KIND",
            "width": "120",
            "labelWidth": "40",
            "forceSelection": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "C_SERVICE213",
            "hidden": "true",
            "labelAlign": "right",
            "emptyText": "航线",
            "keyName": "C_SERVICE",
            "width": "120",
            "labelWidth": "40",
            "anyMatch": "true",
            "forceSelection": "true"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "C_SERVICE",
            "labelAlign": "right",
            "emptyText": "航线",
            "width": "120",
            "displayField": "SERVICE_NAME",
            "labelWidth": "40",
            "valueField": "ID",
            "anyMatch": "true",
            "forceSelection": "true"
           },
           "expanded": true,
           "children": [{
            "configs": {
             "itemId": "store",
             "url": "m?xwl=feeManage/FerryReport/billcountedit/selectSerice"
            },
            "expanded": false,
            "children": [],
            "type": "store"
           }],
           "type": "combo",
           "events": {"select": "if (records[0].data.ID == 'ZS2SZD') {\
  app.isnotService.show();\
  //   app.isnotService.setFieldLabel(\"非深圳东码头\");\
  app.isnotService.setBoxLabel(\"非深圳东码头\");\
} else if (records[0].data.ID == 'ZS2HK') {\
  app.isnotService.show();\
  app.isnotService.setBoxLabel(\"非香港码头\");\
} else {\
  app.isnotService.hide();\
}"}
          },
          {
           "configs": {
            "itemId": "isnotService",
            "boxLabel": "非对应港口",
            "hidden": "true",
            "boxLabelAlign": "after"
           },
           "expanded": false,
           "children": [],
           "type": "check"
          },
          {
           "configs": {
            "itemId": "C_SERVICE1",
            "hidden": "true",
            "labelAlign": "right",
            "emptyText": "航线",
            "width": "120",
            "displayField": "SERVICE_NAME",
            "labelWidth": "40",
            "valueField": "ID",
            "anyMatch": "true",
            "forceSelection": "true"
           },
           "expanded": false,
           "children": [{
            "configs": {
             "itemId": "store",
             "url": "m?xwl=feeManage/FerryReport/billshowedit/selectService"
            },
            "expanded": false,
            "children": [],
            "type": "store"
           }],
           "type": "combo"
          },
          {
           "configs": {
            "layout": "hbox",
            "itemId": "radio1",
            "hidden": "true",
            "width": "120",
            "style": "padding-left:20px;"
           },
           "expanded": false,
           "children": [
            {
             "configs": {
              "itemId": "radioBill",
              "boxLabel": "提单",
              "flex": "1",
              "name": "radio1",
              "checked": "true"
             },
             "expanded": false,
             "children": [],
             "type": "radio"
            },
            {
             "configs": {
              "itemId": "radioCntr",
              "boxLabel": "箱",
              "flex": "1",
              "name": "radio1"
             },
             "expanded": false,
             "children": [],
             "type": "radio"
            }
           ],
           "type": "container"
          },
          {
           "configs": {
            "itemId": "findbtn",
            "text": "查找",
            "iconCls": "search_icon"
           },
           "expanded": false,
           "children": [],
           "type": "item",
           "events": {"click": "var tenancyid = \"{#sys.TENANCY_ID#}\";\
var nature = \"{#sys.NATURE#}\";\
var GOV_CODE = \"{#sys.GOV_CODE#}\";\
// console.log(nature);\
// console.log(GOV_CODE);\
var AF1 = document.getElementById(opt);\
var conditionSql = \"\";\
if (!Wb.isEmpty(app.sdate.getValue()) && !Wb.isEmpty(app.edate.getValue())) {\
  conditionSql = \" AND to_char(v2.ETA,'yyyy-MM-dd HH24:MI:SS') between '\" + app.sdate.getRawValue() + \" 00:00:00' and '\" + app.edate.getRawValue() + \" 23:59:59'\";\
}\
\
//======测试货主查询\
if (!Wb.isEmpty(app.hz.getValue())) {\
  console.log(\"============\");\
  conditionSql += \" and decode(vh.I_E_ID,'I',vh.CONSIGNEE_COD,'E',vh.SHIPPER_COD) IN(\" + app.hz.getValue() + \")\";\
  //   app.hz.setValue(\"\");\
}\
\
// if (!Wb.isEmpty(app.billType.getValue())) {\
//   if (app.billType.getValue() === 'P')\
//     conditionSql += \" and vh.BILL_TYPE = '\" + app.billType.getValue() + \"'\";\
//   else\
//     conditionSql += \" and vh.BILL_TYPE = '\" + app.billType.getValue() + \"' and vh.MAIN_FLAG=1\";\
// } else\
//   conditionSql += \" and(vh.BILL_TYPE = 'P' OR vh.MAIN_FLAG=1)\";\
\
if (!Wb.isEmpty(app.billType.getValue())) {\
  if (app.billType.getValue() == 'P') {\
    conditionSql += \" and vh.BILL_TYPE = '\" + app.billType.getValue() + \"'\";\
  } else {\
    var s = app.billType.getValue();\
    var str = \"\";\
    var ss = \"\";\
    for (var i = 0; i < s.length; i++) {\
      if (s[i] != 'P')\
        str += \"'\" + s[i] + \"',\";\
      else\
        ss = 'P';\
    }\
    str = str.substring(0, str.length - 1);\
    if (ss == 'P') {\
      conditionSql += \" and (vh.BILL_TYPE = '\" + ss + \"' or (vh.bill_type in(\" + str + \") and vh.main_flag=1)\t)\";\
    } else {\
      conditionSql += \" and vh.BILL_TYPE in(\" + str + \") AND VH.MAIN_FLAG=1\";\
    }\
  }\
} else\
  conditionSql += \" and(vh.BILL_TYPE = 'P' OR vh.MAIN_FLAG=1)\";\
\
if (!Wb.isEmpty(app.billNo.getValue()))\
  conditionSql += \" and vh.BILL_NO LIKE '%\" + app.billNo.getValue() + \"%'\";\
if (!Wb.isEmpty(app.cntr.getValue()))\
  conditionSql += \" and vl.CNTR LIKE '%\" + app.cntr.getValue() + \"%'\";\
if (!Wb.isEmpty(app.CNTR_OPERATOR_COD.getValue())) {\
  var s = app.CNTR_OPERATOR_COD.getValue();\
  var str = \"\";\
  for (var i = 0; i < s.length; i++) {\
    str += \"'\" + s[i] + \"',\";\
  }\
  if (str.length > 0)\
    conditionSql += \" and vh.CNTR_OPERATOR_COD in(\" + str.substring(0, str.length - 1) + \")\";\
  //   conditionSql += \" and vh.CNTR_OPERATOR_COD='\" + app.CNTR_OPERATOR_COD.getValue() + \"'\";\
}\
// if (!Wb.isEmpty(app.C_SERVICE.getValue()))\
//   conditionSql += \" and decode(vh.I_E_ID,'I',v1.SERVICE,'E',v1.OSERVICE)='\" + app.C_SERVICE.getValue() + \"'\";\
if (!Wb.isEmpty(app.C_SERVICE.getValue())) {\
  if (app.C_SERVICE.getValue() == '1') {\
    conditionSql += \" and decode(vh.I_E_ID,'I',v1.SERVICE,'E',v1.OSERVICE) <>'ZS2HK'\";\
    //     conditionSql += \" and decode(vh.I_E_ID,'I',v1.SERVICE,'E',v1.OSERVICE) not like '%HK%'\";\
  } else if (app.C_SERVICE.getValue() == '2') {\
    conditionSql += \" and decode(vh.I_E_ID,'I',v1.SERVICE,'E',v1.OSERVICE) <>'ZS2SZD'\";\
  } else\
    conditionSql += \" and decode(vh.I_E_ID,'I',v1.SERVICE,'E',v1.OSERVICE)='\" + app.C_SERVICE.getValue() + \"'\";\
}\
// if (!Wb.isEmpty(app.SHIP_CONSIGN_COD.getValue()))\
//   conditionSql += \" and decode(vh.I_E_ID,'I',vh.CONSIGNEE_COD,'E',vh.SHIPPER_COD)='\" + app.SHIP_CONSIGN_COD.getValue() + \"' \";\
if (!Wb.isEmpty(app.SHIP_CONSIGN_COD.getValue()) && Wb.isEmpty(app.hz.getValue())) {\
  console.log(\"-------\");\
  var s = app.SHIP_CONSIGN_COD.getValue();\
  var str = \"\";\
  for (var i = 0; i < s.length; i++) {\
    console.log(s[i]);\
    str += \"'\" + s[i] + \"',\";\
  }\
  if (s.length > 0)\
    conditionSql += \" and decode(vh.I_E_ID,'I',vh.CONSIGNEE_COD,'E',vh.SHIPPER_COD) IN(\" + str.substring(0, str.length - 1) + \") \";\
}\
\
if (!Wb.isEmpty(app.ieId.getValue()))\
  conditionSql += \" and vh.I_E_ID='\" + app.ieId.getValue() + \"'\t\";\
if (!Wb.isEmpty(app.tradeId.getValue()))\
  conditionSql += \" and vh.TRADE_ID='\" + app.tradeId.getValue() + \"'\";\
if (!Wb.isEmpty(app.voyageNo.getValue()))\
  conditionSql += \" and v2.VID='\" + app.voyageNo.getValue() + \"'\";\
if (nature == 5)\
  conditionSql += \" and vh.CNTR_OPERATOR_COD='\" + GOV_CODE + \"'\";\
if (!Wb.isEmpty(app.cargoType.getValue()) && app.cargoType.getValue() != \"A\" && app.cargoType.getValue() != \"NL\")\
  conditionSql += \" and vl.cargo_type='\" + app.cargoType.getValue() + \"'\";\
if (!Wb.isEmpty(app.cargoType.getValue()) && app.cargoType.getValue() != \"A\" && app.cargoType.getValue() == \"NL\")\
  conditionSql += \" and vl.cargo_type<>'L'\";\
if (!Wb.isEmpty(app.loadport.getValue()))\
  conditionSql += \" and vh.POL='\" + app.loadport.getValue() + \"'\";\
if (!Wb.isEmpty(app.unloadport.getValue()))\
  conditionSql += \" and vh.POD='\" + app.unloadport.getValue() + \"'\";\
if (!Wb.isEmpty(app.cntrSizeType.getValue()))\
  conditionSql += \" and vl.CNTR_SIZE='\" + app.cntrSizeType.getValue() + \"'\";\
if (!Wb.isEmpty(app.transittype.getValue()))\
  conditionSql += \" and vh.TRANSIT='\" + app.transittype.getValue() + \"'\";\
if (app.checkJ.getValue() == '1')\
  conditionSql += \" and vl.lcl_id=1 and vl.main_flag=1 and vl.Split_Id=1\";\
if (!Wb.isEmpty(app.C_CARGO_KIND.getValue()))\
  conditionSql += \"  and vh.CMDY_CODE='\" + app.C_CARGO_KIND.getValue() + \"'\";\
if (!Wb.isEmpty(app.bsdate.getValue()) && !Wb.isEmpty(app.bedate.getValue())) {\
  conditionSql += \"  and decode(vh.bill_type,'S',bo.BD_ON,bi.BD_ON)>=to_date('\" + app.bsdate.getRawValue() + \" 00:00:00','yyyy-MM-dd HH24:MI:SS')\t \" +\
    \" AND decode(vh.bill_type,'S',bo.BD_ON,bi.BD_ON)<=to_date('\" + app.bedate.getRawValue() + \" 23:59:59','yyyy-MM-dd HH24:MI:SS')\";\
}\
if (!Wb.isEmpty(app.IS_JK.getValue()))\
  conditionSql += \" and IS_JK='\" + app.IS_JK.getValue() + \"'\t\";\
\
//查找中山到深圳东或者深圳西不是装货港或者卸货港不是对应的码头的问题\
if (app.isnotService.getValue() == '1') {\
  conditionSql += \" and DECODE(VH.I_E_ID,'I',VH.POL,'E',VH.POD) NOT IN (SELECT PORT_ID FROM C_ROUTE WHERE SERVICE_ID='\" + app.C_SERVICE.getValue() + \"')\t\";\
}\
\
//现金货主和月结货主\
if (app.checkXJ.getValue() == '1')\
  conditionSql += \" and exists(select 1 from C_CUSTOMER a, C_CUSTOMER_CONTACT b where a.id = b.c_id(+) AND DECODE (vh.I_E_ID,  'I', vh.CONSIGNEE_COD,  'E', vh.SHIPPER_COD)=A.CODE AND b.ACCOUNT_TYPE != 2 AND (   b.ORG_NAME IS NULL \" +\
  \" OR b.ORG_NAME = DECODE ('ZSG', 'ZSG', '中山港','XLG', '小榄港','SWG', '神湾港', '', '中山港')))\";\
if (app.checkYJ.getValue() == '1')\
  conditionSql += \" and exists(select 1 from C_CUSTOMER a, C_CUSTOMER_CONTACT b where a.id = b.c_id(+) AND DECODE (vh.I_E_ID,  'I', vh.CONSIGNEE_COD,  'E', vh.SHIPPER_COD)=A.CODE AND b.ACCOUNT_TYPE = 2 AND (   b.ORG_NAME IS NULL \" +\
  \" OR b.ORG_NAME = DECODE ('ZSG', 'ZSG', '中山港','XLG', '小榄港','SWG', '神湾港', '', '中山港')))\";\
// console.log(\"conditionSql:\"+conditionSql);\
// console.log(conditionSql.substring(0,0));\
if (conditionSql == \" and(vh.BILL_TYPE = 'P' OR vh.MAIN_FLAG=1)\") {\
  Wb.warn(\"查询条件不能为空！\");\
  return;\
} else {\
\
\
  //加载列表\
  AF1.func(\"Load\", Wb.loadSupcanData(\"m?xwl=feeManage/FerryReport/billshowedit/select\", {\
    tenancyid: tenancyid,\
    ieId: app.ieId.getValue(),\
    sdate: app.sdate.getRawValue(),\
    edate: app.edate.getRawValue(),\
    SHIP_CONSIGN_COD: app.SHIP_CONSIGN_COD.getValue(),\
    CNTR_OPERATOR_COD: app.CNTR_OPERATOR_COD.getValue(),\
    billNo: app.billNo.getValue(),\
    cntr: app.cntr.getValue(),\
    tradeId: app.tradeId.getValue(),\
    voyageNo: app.voyageNo.getValue(),\
    billType: app.billType.getValue(),\
    bills: app.radioBill.getValue(),\
    cntrs: app.radioCntr.getValue(),\
    cargotype: app.cargoType.getValue(),\
    loadport: app.loadport.getValue(),\
    unloadport: app.unloadport.getValue(),\
    cntrSizeType: app.cntrSizeType.getValue(),\
    conditionSql: conditionSql\
  }));\
\
\
\
  Wb.request({\
    url: 'm?xwl=feeManage/FerryReport/billshowedit/selectPcnt',\
    params: {\
      tenancyid: tenancyid,\
      ieId: app.ieId.getValue(),\
      sdate: app.sdate.getRawValue(),\
      edate: app.edate.getRawValue(),\
      SHIP_CONSIGN_COD: app.SHIP_CONSIGN_COD.getValue(),\
      CNTR_OPERATOR_COD: app.CNTR_OPERATOR_COD.getValue(),\
      billNo: app.billNo.getValue(),\
      cntr: app.cntr.getValue(),\
      tradeId: app.tradeId.getValue(),\
      voyageNo: app.voyageNo.getValue(),\
      billType: app.billType.getValue(),\
      bills: app.radioBill.getValue(),\
      cntrs: app.radioCntr.getValue(),\
      cargotype: app.cargoType.getValue(),\
      loadport: app.loadport.getValue(),\
      unloadport: app.unloadport.getValue(),\
      cntrSizeType: app.cntrSizeType.getValue(),\
      transittype: app.transittype.getValue(),\
      C_SERVICE: app.C_SERVICE.getValue(),\
      IS_JK: app.IS_JK.getValue()\
    },\
    success: function(resp) {\
\
      var rs = Wb.decode(resp.responseText);\
\
      //   app.cntrNumText.setText(\"拼柜票数总计为：\"+(rs[0].CNTRNUM==null?\"0\":rs[0].CNTRNUM));\
      //       app.cntrNumText.setText(\"拼柜票数总计为：\" + (rs[0].CNTRNUM == null ? \"0\" : rs[0].CNTRNUM) + \",20尺箱量：\" + (rs[0].C20 == null ? \"0\" : rs[0].C20) +\",40尺箱量：\" + (rs[0].C40 == null ? \"0\" : rs[0].C40)+\",45尺箱量：\" + (rs[0].C45 == null ? \"0\" : rs[0].C45));\
      app.cntrNumText.setText(\"拼柜20尺箱量:\" + (rs[0].C20 == null ? \"0\" : rs[0].C20) + \"\t\t40尺箱量:\" + (rs[0].C40 == null ? \"0\" : rs[0].C40) + \"\t\t45尺箱量:\" + (rs[0].C45 == null ? \"0\" : rs[0].C45));\
    }\
  });\
\
}"}
          },
          {
           "configs": {
            "itemId": "seekZfId",
            "hidden": "true",
            "text": "查找主分单"
           },
           "expanded": false,
           "children": [],
           "type": "item",
           "events": {"click": "var tenancyid = \"{#sys.TENANCY_ID#}\";\
var AF1 = document.getElementById(opt);\
//加载列表\
AF1.func(\"Load\", Wb.loadSupcanData(\"m?xwl=feeManage/FerryReport/billshowedit/selectZF\", {\
  tenancyid: tenancyid,\
  ieId: app.ieId.getValue(),\
  sdate: app.sdate.getRawValue(),\
  edate: app.edate.getRawValue(),\
  SHIP_CONSIGN_COD: app.SHIP_CONSIGN_COD.getValue(),\
  CNTR_OPERATOR_COD: app.CNTR_OPERATOR_COD.getValue(),\
  billNo: app.billNo.getValue(),\
  cntr: app.cntr.getValue(),\
  tradeId: app.tradeId.getValue(),\
  voyageNo: app.voyageNo.getValue(),\
  billType: app.billType.getValue(),\
  bills: app.radioBill.getValue(),\
  cntrs: app.radioCntr.getValue()\
}));"}
          }
         ],
         "type": "toolbar"
        },
        {
         "configs": {
          "border": "false",
          "itemId": "tbar2",
          "hidden": "false",
          "dock": "top"
         },
         "expanded": true,
         "children": [
          {
           "configs": {
            "itemId": "bsdate",
            "allowBlank": "true",
            "labelAlign": "right",
            "fieldLabel": "办单时间",
            "width": "170",
            "labelWidth": "70"
           },
           "expanded": false,
           "children": [],
           "type": "date"
          },
          {
           "configs": {
            "itemId": "label1",
            "text": "-"
           },
           "expanded": false,
           "children": [],
           "type": "label"
          },
          {
           "configs": {
            "itemId": "bedate",
            "allowBlank": "true",
            "labelAlign": "right",
            "width": "100",
            "labelWidth": "70"
           },
           "expanded": false,
           "children": [],
           "type": "date"
          },
          {
           "configs": {
            "itemId": "IS_JK",
            "labelAlign": "right",
            "emptyText": "靠泊",
            "pickList": "[\
  ['是', '是'],\
  ['否', '否']\
]",
            "width": "50",
            "labelWidth": "40"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "checkXJ",
            "boxLabel": "现金货主"
           },
           "expanded": false,
           "children": [],
           "type": "check"
          },
          {
           "configs": {
            "itemId": "checkYJ",
            "boxLabel": "月结货主"
           },
           "expanded": false,
           "children": [],
           "type": "check"
          },
          {
           "configs": {
            "itemId": "cntrNumText",
            "style": "white-space:pre"
           },
           "expanded": false,
           "children": [],
           "type": "label"
          },
          {
           "configs": {
            "itemId": "cntrSize",
            "hidden": "true",
            "labelAlign": "right",
            "fieldLabel": "尺寸",
            "keyName": "CNTR_SIZE",
            "labelWidth": "40"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "cntrType",
            "hidden": "true",
            "labelAlign": "right",
            "fieldLabel": "箱型",
            "keyName": "CNTR_TYPE",
            "labelWidth": "40"
           },
           "expanded": false,
           "children": [],
           "type": "combo"
          },
          {
           "configs": {
            "itemId": "sealNo",
            "hidden": "true",
            "labelAlign": "right",
            "fieldLabel": "铅封号",
            "labelWidth": "50"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          },
          {
           "configs": {
            "itemId": "goods",
            "hidden": "true",
            "labelAlign": "right",
            "fieldLabel": "货物",
            "labelWidth": "40"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          },
          {
           "configs": {
            "itemId": "hz",
            "hidden": "true",
            "labelAlign": "right",
            "fieldLabel": "货主",
            "labelWidth": "40"
           },
           "expanded": false,
           "children": [],
           "type": "text"
          }
         ],
         "type": "toolbar"
        }
       ],
       "type": "array"
      },
      {
       "configs": {
        "border": "false",
        "itemId": "panel1",
        "region": "center"
       },
       "expanded": true,
       "children": [],
       "type": "panel"
      }
     ],
     "type": "panel"
    }],
    "type": "viewport",
    "events": {"afterrender": "var mt1 = bldStr(\"BCV1.TreeList\", opt, \"\", \"99%\");\
app.panel1.update(mt1);"}
   }
  ],
  "type": "module",
  "events": {
   "finalize": "app.sdate.setValue(new Date());\
app.edate.setValue(new Date());\
\
window[\"init\" + opt] = function(id) {\
  var m = document.getElementById(opt);\
  if (id == opt) {\
    m.func(\"setCookie\", \"JSESSIONID={#JSESSIONID#}\");\
    m.func(\"Build\", '/supcan/report/fee/bill_fee.xml?' + 'V1.15');\
    m.func(\"DisableMenu\", \"showRuler,exportAll,printAll,delete,insert,import ,curselMode,hue ,language , enter    \\r\\
 true\");\
  }\
};\
window[\"event\" + opt] = function(id, Event, p1, p2, p3, p4) {\
  var AF1 = document.getElementById(opt);\
  if (Event == \"MenuBeforePopup\" && id == opt) {\
    var menu = \"\";\
    if (Wb.getSupcanMelu(AF1, \"ZF_ID\", false) == 1) {\
      menu = \"id=4005;text='查看分单';\";\
      AF1.func(\"AddMenu\", menu + \" \\r\\
 LocateAt=top\");\
    }\
  } else if (Event == \"MenuClicked\" && id == opt) {\
    if (p1 == '4005') { //查看分单\
      app.fenSelWin.show();\
      app.billSelGrid.store.load({\
        params: {\
          TENANCY_ID: '{#sys.TENANCY_ID#}',\
          billNo: Wb.getSupcanMelu(AF1, \"BILL_NO\", false),\
          vId: Wb.getSupcanMelu(AF1, \"VID\", false)\
        }\
      });\
      app.cntrSelGrid.store.removeAll();\
    }\
  }\
};",
   "initialize": "var opt = Wb.getId();\
var s=\"\";"
  }
 }],
 "roles": {
  "JCB": 1,
  "ZSBCFEE": 1,
  "JTCWB": 1,
  "SWB": 1
 },
 "title": "舱单核对",
 "iconCls": "",
 "inframe": false,
 "pageLink": ""
}